--- 
title: "RAF Technical Note: Processing Algorithms"
subtitle: |
  | Descriptions of the Variables in the Data Archives
author: |
  | Research Aviation Facility, Earth Observing Laboratory
  | National Center for Atmospheric Research, Boulder CO 80307, USA
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: [book.bib, packages.bib]
# url: your book url like https://bookdown.org/yihui/bookdown
# cover-image: path to the social sharing image like images/cover.jpg
description: |
  This report describes the algorithms used at the NCAR/EOL/RAF to process
  the measurements made from the NSF/NCAR research aircraft.
link-citations: yes
github-repo: WilliamCooper/ProcessingAlgorithms
---

# Abstract {-#index}
    This report documents the algorithms used to produce the data archives 
    resulting from research projects that use the NSF/NCAR research aircraft 
    operated by the Research Aviation Facility, Earth Observing Laboratory, 
    National Center for Atmospheric Research. 


```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = FALSE)
library(kableExtra)
```

```{r include=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown'
), 'packages.bib')
```

<!--chapter:end:index.Rmd-->

# Introduction

## Background Information

This technical report defines the variables used in data sets that are collected by the research aircraft operated by the Research Aviation Facility (RAF) of the National Center for Atmospheric Research. Where appropriate, it also documents the equations that are used by the processing software (currently “nimbus”) to calculate the derived measurements that result from the use of one or more other basic measurements (e.g., potential temperature). Since 1993, data from research flights have been archived in NetCDF format (cf. <a href="http://www.unidata.ucar.edu/software/netcdf/docs/">http://www.unidata.ucar.edu/software/netcdf/docs/</a>), and the NetCDF header for recent projects includes detailed information on the measurements present in the file, how they depend on other measurements, units, etc. The conventions that the RAF uses for NetCDF data files are documented at <a href=" http://www.eol.ucar.edu/raf/Software/netCDF.html "> http://www.eol.ucar.edu/raf/Software/netCDF.html </a>.  

This document should change as changes in processing algorithms are implemented, but the intent is also to provide a history of algorithms that have been used, so there is an effort to document how historical data files were processed along with the descriptions of current algorithms. Unlike some technical reports, this document is likely to change over time and should provide a history extending back to <a href="https://opensky.ucar.edu/islandora/object/archives%3A8729">RAF Bulletin 9</a>, which documented the processing algorithms as they existed before about 2003.  

Currently, the data acquisition process on the research aircraft of the Research Aviation Facility, Earth Observing Laboratory, proceeds as follows:  

1. Analog or digital outputs from instruments are sampled at regular intervals, typically 50 Hz when possible. Analog outputs are converted to digital values via analog-to-digital converters. The investigators' handbooks for each aircraft describe this process in detail, including resolution of the sampling and handling of the results. Often, signals from user-supplied instruments are also included in the measured values that are handled by the data system.  
2. The digital outputs are then recorded by the data system on the aircraft. Currently, this is a task of the ["NIDAS"](http://www.eol.ucar.edu/data/software/nidas) system described below. That system also controls the sampling, time stamps, and other aspects of data recording.  
3. In flight, the data are processed by the *“nimbus”* data processing program, which makes them available for display via ["aeros"](http://www.eol.ucar.edu/raf/Software/aeros_dnld.html) for real-time monitoring of measurements.  
4. Following the flight, *nimbus* again processes the data. At this stage, measurements can be re-sampled with averaging and/or interpolation to produce various data rates, usually 1 Hz or 25 Hz, and known lags in measurements can be introduced to adjust measurements to a common time basis. As part of this processing, *nimbus* applies calibration coefficients where appropriate to convert recorded values (e.g., voltage) to engineering units (e.g., $^\circ$C). Determining or checking these calibration coefficients is part of the pre-flight and post-flight procedures for each project.  
5. The output from *nimbus* is the data file that is the permanent archive from the experiment, often after merging in additional data sets from users that are not recorded in the original data file produced by *NIDAS.* These files, in NetCDF format, have headers that contain metadata on each measurement (such as the calibration coefficients, the instrument that produced the measurement, etc.). Many of the variables in these files are discussed in this technical note, but the files may also include additional project-specific measurements for which the NetCDF header and the project reports will be the only documentation.  

For assistance accessing data from RAF-supported projects, contact the RAF data management group via <a href="mailto:raf-dm%40eol.ucar.edu">this email address</a>.  

```{r include = TRUE, echo = FALSE}
## construct data.frame for the following table:
DSYS <- data.frame("Data System" = c('ADS I', 'ADS II', 'ADS III (NIDAS)^[ADS III is the name given to the full data system, which includes these components: NIDAS (for data acquisition and recording); NIMBUS (for data processing, both in flight and after the flight); AEROS (for data display in flight); and the Mission Coordinator Station and satellite communications system (for transmission of data to and from the aircraft, display of such data for mission decisions, and support for written “chat” communications among project participants both on the aircraft and on the ground).]'))
DSYS$start <- c('1984', '1992', '2005')
DSYS$end <- c('1992', '2007', ' ')
DSYS$aircraft <- c('King Air 200T, Sabreliner (1987), Electra (1991)', 'C-130', 'GV, C-130 after 2007')
```
The data system has changed several times over the history of RAF. For a discussion of the history of the data systems, see [this note](https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/ADSHistory.pdf) written by Richard Friesen. The versions of data systems that produced most of the data still available were, approximately, as given in the following table: 
```{r include = TRUE}
knitr::kable(DSYS, align=c('cccl')) %>% kable_styling(bootstrap_options = 'bordered') %>%
  scroll_box(width='80%')
```
  
Before 1993, data were processed by a different program, “GENPRO,” and a different output format (also named GENPRO) was used for archived datasets. Appendix E in [RAF Bulletin 9](https://opensky.ucar.edu/islandora/object/archives%3A8729), the previous description of RAF data products that is now superseded by this technical note, describes that format. Some variable names in this document, esp. in section \@ref(obsolete-variables), refer to obsolete variable names, some used with GENPRO and others referring to instruments that are now retired. These names are included here so that this report can be a reference for older archived data as well as for current data files.  

## Alphabetical List of Variables

At the end of this document, there is a list of all the variable names that appear in standard data files along with links to the primary discussion of those variables; see [Appendix B](/rmd_output/1/appendix-b-variable-names.html#variable-names). In some cases redundant measurements are present, often for key measurements like pressure or temperature. When these are used in subsequent calculation of derived variables like potential temperature, some choice is usually made regarding which measurement is considered most reliable for a particular project or flight, and a single derived variable is calculated on the basis of the chosen input variable(s). To record which measurements were so designated, a reference measurement chosen from a group of redundant measurements usually has a variable name ending with the letter(s) X or XC.^[Some that do not follow this convention are ATTACK and SSLIP; see the individual descriptions that follow.] 
To see the variables in a particular netCDF data file, use the command “ncdump -h file.nc”.  

## Constants and Symbols {#constants-and-symbols}

The following table contains values used for some constants in this document. For reference, the symbols used here and elsewhere in this document are defined in the List of Symbols near the end of the document (cf.\ [Appendix A](/rmd_output/1/appendix-a-list-of-symbols.html#list-of-symbols)). Where references are to the “NIST Chemistry WebBook”, the associated URL is <a href="http://webbook.nist.gov">http://webbook.nist.gov</a>. References to the CODATA Internationally recommended values of the Fundamental Physical Constants are available at <a href="http://physics.nist.gov/.cuu/.Constants">http://physics.nist.gov/.cuu/.Constants</a>. The optimization involved in adjustment of these coefficients is documented in [Mohr et al., 2008a](https://physics.nist.gov/cuu/pdf/RevModPhys_80_000633acc.pdf) and 2008b, referenced at that URL.^[P. J. Mohr, B. N. Taylor, and D. B. Newell, Rev. Mod. Phys 80(2), 633-730(2008); P. J. Mohr, B. N. Taylor, and D. B. Newell, J. Phys. Chem. Ref. Data 37(3), 1187-1284(2008).] 
In this technical note, references to these symbols will often have these symbols or definitions marked by the symbol $^\dagger$ to indicate that the values used are the standard ones in the following table.  

<blockquote><hr>
<center> __[Values Used for "Constants"]{#constants-table}__ </center>  
<br>
$g$ = \label{-constant-g}\sindex[lis]{g@$g$= acceleration of gravity}acceleration
of gravity$^{(a)}$ at latitude $\lambda$ \sindex[lis]{lambda@$\lambda$=latitude} and
altitude\sindex[lis]{z@$z$ = height} $z$ above the WGS-84 \index{WGS-84 geoid}geoid,$^{(b)}$ 
\begin{align}
g(z,\lambda)=g_{e}\left(\frac{1+g_{1}\sin^{2}(\lambda)}{(1-g_{2}\sin^{2}\lambda)^{1/2}}\right)(1-(k_{1}-k_{2}\sin^{2}(\lambda))z+k_{3}z^{2})
(\#eq:gsublambda)
\end{align}  
\ \ \ \ \ \ \ where $g_{e}=9.780327$\ m\ s$^{-2}$, $g_{1}=0.00193185$, $g_{2}=0.00669438$, and  
\ \ \ \ \ \ \  {$k_{1},k_{2},k_{3}$} = {3.15704$\times 10^{-7}\mathrm{m}^{-1}$,
2.10269$\times 10^{-9}\mathrm{m}^{-1}$, 7.37452$\times 10^{-14}\mathrm{m}^{-2}$}  
$T_{0}$ = temperature in kelvin\sindex[lis]{T0@$T_{0}$=273.15\ K, temperature in kelvin corresponding to $0^{\circ}$C} corresponding to $0^{\circ}$C = 273.15\ K  
$T_{3}$ = temperature\sindex[lis]{T3@$T_{3}$= triple point temperature of water}
corresponding to the triple point of water\index{triple point of water}
= 273.16\ K  
$M_{d}$ = \sindex[lis]{Md@$M_{d}$= molecular weight of dry air}molecular
weight of dry air$^{(a)}$\index{molecular weight!dry air}, 28.9637
kg$\,$kmol$^{-1}$\ $^{(c)}$  
$M_{w}$ = \sindex[lis]{Mw@$M_{w}$= molecular weight of water}molecular
weight of water\index{molecular weight!water}, 18.0153 kg\ kmol$^{-1}$\ $^{(d)}$  
$R_{0}$ = \sindex[lis]{R@$R_{0}$= universal gas constant}universal
gas constant$^{a}$\index{universal gas constant}\index{gas constant!universal}
= 8.314472$\times 10^{3}$ J\ kmol$^{-1}$K$^{-1}$\ $^{(e)}$\footnote{\label{fn:2006-CODATA}}  
$N_{A}$ = Avogadro constant = 6.022141$\times 10^{26}$ molecules\ kmol$^{-1}$\index{Avogadro constant}\sindex[lis]{NA@$N_{A}$ = Avogadro constant, molecules per kmol}  
$k=R_{0}/(\mathrm{N_{A})}=1.38065\times10^{-23}\mathrm{J}\,\mathrm{K}^{-1}$\sindex[lis]{k@$k$=Boltzmann Constant}\index{Boltzmann constant}  
$R_{d}=(R_{0}/M_{d}$) = \sindex[lis]{Rd@$R_{d}=$gas constant for dry air}gas
constant for dry air\index{gas constant!dry air}  
$R_{w}$ = ($R_{0}/M_{w})$ = \sindex[lis]{Rw@$R_{W}$= gas constant for water vapor}gas
constant for water vapor\index{gas constant!water vapor}  
$R_{E}$ = \sindex[lis]{Re@$R_{E}$= radius of the Earth}radius of
the Earth\index{radius of the Earth} = 6.371229$\times 10^{6}$m\ $^{(f)}$\footnote{ discussed
in \prettyref{sec:INS}}  
$c_{p}$ = \sindex[lis]{cp@$c_{p}$ or $c_{pd}$ = specific heat of dry air at constant pressure}specific
heat of dry air at constant pressure\index{specific heat!dry air!constant pressure}
= $\frac{7}{2}R_{d}$ = 1.00473$\times10^{3}$ J\ kg$^{-1}$K$^{-1}$\ $^{(g)}$  
$c_{v}$ = \sindex[lis]{cv@$c_{v}$ or $c_{vd}$ = specific heat of dry air at constant volume}specific
heat of dry air at constant volume\index{specific heat!dry air!constant volume}
= $\frac{5}{2}R_{d}$ = 0.71766$\times 10^{3}$ J\ kg$^{-1}$K$^{-1}$  
\ \ \ \ \ *(specific heat values are at 0$^{\circ}$C; small variations
with temperature are not included here)*  
$\gamma$ = \sindex[lis]{gamma or gamma_{d} = ratio of specific heats of air, c_{p}/c_{v}@$\gamma$ or $\gamma_{d}$ = ratio of specific heats of air, $c_{p}/c_{v}$}ratio
of specific heats\index{specific heat ratio, dry air}, $c_{p}/c_{v}$,
taken to be 1.4 (dimensionless) for dry air  
$\Omega$ = \sindex[lis]{Omega= angular rotation rate of the Earth@$\Omega$= angular rotation rate of the Earth}angular
rotation rate of the Earth\index{Earth, angular rotation rate} =
7.292115$\times10^{-5}$ radians/s  
$\Omega_{Sch}$ = \sindex[lis]{Omega_{Sch}= angular frequency of the Schuler oscillation@$\Omega_{Sch}$= angular frequency of the Schuler oscillation}angular
frequency of the Schuler oscillation\index{Schuler oscillation} =
$\sqrt{\frac{g}{R_{E}}}$  
$\sigma$ = \sindex[lis]{sigma= Stephan-Boltzmann constant@$\sigma$= Stephan-Boltzmann constant}Stephan-Boltzmann
Constant\index{Stephan-Boltzmann Constant} = 5.6704$\times10^{-8}$W\ m$^{-2}$K$^{-4}$\ $^{(e)}$  
```{r include = TRUE, echo = FALSE, eval = FALSE, results = 'asis'}
cat('$g$ = \\label{-constant-g}\\sindex[lis]{g@$g$= acceleration of gravity}acceleration
of gravity\ \ $^{(a)}$\\footnote{ } at latitude $\\lambda$ \\sindex[lis]{lambda@$\\lambda$=latitude}and
altitude\\sindex[lis]{z@$z$ = height} $z$ above the WGS-84 \\index{WGS-84 geoid}geoid,\ \ $^{(b)}$\\footnote{}', '\\',
'\\begin{align}',
'g(z,\\lambda)=g_{e}\\left(\\frac{1+g_{1}\\sin^{2}(\\lambda)}{(1-g_{2}\\sin^{2}\\lambda)^{1/2}}\\right)(1-(k_{1}-k_{2}\\sin^{2}(\\lambda))z+k_{3}z^{2})  ',
'\\ \\ \\ \\ \\ (1.1)  ',
'\\end{align}',
'\\ \\ \\ \\ \\ \\ \\ where $g_{e}=9.780327$\ m\ s$^{-2}$, $g_{1}=0.00193185$, $g_{2}=0.00669438$, and<br>
\\ \\ \\ \\ \\ \\ \\  {$k_{1},k_{2},k_{3}$} = {3.15704$\\times 10^{-7}\\mathrm{m}^{-1}$,
2.10269$\\times 10^{-9}\\mathrm{m}^{-1}$, 7.37452$\\times 10^{-14}\\mathrm{m}^{-2}$}',
'<br>$T_{0}$ = temperature in kelvin\\sindex[lis]{T0@$T_{0}$=273.15\ K, temperature in kelvin corresponding to $0^{\\circ}$C} corresponding to $0^{\\circ}$C = 273.15\ K',
'<br>$T_{3}$ = temperature\\sindex[lis]{T3@$T_{3}$= triple point temperature of water}
corresponding to the triple point of water\\index{triple point of water}
= 273.16\ K',
'<br>',
'$M_{d}$ = \\sindex[lis]{Md@$M_{d}$= molecular weight of dry air}molecular
weight of dry air$^{(a)}$\\index{molecular weight!dry air}, 28.9637
kg\ kmol$^{-1}\ \ $^{(c)}$\\footnote{}<br>',
'$M_{w}$ = \\sindex[lis]{Mw@$M_{w}$= molecular weight of water}molecular
weight of water\\index{molecular weight!water}, 18.0153 kg\ kmol$^{-1}$\ \ $^{(d)}$\\footnote{}',
'<br>$R_{0}$ = \\sindex[lis]{R@$R_{0}$= universal gas constant}universal
gas constant$^{a}$\\index{universal gas constant}\\index{gas constant!universal}
= 8.314472$\\times 10^{3}$ J\ kmol$^{-1}$K$^{-1}$\ \ $^{(e)}$\\footnote{\\label{fn:2006-CODATA}}
<br>$N_{A}$ = Avogadro constant = 6.022141$\\times 10^{26}$ molecules\ kmol$^{-1}$\\index{Avogadro constant}\\sindex[lis]{NA@$N_{A}$ = Avogadro constant, molecules per kmol}<br>',
'$k=R_{0}/(\\mathrm{N_{A})}=1.38065\\times10^{-23}\\mathrm{J}\\,\\mathrm{K}^{-1}$\\sindex[lis]{k@$k$=Boltzmann Constant}\\index{Boltzmann constant}',
'<br>$R_{d}=(R_{0}/M_{d}$) = \\sindex[lis]{Rd@$R_{d}=$gas constant for dry air}gas
constant for dry air\\index{gas constant!dry air}<br>',
'$R_{w}$ = ($R_{0}/M_{w})$ = \\sindex[lis]{Rw@$R_{W}$= gas constant for water vapor}gas
constant for water vapor\\index{gas constant!water vapor}<br>',
'$R_{E}$ = \\sindex[lis]{Re@$R_{E}$= radius of the Earth}radius of
the Earth\\index{radius of the Earth} = 6.371229$\\times 10^{6}$m\ \ $^{(f)}$\\footnote{ discussed
in \\prettyref{sec:INS}}<br>',
'$c_{p}$ = \\sindex[lis]{cp@$c_{p}$ or $c_{pd}$ = specific heat of dry air at constant pressure}specific
heat of dry air at constant pressure\\index{specific heat!dry air!constant pressure}
= $\\frac{7}{2}R_{d}$ = 1.00473$\\times10^{3}$ J\ kg$^{-1}$K$^{-1}$\ \ $^{(g)}$\\footnote{}<br>',
'$c_{v}$ = \\sindex[lis]{cv@$c_{v}$ or $c_{vd}$ = specific heat of dry air at constant volume}specific
heat of dry air at constant volume\\index{specific heat!dry air!constant volume}
= $\\frac{5}{2}R_{d}$ = 0.71766$\\times 10^{3}$ J\ kg$^{-1}$K$^{-1}$<br>',
'\\noindent\\parbox[t]{1\\textwidth}{%
\\hskip0.6cm(specific heat values are at 0$^{\\circ}$C; small variations
with temperature are not included here)%
}<br>',
'$\\gamma$ = \\sindex[lis]{gamma or gamma_{d} = ratio of specific heats of air, c_{p}/c_{v}@$\\gamma$ or $\\gamma_{d}$ = ratio of specific heats of air, $c_{p}/c_{v}$}ratio
of specific heats\\index{specific heat ratio, dry air}, $c_{p}/c_{v}$,
taken to be 1.4 (dimensionless) for dry air<br>',
'$\\Omega$ = \\sindex[lis]{Omega= angular rotation rate of the Earth@$\\Omega$= angular rotation rate of the Earth}angular
rotation rate of the Earth\\index{Earth, angular rotation rate} =
7.292115$\\times10^{-5}$ radians/s<br>
$\\Omega_{Sch}$ = \\sindex[lis]{Omega_{Sch}= angular frequency of the Schuler oscillation@$\\Omega_{Sch}$= angular frequency of the Schuler oscillation}angular
frequency of the Schuler oscillation\\index{Schuler oscillation} =
$\\sqrt{\\frac{g}{R_{E}}}$<br>
$\\sigma$ = \\sindex[lis]{sigma= Stephan-Boltzmann constant@$\\sigma$= Stephan-Boltzmann constant}Stephan-Boltzmann
Constant\\index{Stephan-Boltzmann Constant} = 5.6704$\\times10^{-8}$W\ m$^{-2}$K$^{-4}$\ \ $^{(e)}$'
)
```
```{r echo=FALSE}
## get the values for the table in footnote (c):
fnc <- matrix(c('N~2~', 0.78102, 28.01340, 21.87903, 'O~2~', 0.20946, 31.99880, 6.70247,
                'Ar', 0.00916, 39.94800, 0.36592, 'CO~2~', 0.00033, 44.00950, 0.01452))
dim(fnc) <- c(4,4)
fnc <- as.data.frame(t(fnc))
names(fnc) <- c('Gas', 'mole fraction x', 'molecular weight M', 'x*M')
meanValue <- round(sum(as.numeric(fnc[, 4])), 4)
```
\_\_\_\_\_\_\_\_\_\_<br>
^(a)^ The International Standard Atmosphere specifies $g=9.80665$ m s^-2^,
$M_{w}$=28.9644 and $R_{0}$ = 8.31432x10^3^ J kmol^-1^K^-1^,
so these values are used to calculate pressure altitude.  
^(b)^ cf. Moritz, H., 1988: Geodetic Reference System 1980, Bulletin Geodesique,
Vol. 62 , no. 3, and [this link](https://earth-info.nga.mil/php/download.php?file=coord-wgs84).    
^(c)^ Jones, F. E., 1978: J. Res. Natl. Bur. Stand., 83(5), 419, as quoted
by Lemmon, E. W., R. T. Jacobsen, S. G. Penoncello, and D. G., Friend,
J. Phys. Chem. Ref. Data, Vol. 29, No. 3, 2000, pp. 331-385. The quoted
values of mole fraction are from Jones (1978) and the calculation of mean
molecular weight is shown in the following table
using values of molecular weights
taken from the NIST Standard Reference Database 69: NIST Chemistry
WebBook as of March 2011. With CO~2~ about 0.00041 (as in 2020) and others
decreased proportionately, the mean is 28.9640.
```{r include = TRUE, echo = FALSE}
knitr::kable(fnc, format = 'html', caption = 'Calculation of the mean molecular weight of air',
             table.attr = "style='width:70%;'")
```
\ \ \ \ \ \ \ \ \ \ The mean value is `r meanValue`, but see above for a more modern adjustment.<br><br>
^(d)^ NIST Standard Reference Database 69: NIST Chemistry WebBook as of
March 2011.<br>
^(e)^ 2006 CODATA  
^(f)^ matching the value used by the inertial reference systems, as discussed 
in the "INS" section.  
^(g)^ The specific heat of dry air at 1013 hPa and 250--280 K as given
by Lemmon et al. (2000) is 29.13 J/(mol-K), which translates to $1005.8\pm 0.3$
J/(kg-K). However, the uncertainty limit associated with values of
specific heat is quoted as 1%, and the experimental data cited in
that paper show scatter that is at least comparable to several tenths
percent, so the ideal-gas value cited here is well within the range
of uncertainty. For this reason, and because this value is in widespread
use, the ideal-gas value is used throughout the algorithms described
here.

</blockquote>



<!--chapter:end:01-intro.Rmd-->

# General Information About Data Files

## System of Units

This report uses the SI system of units, but with many exceptions. Among them are the following:  

1. The millibar (mb), equal to one hectopascal (hPa), was used for pressure with some older variables.  
2. Many variables are presented in the units most often used for that variable, even when they involve CGS units or mixed CGS-MKS units, as for example [g m^-3^] for liquid water content or
[cm^-3^] for droplet concentration.  
3. Flow rates are often quoted in liters per minute (LPM) or standard liters per minute (SLPM) because those terms are linked to properties of commercially available instruments with flow control. One liter is 10^-3^m^3^. Standard temperature and pressure are respectively 273.15 K and 1013.25 hPa. However, there is considerable ambiguity in the definition of “standard” conditions (mostly regarding the choice of the reference temperature) because some flow controllers and flowmeters specify a different “standard” temperature, so the particular usage will be documented when this term is used. Mass flow meters provide a measure of the flow of mass but usually report the measurement in terms of the volume flow that would be present under standard conditions (e.g.., SLPM). Therefore, to convert to volumetric flow at other conditions, if the fluid density is $\rho$ and the mass flow rate in units of mass per time is denoted by $\dot{m}^\prime$, the volumetric flow is $Q=\dot{m}^\prime/\rho$. Then the mass flow rate in units of standard volume per time is $\dot{m}=\dot{m}^\prime/\rho_s$ where $\rho_s$ is the density of the fluid under standard conditions. To convert to volumetric flow under other conditions, $Q(p,T)=\dot{m}^\prime/\rho$ = $\dot{m}\rho_s/\rho$ = $\dot{m}p_{s}T/(p\thinspace T_{s})$ where $p$ and $T$ are the pressure and absolute temperature for the desired measurement and $p_s$ amd $T_s$ are the corresponding values for standard conditions.  
4. The International Bureau of Weights and Measures recommends against use of units like percent or parts per million, but these are in common use in atmospheric chemistry and elsewhere so data files continue to use those units for relative humidity or the concentration of chemical species. Proper SI units for a volumetric mixing ratio would be, e.g., $\mu$mol\ mol^-1^, nmol\ mol^-1^, or pmol\ mol^-1^, but variables are instead often assigned the respective units of ppmv, ppbv or pptv for parts per million, billion or trillion by volume. Care must be taken to interpret ppbv especially, because “billion” has different meaning in different languages and different countries; herein, 1 ppbv means a volumetric ratio of 1:10^9^. Many measurements produce native results in terms of a mass ratio, often described as a mixing ratio $r_m$ that specifies the mass of the measured gas per unit mass of “air” (where the mass of the “air” does not include the variable constituents, usually only significant for water vapor). The perfect gas law relates the density ratio of two gases $(\rho_1:\rho_2)$ to the ratio of their partial pressures $(p_1:p_2)$ or number densities $(n_1:n_2)$ as follows:  
\begin{align}
r_{m}=\frac{\rho_{1}}{\rho_{2}}=\frac{p_{1}M_{1}}{p_{2}M_{2}}=\frac{n_{1}M_{1}}{n_{2}M_{2}}
(\#eq:rm)
\end{align}
where $M_1$ and $M_2$ are respective molecular weights for the two gases. The ratio of number densities or, equivalently, partial pressures, denoted here as $r_v$ because it is also the volumetric mixing ratio, is related to the mass mixing ratio as follows:  
\begin{equation}
r_{v}=\frac{n_{1}}{n_{2}}=\left(\frac{M_{2}}{M_{1}}\right)r_{m}
(\#eq:rv)
\end{equation}
When concentrations are recorded with units of “ppmv”, “ppbv” or “pptv”, these units refer respectively to $10^6r_v$, $10^9r_v$, and $10^{12}r_v$ with $r_v$ given by the above equation.  
5. The unit “hertz” (abbreviation Hz) is the proper unit for a periodic sampling frequency and will be used here in place of the more awkward “samples per second.” This usage is favored by the International Bureau of Weights and Measures (cf. <a href="http://www.bipm.org/en/si/si_brochure/chapter2/2-2/table3.html#notes">http://www.bipm.org/en/si/si_brochure/chapter2/2-2/table3.html#notes</a>) when the frequency represented refers to the rate of sampling.  
6. In some cases, particularly for older data files, speed has been recorded in units of knots (= 0.514444 m/s) and distance in nautical miles <span class="math inline">≡</span> 1852 m).  

In Appendix A there is a list of symbols.^[Some symbols used only once and defined where they are used are omitted from this list] The next table defines some abbreviations and additional symbols used for units in this report, in addition to the standard abbreviations for the mks system of units:<span id="punch1.2" label="punch1.2">[punch1.2]</span>  
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><strong>abbreviation/symbol</strong></th>
<th style="text-align: left;"><strong>definition</strong>^[where the symbol <span class="math inline">≡</span> is used, the relationship is exact by definition]
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">º</td>
<td style="text-align: left;">degree, angle measurement <span class="math inline">≡</span> (<span class="math inline"><em>π</em></span>/180) radian</td>
</tr>
<tr class="even">
<td style="text-align: center;">ft</td>
<td style="text-align: left;">foot <span class="math inline">≡</span> 0.3048 m</td>
</tr>
<tr class="odd">
<td style="text-align: center;">mb</td>
<td style="text-align: left;">millibar <span class="math inline">≡</span> 100 Pa <span class="math inline">≡</span> 1 hPa</td>
</tr>
<tr class="even">
<td style="text-align: center;">ppmv</td>
<td style="text-align: left;">parts per million by volume (see item 4 above)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ppbv</td>
<td style="text-align: left;">parts per billion (<span class="math inline">10<sup>9</sup>)</span> by volume (see item 4 above)</td>
</tr>
<tr class="even">
<td style="text-align: center;">pptv</td>
<td style="text-align: left;">parts per trillion (<span class="math inline">10<sup>12</sup>)</span> by volume (see item 4 above)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">n mi</td>
<td style="text-align: left;">nautical mile <span class="math inline">≡</span>1852 m</td>
</tr>
<tr class="even">
<td style="text-align: center;">kt</td>
<td style="text-align: left;">knot (n mi/hour) <span class="math inline">≡</span> (1852/3600) m/s = 0.514444... m/s</td>
</tr>
</tbody>
</table>
<!-- % <h2 id="variables-used-to-denote-time">Variables Used To Denote Time</h2> -->

## Variables Used to Denote Time

Although there are some exceptions in old archived data files, the data in all modern output files are referenced to Coordinated Universal Time (UTC). The time and date of the data acquisition system are synchronized to time from the Global Positioning System (GPS) at the beginning of each flight, and for data acquired by the present ADS-3 (NIDAS) data acquisition system time is synchronized continuously with the GPS time. Time variables vary for older archived data files; some of the following are obsolete, but are included here for reference because they are important to those wanting to use those archives.

#### Time (s): Time {-#time} 

<em>The reference-time</em> counter <em>for the output data files,</em> used by data system versions beginning with ADS-3. It is an integer output at 1 Hz <em>and has an initial value of zero at the start of the flight</em>. Add this to the “Time:units” attribute found in the NETCDF header section to obtain the UTC time.</p>
<p>Example attribute: <code></code> <br />
<code></code><code>Time:units = “seconds since 2006-04-26 12:55:00 +0000” </code>;</p>
<p>For code examples that show how to use “Time” see:<br />
<code></code><a href="http://www.eol.ucar.edu/raf/Software/TimeExamp.html">http://www.eol.ucar.edu/raf/Software/TimeExamp.html</a></p>

#### Reference Start Time (s): base_time (<em>Obsolete; versions before ADS-3 only</em>) {-#base-time}

<em>The reference time for the netCDF output data files for data system versions before ADS-3.</em> It represents the time of the first data record. Its format is Unix time (elapsed seconds after midnight 1 January 1970). Add time_offset (below) to obtain the time for each data record. (Note: base_time is a single scalar, not a “record” variable, so it occurs just once in the output file.)

#### Time Offset from Reference Start Time (s): time_offset (<em>Obsolete)</em> {-#time-offset}

<em>The time offset from base_time of each data record used for the NETCDF output files produced by data system versions before ADS-3.</em> It starts at zero (0) and increments each second, so it can also be thought of as a record counter. Use this measurement and add base_time to obtain the time for each data record.

#### Raw Tape Time (h, min, s): HOUR, MINUTE, SECOND (<em>Obsolete</em>) {-#hms}

These three time variables are recorded directly from the aircraft’s data system. Since ADS-3, this information is replaced by the “Time” variable and the “Time:units” attribute of that variable.

#### Date (m, d, y): MONTH, DAY, YEAR (<em>Obsolete</em>) {-#mdy}

These three variables represent the date when the aircraft’s data system began recording data. They are repeated as 1 Hz variables but are NOT incremented if the time rolls over to the next day. Use base_time and time_offset for reference timing. Since ADS-3, this information is replaced by the “Time” variable and the “Time:units” attribute of that variable.

## Synchronization of Measurements {#synchronication-of-measurements}

<p>Measurements sampled under control of the “NIDAS” sampling system are acquired at 50 Hz. However, the standard archive files are produced at a rate of 1 Hz, and each sample is the average of 50 samples. Therefore, the time associated with measurements reported at 1 Hz is actually an average over the specified second, so the reference time for the averaged measurement is actually 0.5 s past the reported time. Analogous offsets apply to variables reported at other rates different from 50 Hz. Where it applies, electronic filters with cutoff frequency of 25 Hz are used with analog measurements. Higher-rate files are sometimes produced, standardized to 25 Hz but sometimes at other frequencies.
  
There are time shifts inherent in many of the measurements, and in some cases (e.g., those produced by inertial reference units) these time shifts arise because the information is transmitted from the measuring system at a time later than when it was sampled. In these cases, shifts (“lags”) are applied to the measurements. The lags may be either static or dynamic. Static lags are specified in a configuration file, saved for each project; dynamic lags provided as part of data sampling by specific instruments are recorded by NIDAS for use in processing. Dynamic lags are usually a difference in time from a gridded time value to the time it was actually acquired. e.g. for a 5-Hz parameter the expected or gridded millisecond offset into each second would be 0, 200, 400, 600, and 800. If the data actually were sampled or acquired at 50, 250, 450, 650, and 850 ms then the dynamic lag for this particular second would be -50 ms. Corrections for time lags are applied to measurements before conversion to one of the standard data rates.</p>
<p>Where data rates for particular measurements do not match the basic 50 Hz sampling rate, linear interpolation is used to obtain higher-rate values. For 1 Hz data files, measurements are then averaged within each second. For 25 Hz files, 50 Hz measurements are digitally filtered using a finite impulse response (FIR) filter, while data acquired at less than 25 Hz are linearly interpolated to 25 Hz and then FIR-filtered for smoothing.  

<p><span id="punch1.3" label="punch1.3">[punch1.3]</span></p>

## Other Comments on Terminology

### Variable Names in Equations

This report often uses variable names in equations, and sometimes there is potential for confusion because the variable names consist of multiple characters. In most cases, to denote that the variable name is the variable in the equation (as opposed to each of the letters in the variable name representing quantities to be multiplied together), the variable name has been enclosed in brackets, as in {TASX}. In addition, variable names are displayed with upright Roman character sets, while other symbols in equations are shown using slanted (script) character sets as is conventional for mathematical equations. In cases where code segments (usually expressed in C code) are included to document how calculations are performed, typewriter character sets indicate that the segment is a representation of how the processing could be coded. Such a code segment is not always a direct copy of the code in use, but such code is sometimes the most convenient way to express the algorithm in use. 

### Distinction Between Original Measurements and Derived Variables
  
Many of the variables in the data files and in this report are derived from combinations of measurements. The terms “raw” or “original” measurement are sometimes used for a minimally processed output received directly from a sensor or instrument. Such measurements may be converted to engineering units via calibration coefficients, but otherwise they are a direct representation of the output from a sensor.^[Calibration coefficients, e.g. those used to convert from voltage output from an analog sensor to a measured quantity with physical units like <span class="math inline">º</span>C, are not included or discussed in this report. They are normally included in project reports and, in recent years, many are included in the header of the NETCDF file.]
In contrast, derived variables (e.g., potential temperature) depend on one or more “raw” measurements and are not direct results of output from an instrument. For most derived measurements, a box that follows an introductory comment is used in this report to document the processing algorithm. The box has two parts; in the top are definitions used and explanations regarding variables that enter the calculation, while the bottom portion contains the equation, algorithm, or code segment that documents how the variable is calculated.<span id="punch1.4" label="punch1.4">[punch1.4]</span>  

### Dimensions in Equations

An effort has been made to avoid dimensions in equations except where it would be awkward otherwise. Some scale factors are introduced for only this purpose (e.g., to avoid dimensions in arguments to logarithmic or exponential functions), and some effort was made to isolate dimensions to defined constants rather than requiring that variables in equations be used with specific units. However, some exceptions remain to be consistent with historical usage.


<!--chapter:end:02-Section2.Rmd-->

# The State of the Aircraft {#the-state-of-the-aircraft}

The primary sources of information on the location and motion of the aircraft are inertial navigation systems and global positioning systems. Both are described in this section, and combined results that merge the best features of each into composite variables for location and motion are also discussed. Useful references for material in this section are <a href="http://nldr.library.ucar.edu/repository/assets/technotes/TECH-NOTE-000-000-000-064.pdf">Lenschow (1972)</a> and <a href="https://opensky.ucar.edu/islandora/object/archives%3A8152">RAF Bulletin 23</a>.  

## Inertial Reference Systems {#inertial-reference-systems}

An Inertial Navigation System (INS) or Inertial Reference Unit (IRU) provides measurements of aircraft position, velocity relative to the Earth, acceleration and attitude or orientation. The IRU provides basic measurements of acceleration and angular rotation rate, while the INS integrates those measurements to track the position, altitude, velocity, and orientation of the aircraft. For the GV, the system is a Honeywell Laseref IV HG2001 GD03 Inertial Reference System; for the C-130, it is a Honeywell Model HG1095-AC03 Laseref V SM Inertial Reference System. These systems are described on the EOL web site, at <a href="http://www.eol.ucar.edu/instruments/inertial-navigation-system-aka-inertial-reference-unit">this URL</a>. Data from the IRS come via a serial digital bit stream (the ARINC digital bus) to the ADS (Aircraft Data System). Because there is some delay in transmission and recording of these variables, adjustments for this delay are made when the measurements are merged into the processed data files, as documented in the NetCDF header files and as discussed in Section \@ref(synchronication-of-measurements). Typical delays are about 80 ms for variables including ACINS, PITCH, ROLL, and THDG.  

Some variables are recorded only on the original “raw” data tapes and are not usually included in final archived data files; these are discussed at the end of this subsection. See also the discussion in Section \@ref(obsolete-variables) for information on results from inertial systems that were used prior to installation of the present Honeywell systems.<span id="punch3.1" label="punch3.1">[punch3.1]</span>  

An Inertial Navigation System “aligns” while the aircraft is stationary by measurement of the variations in its reference frame caused by the rotation of the Earth. Small inaccuracy in that alignment leads to a “Schuler oscillation” that produces oscillatory errors in position and other measurements, with a period $\tau_{Sch}$ of about 84 minutes ($\tau_{Sch}=2\pi\sqrt{R_{E}/g}$). Position errors of less than $1.0\,$n mi/h are within normal operating specifications. See Section \@ref(combining-irs-and-gps-measurements) for discussion of additional variables, similar to the following, for which corrections are made for these errors via reference to data from a Global Positioning System.  

Some projects have used smaller Systron Donner C-MIGITS Inertial Navigation Systems with GPS coupling, usually in connection with special instruments like a wing-mounted wind-sensing system. For these units, variable names usually begin with the letter C but otherwise have names matching the following variables (e.g., CLAT). GPS coupling via a Kalman filter is incorporated in the measurements from these units. They are described at <a href="https://www.eol.ucar.edu/instruments/c-migits-insgps-system">this web address</a>.

Uncertainties associated with measurements from the IRS are discussed in a Technical Note, available at <a href="http://dx.doi.org/10.5065/D60G3HJ8">this URL</a>. See page 7 of that document and the tables on pages 41 and 49.  

### Standard Variables

#### Latitude (<span class="math inline">º</span>): LAT {#latitude .unnumbered}

<em>The aircraft latitude</em> <em>or angular distance north of the equator in an Earth reference frame</em>. <em></em> Positive values are north of the equator; negative values are south. The resolution is 0.00017<span class="math inline"><em></em><sup>∘</sup></span> and the accuracy is reported by the manufacturer to be 0.164<span class="math inline"><em></em><sup>∘</sup></span> after 6 h of flight. Values are provided by the INS at a frequency of 10 Hz.  

#### Longitude (<span class="math inline">º</span>): LON {#longitude .unnumbered}

<em>The aircraft longitude</em> or angular distance east of the prime meridian in an Earth reference frame. Positive values are east of the prime meridian; negative values are west. The resolution is 0.00017<span class="math inline"><em></em><sup>∘</sup></span> and the accuracy is reported by the manufacturer to be 0.164<span class="math inline"><em></em><sup>∘</sup></span> after 6 h of flight. Values are provided by the INS at a frequency of 10 Hz.  

#### Aircraft True Heading (<span class="math inline"><em></em><sup>∘</sup></span>): THDG {#thdg .unnumbered}

<em>The azimuthal angle between the center-line of the aircraft (pointing ahead, toward the nose) and a line of meridian.</em> This azimuthal angle is measured in a polar coordinate system oriented relative to the Earth with polar axis upward and azimuthal angle measured relative to true north. The heading thus indicates the orientation of the aircraft, not necessarily the direction in which the aircraft is traveling. The resolution is 0.00017<span class="math inline">º</span> and the accuracy is quoted by the manufacturer as 0.2<span class="math inline">º</span> after 6 h of flight. Values are provided by the INS at a frequency of 25 Hz. “True” distinguishes the heading from the magnetic heading, the heading that would be measured by a magnetic compass. For more information on the coordinate system used, see <a href="https://opensky.ucar.edu/islandora/object/archives%3A8152">RAF Bulletin 23</a>.<span id="punch3.2" label="punch3.2">[punch3.2]</span>  

#### Aircraft Pitch Attitude Angle (<span class="math inline">º</span>): PITCH {#pitch .unnumbered}

<em>The angle between the center-line of the aircraft (pointing ahead, toward the nose) and the horizontal plane in a reference frame relative to the Earth with polar axis upward.</em> Positive values correspond to the nose of the aircraft pointing above the horizon. The resolution is 0.00017<span class="math inline">º</span> and the accuracy is quoted by the manufacturer as 0.05<span class="math inline">º</span> after 6 h of flight. Values are provided by the INS at a frequency of 50 Hz.  

#### Aircraft Roll Attitude Angle (<span class="math inline">º</span>): ROLL {#roll .unnumbered}

<em>The angle of rotation about the longitudinal axis of the aircraft required to bring the lateral axis (along the wings) to the horizontal plane.</em> Positive angles indicate that the starboard (right) wing is down ((i.e., a clockwise rotation has occurred from level when facing forward in the aircraft). The resolution is 0.00017<span class="math inline">º</span> and the accuracy is quoted by the manufacturer as 0.05<span class="math inline">º</span> after 6 h of flight. Values are provided by the INS at a frequency of 50 Hz.  

#### Aircraft Vertical Acceleration (m s^-2^): ACINS {#ACINS .unnumbered}

<em>The acceleration upward (relative to the Earth) as measured by an inertial reference unit.</em> With INSs now in use, the internal drift that arises when this measurement is integrated to get aircraft vertical speed and then altitude is removed by the INS via pressure damping through reference to the pressure altitude.^[For earlier projects using the Litton LTN-51 INS, this is a direct measurement without adjustment for changes in gravity during flight and without pressure-damping. Previous use employed a baro-inertial loop to compensate for drift in the integrated measurement. See the discussion of WP3 below.]
Positive values are upward. The sample rate is 50 Hz and the resolution is 0.0024 m s<span class="math inline"><em></em><sup> − 2</sup></span>.  

#### Computed Aircraft Vertical Velocity (m/s): VSPD {#vspd .unnumbered}

<em>The upward velocity of the aircraft, or rate-of-climb relative to the Earth, as measured by the INS.</em> VSPD is determined within the INS by integration of the vertical acceleration, with damping based on measured pressure to correct for accumulated errors in the integration of acceleration. The sample rate is 50 Hz with a resolution of 0.00016 m/s. The Honeywell Laseref INS employs a baro-inertial loop, similar to that described below for WP3 and the Litton LTN-51, to update the value of the acceleration. This variable is also filtered within the INS so that there is little variance with frequency higher than 0.1 Hz.  

#### Aircraft Rate of Climb (m/s): ROC (new 2017) {#roc .unnumbered}

<em>The rate of climb or upward speed of the aircraft,</em> as measured by the INS with correction so as to represent the derivative of the geometric height. This variable is calculated by integration of the variable ACINS and then addition of the low-pass-filtered difference between that integral and the climb rate determined from the hydrostatic equation. The result retains the high-frequency response from the INS while matching the low-frequency average value determined from the hydrostatic equation, and so represents change in geometric height. <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107f.pdf">This memo</a> contains additional background information on this variable.<br />  
```{r child = 'ROCbox.Rmd'}
```

#### Pressure-Damped Aircraft Vertical Velocity (m/s): WP3 {#wp3 .unnumbered}

<span id="WP3 algorithm" label="WP3 algorithm"></span>This was a derived variable incorporating a third-order damping feedback loop to remove the drift from the inertial system’s vertical accelerometer (ACINS or VZI) using pressure altitude (PALT) as a long-term, stable reference. Positive values are up. The Honeywell INS now in use provides its own version of this measurement, VSPD, and WP3 is now considered obsolete (and in any case should not be calculated from ACINS as provided by the Honeywell Laseref IRS because that ACINS already incorporates pressure damping). Documentation is included here because many old data files include this variable. Note that “pressure altitude” is not a true altitude but an altitude equivalent to the ambient pressure in a standard atmosphere, so updating a variable integrated from inertial measurements to this value can introduce errors vs. the true altitude. WP3 was calculated by the data-processing software as follows (with coefficients in historical use and not updated to the recommendations elsewhere in this technical note):^[Regarding signs, note that ACINS is a number near zero, not near g, and so already has the estimated acceleration of gravity removed. The assumption made in the following is that the INS will report values adjusted for the gravitational acceleration <em>at the point of alignment</em>, which would be <span class="math inline"><em>G</em><sub><em>L</em></sub></span>. If <span class="math inline"><em>g</em><sub><em>F</em></sub></span>, the estimate for gravity at the flight altitude (palt) and latitude (lat), is <em>smaller</em> than <span class="math inline"><em>G</em><sub><em>L</em></sub></span> then the difference (<span class="math inline"><em>G</em><sub><em>L</em></sub> − <em>g</em><sub><em>f</em></sub></span>) will be positive; this will correct for the reference value for ACINS being the gravity measured at alignment (<span class="math inline"><em>G</em><sub><em>L</em></sub></span>) when it should actually be the sensed gravity (<span class="math inline"><em>g</em><sub><em>f</em></sub></span>) at the measurement point, so to obtain (sensed acceleration - <span class="math inline"><em>g</em><sub><em>f</em></sub></span>) it is necessary to add (<span class="math inline"><em>G</em><sub><em>L</em></sub> − <em>g</em><sub><em>f</em></sub></span>) to ACINS, <em>increasing</em> “acz” in this case. However, the situation with “vcorac” is reversed: “vcorac” is a positive term for all eastward flight, for example, but in that case the motion of the aircraft makes objects seem lighter (i.e., they experience less acceleration of gravity) than without such flight. ACINS is positive upward so it represents a net acceleration of the aircraft upward (as imposed by the combination of gravity and the lift force of the aircraft). To accomplish level flight in these circumstances, the aircraft must actually accelerate downward so the accelerometer will experience a negative excursion relative to slower flight. To compensate, “vcorac” must make a positive contribution to remove that negative excursion from “acz”. In the conceptual extreme that the aircraft flies fast enough for the interior to appear weightless, ACINS would reduce to -1<span>*</span><span class="math inline"><em>G</em><sub><em>L</em></sub></span> and vcorac would increase to +<span class="math inline"><em>G</em><sub><em>L</em></sub></span>, leaving acz near zero as required if the aircraft were to remain in level flight in the rotating frame.]
<br />  
```{r child = 'WP3box.Rmd'}
```

#### Inertial Altitude (m): ALT {#alt .unnumbered}

<em>The altitude of the aircraft as provided by an INS</em>, with pressure damping applied within the INS to the integrated aircraft vertical velocity to avoid the accumulation of errors. The value therefore is updated to the pressure altitude, not the geometric altitude, and should be regarded as a measurement of pressure altitude that has short-term variations as provided by the INS. The sample rate is 25 Hz with a resolution of 0.038 m. In some projects ALT also referred to the altitude from the avionics GPS system; the preferred and current variable name for that is ALT_G.<span id="punch3.10" label="punch3.10">[punch3.10]</span>  

#### Aircraft Ground Speed (m/s): GSF {-#gsf}

<em>The ground speed of the aircraft as provided by an INS.</em> The resolution is 0.0020 m/s, and the INS provides this measurement at a frequency of 10 Hz.  

#### Aircraft Ground Speed East Component (m/s): VEW {#vew .unnumbered}

<em>The east-directed component of ground speed as provided by an INS.</em> The resolution is 0.0020 m/s, and the INS provides this measurement at a frequency of 10 Hz.  

#### Aircraft Ground Speed North Component (m/s): VNS {#vns .unnumbered}

<em>The north-directed component of ground speed as provided by an INS.</em> The resolution is 0.0020 m/s, and the INS provides this measurement at a frequency of 10 Hz.  

#### Distance East/North of a Reference (km): DEI, DNI {#dei-dni .unnumbered}

<em>Distance east or north of a project-dependent reference point.</em> These are derived outputs obtained by subtracting a fixed reference position from the current position. The values are determined from measurements of latitude and longitude and converted from degrees to distance in a rectilinear coordinate system. The reference position can be either the starting location of the flight or a user-defined reference point (e.g., the location of a project radar). The accuracy of these values is dependent on the accuracy of the source of latitude and longitude measurements (see LAT and LON), and the calculations are only appropriate for short distances because they do not take into account the spherical geometry of the Earth.<span id="punch:3.11" label="punch:3.11">[punch:3.11]</span><br />  
```{r child='DNSbox.Rmd'}
```

#### Radial Azimuth/Distance from Fixed Reference FXAZIM, FXDIST {#fxaxim .unnumbered}

<em>Azimuth and distance from a project-dependent reference point.</em> The units of the azimuthal angle are degrees (relative to true north) and the distance is in kilometers. These are calculated by rectangular-to-polar conversion of DEI and DNI, described in the preceding paragraph.  

### Additional Special-Use Variables

The following INS and IRU variables are not normally included in archived data files, but their values are recorded by the ADS and can be obtained from the original “raw” data files:

#### Raw Lateral Body Acceleration (m/s^2^): BLATA {#blata .unnumbered}

The raw output from the IRU lateral accelerometer. Positive values are toward the starboard, normal to the aircraft center line. The sample rate is 50 Hz with a resolution of 0.0024 m s^-2^.  

#### Raw Longitudinal Body Acceleration (m/s^2^): BLONA {#blona .unnumbered}

The raw output from the IRU longitudinal accelerometer. Positive values are in the direction of the nose of the aircraft and parallel to the aircraft center line. The sample rate is 50 Hz with a resolution of 0.0024 m s^-2^.  

#### Raw Normal Body Acceleration (m/s^2^): BNORMA {#bnorma .unnumbered}

The raw output from the IRU vertical accelerometer. Positive values are upward in the reference frame of the aircraft, normal to the aircraft center line and lateral axis. The sample rate is 50 Hz with a resolution of 0.0024 m s^-2^.

#### Raw Body Pitch Rate (<span class="math inline">º</span>/s): BPITCHR {-#bpitchr}

The raw output of the IRU pitch rate gyro. Positive values indicate the nose moving upward and refer to rotation about the aircraft’s lateral axis. The sample rate is 50 Hz with a resolution of 0.0039<span class="math inline">º</span>/s.  

#### Raw Body Roll Rate (<span class="math inline">º</span>/s): BROLLR {#brollr .unnumbered}

The raw output of the IRU roll rate gyro. Positive values indicate starboard wing moving down and refer to rotation about the aircraft center line. The sample rate is 50 Hz with a resolution of 0.0039<span class="math inline">º</span>/s.  

#### Raw Body Yaw Rate (<span class="math inline">º</span>/s): BYAWR {#byawr .unnumbered}

The raw output of the IRU yaw rate. Positive values represent the nose turning to the starboard and refer to rotation about the aircraft’s vertical axis. The sample rate is 50 Hz with a resolution of 0.0039<span class="math inline">º</span>/s.  

## Global Positioning Systems

Primary GPS variables specifying the position and velocity of the aircraft are provided by GPS receivers, currently a NovAtel Model OEM 5 unit on the GV and a NovAtel Model OEM-4 receiver on the C-130 (to be replaced by an OEM-6 after January 2014). See <a href="http://www.eol.ucar.edu/instruments/research-global-positioning-system">this link</a> for a description of these systems. The coordinate system used for all GPS measurements is the World Geodetic System WGS-84; for details, see <a href="http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf">this link</a>.^[There are four measures of height or altitude discussed in this technical note, height relative to the WGS-84 reference surface, geometric height relative to mean sea level, geopotential height and pressure height. The WGS-84 height (measured by GPS instruments) is height relative to a reference system in which zero is defined by a specified reference ellipsoid representing the shape of the Earth, as specified here: <a href="http://earth-info.nga.mil/GandG/publications/tr8350.2/tr8350_2.html">http://earth-info.nga.mil/GandG/publications/tr8350.2/tr8350_2.html</a>,. This is not defined to be a level surface in the sense of being an equipotential surface. A better approximation of mean sea level is the “geoid”, a surface having constant gravitational equipotential that approximates mean sea level. The geoid is more structured than the WSR-84 reference ellipsoid and departs significantly from it, often by several 10s of meters. Even the geoid does not represent mean sea level exactly because local mean sea level can be influenced by variations in water density, mean wind, or ocean circulation, but the geoid is usually the reference used for measurements labeled “MSL” except when fine-scale local effects must be considered. The geometric height is the true height above a reference surface, often taken to be mean sea level or the geoid; this may therefore differ significantly from the height measured directly by a GPS unit. There is a variable included below, GGEOIDHT, that provides a measure of the difference. Geopotential height is the height above mean sea level that would give the geopotential, or gravitational potential energy per unit mass, of the actual parcel if that mass were raised against standard gravity (not varying, e.g., with latitude or height) to that altitude. For the purpose of this definition, standard gravity is defined to be 9.80665<span class="math inline"> <em>m</em> <em>s</em><sup> − 2</sup></span>. Finally, pressure altitude, defined in detail below, is the altitude in the ISA Standard Atmosphere where the pressure matches a specified value; it is not a geometric coordinate but rather a measure of pressure.]
The uncertainty of the position measurements is specified by the manufacturer to be 1.5 m CEP horizontal (3.3 m 95% CEP).^[CEP is the Circular Error Probability, the radius of a circle that contains 50% of the measurements; 95% CEP contains 95% of the measurements. When OnmiSTAR corrections are available (involving extra cost and not available in all areas of the globe, so not available for all projects) the uncertainty decreases to 0.15 m 95% CEP. The vertical uncertainty is about twice as great as the horizontal uncertainty. Because variables are stored as 4-byte single-precision floating point numbers, the inherent storage precision can limit the precision of the recorded position to about 1 m.]
The accuracy of velocity measurements is 0.03 m/s RMS for all axes. All variables are provided by the GPS receivers at 5 Hz. Latitude and longitude are recorded in a special log file (called the GPGGA log) with a resolution of 0.0001 degree, while Earth-relative velocity is recorded in the GPRMC log with resolution of 0.1 m/s. Starting in January 2014 new logs (named BESTPOS and BESTVEL) have also been recorded to preserve more significant digits in the measurements. The BESTPOS log has a position resolution of <span class="math inline">10<sup> − 11</sup>deg </span>, while the BESTVEL log is recorded with 0.0001 m/s resolution.  

Some of the following variables are also available from alternate Garmin GPS16 receivers, for which the variable name is qualified by the name of that unit; e.g., GGLAT_GMN for GGLAT as measured by a Garmin GPS unit. In addition, some of the measurements from the GPS units that are part of the aircraft avionics systems are recorded; these are denoted by a suffix “_G” or “_A”. Measurements from before about 2000 used Trimble TANS-III receivers, <span id="punch3.3" label="punch3.3">[punch3.3]</span>with the ability to track up to 6 satellites at a time but needing only 4 to provide 3-dimensional position and velocity data (3 satellites for 2-dimensions). The accuracy of the position measurements for that unit was stated to be 25 meters (horizontal) and 35 meters (vertical) under “steady-state conditions.”^[The GPS signals at one time suffered from “selective availability,” a US DOD term for a perturbed signal that degraded GPS absolute accuracy to 100 meters. This was especially noticeable in the altitude measurement, so GALT normally was not useful. As of 1 May 2000, selective availability was deactivated to allow everyone to obtain better position measurements. See the Interagency GPS Executive Board web site for more information on selective availability and GPS measurements prior to 2000.]
Likewise, velocity measurements are within 0.2 m/s for all axes. Measurement resolution is that of 4-byte IEEE format (about 6 significant digits). All variables were provided by the Trimble receivers at 1 Hz.  

A special correction is needed for variables GGVEW, GGVNS, and GGVSPD, which measure the motion <em>at the GPS antenna</em> relative to the Earth. The conventional wind calculation addresses the difference between the motion at the radome (where the relative wind is measured) and the INS (where variables VEW, VNS, VSPD are measured) arising from rotation of the aircraft. However, if GGVSPD is used instead of VSPD for vertical wind or GGVEW and GGVNS are used (perhaps via the complementary filter) for the horizontal wind, an additional correction is needed for the displacement between the GPS antenna and the INS receiver. On the GV, this distance is -4.30 m. A correction for aircraft rotation is therefore applied to GGVSPD, as described below.  

#### GPS Latitude (<span class="math inline">º</span>): GGLAT, LAT_G; also formerly GLAT {#gglat .unnumbered}

<em>The aircraft latitude measured by a global positioning system.</em> Positive values are north of the equator; negative values are south. These variables are recorded in netCDF files as single-precision values. GGLAT is provided by the data-system GPS; LAT_G and LATF_G are from the avionics system GPS. LATF_G is a fine-resolution measurement that requires special processing.</p>

#### GPS Longitude (<span class="math inline">º</span>): GGLON, LON_G; also formerly GLON {#gglon .unnumbered}

<em>The aircraft longitude measured by a global positioning system.</em> Positive values are east of the prime meridian; negative are west. GGLON is provided by the (or a) data-system GPS; LON_G and LONF_G are from the avionics system GPS. LONF_G is a fine-resolution measurement that requires special processing. <span id="punch:3-12" label="punch:3-12">[punch:3-12]</span>  

#### GPS Ground Speed (m/s): GGSPD, GSF_G {#ggspd .unnumbered}

<em>The aircraft ground speed measured by a global positioning system.</em> GGSPD originates from a data-system GPS; GSF_G originates from an avionics-system GPS.  

#### GPS Ground Speed Vector East Component (m/s): GGVEW, VEW_G {#ggvew .unnumbered}

<em>The eastward component of ground speed measured by a global positioning system.</em> GGVEW originates from a data-system GPS; VEW_G originates from an avionics-system GPS. In the case of GGVEW, when this is used in the calculation of horizontal wind, the following correction would be needed:
\begin{equation}
\mathrm{\{GGVEWA\}}=\mathrm{\{GGVEW\}-L_G}\dot{\psi}\frac{\cos\psi}{\cos\phi}
(\#eq:GGVEWA)
\end{equation}  
where GGVEWA is the corrected value used in the wind calculation, , and $\psi$ and $\phi$ are respectively the heading and roll angles, <span class="math inline"><em>L</em><sub><em>G</em></sub> =  − 4.30</span> m for the GV, and $\dot{\psi}$ is the rate-of-change of heading (in radians). The variable BYAWR transmitted from the INS gives the rate-of-change of heading after conversion from <span class="math inline">$^{\circ}\thinspace s^{-1}$</span> to radians <span class="math inline"><em>s</em><sup> − 1</sup></span>. This correction is not applied in normal processing because the use of the complementary filter, discussed in Sect.\ \@ref(combining-irs-and-gps-measurements), makes it of negligible importance. More information is contained in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107.pdf">this memo</a>.  

#### GPS Ground Speed Vector North Component (m/s): GGVNS, VNS_G {#ggvns .unnumbered}

<em>The northward component of ground speed as measured by a global positioning system.</em> GGVNS originates from a data-system GPS; VNS_G originates from an avionics-system GPS. In the case of GGVNS, when this is used in the calculation of horizontal wind, the following correction would be needed:
\begin{equation}
\mathrm{\{GGVNSA\}} = \mathrm{\{GGVNS\}}+L_{G}\dot{\psi}\frac{\sin\psi}{\cos\phi}
(\#eq:GGVNSA)
\end{equation}  
where GGVNSA is the corrected value used in the wind calculation, $\psi$ and $\phi$ are respectively the heading and roll angles, <span class="math inline"><em>L</em><sub><em>G</em></sub> =  − 4.30</span> m for the GV, and $\dot{\psi}$ is the rate-of-change of heading (in radians). The variable BYAWR transmitted from the INS gives the rate-of-change of heading <span class="math inline"><em>ψ̇</em></span> after conversion from <span class="math inline">$^{\circ}\thinspace s^{-1}$</span> to radians <span class="math inline"><em>s</em><sup> − 1</sup></span>. This correction is not applied in normal processing because the use of the complementary filter, discussed in Sect.\ \@ref(combining-irs-and-gps-measurements), makes it of negligible importance, as discussed in the note referenced for GGVEW.  

#### GPS-Measured Aircraft Vertical Velocity (m/s): GGVSPD; also (obsolete) VSPD_G and GVZI {#ggvspd .unnumbered}

<em>The aircraft vertical velocity provided by a GPS unit.</em> Positive values are upward.<span id="punch3.9" label="punch3.9">[punch3.9]</span> When GGVSPD is used in the calculation of vertical wind, the following correction (omitted before 2017) is applied:<span id="punch:3-13" label="punch:3-13">[punch:3-13]</span>
\begin{equation}
\mathrm{\{GGVSPDA\}} = \mathrm{\{GGVSPD\}}-L_{G}\dot{\theta}
(\#eq:GGVSPDA)
\end{equation}
where <span class="math inline"><em>L</em><sub><em>G</em></sub> =  − 4.30</span> m for the GV and $\dot{\theta}$ is the rate-of-change of the pitch angle, corresponding to the IRU variable BPITCHR<span>*</span><span class="math inline"><em>π</em></span>/180. The variable GGVSPDA is used internally but not recorded in the data archives. See <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107.pdf">this memo</a> for additional justification.  

#### GPS Altitude (m MSL): GGALT, GALT_A {#ggalt .unnumbered}

<em>The aircraft altitude</em> <em>measured by a global positioning system.</em> The measurement is with respect to the geoid as represented internally by the GPS receiver and is determined by adding the adjustment --GGEOIDHT to the direct measurement relative to the ellipsoidal Earth model of the GPS, which is defined by WGS-84. Positive values are above the reference surface. GGALT originates from a data-system GPS; GALT_A originates from an avionics-system GPS. See the discussion of height at the beginning of this subsection and the variable GGEOIDHT below for interpretation of these GPS-based measurements.  

#### GPS Altitude above the WGS94 reference ellipse (m): GGHWGS {#gghwgs .unnumbered}

<em>The aircraft altitude above the ellipse that is the reference for the WGS-84 coordinate system.</em> This variable is defined as GGHWGS=GGALT<span class="math inline">+</span>GGEOIDHT.<span id="punch3.4-1" label="punch3.4-1">[punch3.4-1]</span>  

#### GPS Geopotential Altitude (m): GEOPTH {#geoph .unnumbered}

<em>The aircraft geopotential altitude above mean sea level.</em> If <span class="math inline"><em>g</em>(<em>z</em>, <em>λ</em>)</span> is the acceleration of gravity as represented by the formula in the Table of Constants in Section \@ref(constants-and-symbols), then the formula used for calculation of GEOPTH is obtained by integrating that formula from the reference surface for MSL (the geoid, <span class="math inline"><em>Δ</em></span> above the WGS84 reference ellipse) to the geometric altitude <span class="math inline"><em>H</em></span>, which is <span class="math inline"><em>H</em> + <em>Δ</em></span> above the reference ellipse. The result is normally close (within about 0.5 m) to that obtained with <span class="math inline"><em>Δ</em> = 0</span>. There are additional details in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/RecommendationReGEOPHT.pdf">this memo</a>.<br />
```{r child='GEOPTbox.Rmd'}
```

#### GPS Aircraft Track Angle (<span class="math inline">º</span>): GGTRK, TKAT_G {#ggtrk .unnumbered}

<em>The direction of the aircraft track (degrees clockwise from true north)</em> as measured by a data-system global positioning system (GGTRK) or an avionics-system GPS (TKAT_G)<em>.</em>  

#### GPS Height of the Geoid (m): GGEOIDHT {#ggeoidht .unnumbered}

<em>Height of geoid, approximating mean sea level, above the WGS-84 ellipsoid.</em> The height above mean sea level is found by subtracting this value from the height above the WGS-84 reference ellipse as provided by GPS-based measurements.<span id="punch3.4" label="punch3.4">[punch3.4]</span>  

#### GPS Satellites Tracked: GGNSAT {#ggnsat .unnumbered}

<em>The number of satellites tracked by a GPS unit.</em>  

#### GPS Quality Flag: GGQUAL {#ggqual .unnumbered} 

<em>GPS quality flag:</em><br />  
```{r child = 'GGQUALbox.Rmd'}
```

#### GPS Mode: GMODE (obsolete) {#gmode .unnumbered}

This is the former output from the Trimble GPS indicating the mode of operation. The normal value is 4, indicating automatic (not manual) mode and that the receiver is operating in 4-satellite (as opposed to fewer) mode.<span id="punch3.5" label="punch3.5">[punch3.5]</span>  

#### GPS Status: GGSTATUS, GSTAT_G, GSTAT {#ggstatus .unnumbered}

The status of the GPS receiver. A value of 1 indicates that the receiver is operating normally; a value of 0 indicates a warning regarding data quality. GGSTATUS indicates the status of the data-system GPS; GSTAT_G indicates the status of the avionics-system GPS. The obsolete variable GSTAT, formerly used for the same purpose, has the reverse meaning: A value of 0 indicates normal operation and any other code indicates a malfunction or warning regarding poor data accuracy.  

<span id="punch:3-14" label="punch:3-14">[punch:3-14]</span>

<!-- <h2 id="other-measurements-of-aircraft-altitude">Other Measurements of Aircraft Altitude</h2> -->

## Other Measurements of Aircraft Altitude {#other-measurements-of-aircraft-altitude}

#### Geometric Radio Altitude (m): HGM - (obsolete) {#hgm .unnumbered}

<em>The distance to the surface below the aircraft,</em> measured by a radar altimeter. The maximum range is 762m (2,500 ft). The instrument changes in accuracy at an altitude of 152 m: The estimated error from 152 m to 762 m is 7%, while the estimated error for altitudes below 152 m is 1.5 m or 5%, whichever is greater.  

#### Geometric Radar Altitude (Extended Range) APN-159 (APN-159) (m): HGME {#hgme-159 .unnumbered}

<em>The distance to the surface below the aircraft, measured by a radar altimeter.</em> There are two outputs from an APN-159 radar altimeter, one with coarse resolution (CHGME) and one with fine resolution (HGME). Both raw outputs cycle through the range 0-360 degrees, where one cycle corresponds to 4,000 feet for HGME and to 100,000 feet for CHGME. To resolve the ambiguity arising from these cycles, 4,000-foot increments are added to HGME to maintain agreement with CHGME. This preserves the fine resolution of HGME (1.86 m) throughout the altitude range of the APN-159.  

#### Geometric Radar Altitude (Extended Range) APN-232 (m): HGM232 {#hgm-232 .unnumbered}

<em>Altitude above the ground</em> as measured by an APN-232 radar altimeter.  

#### Height Above Terrain (m): ALTG {#altg .unnumbered}

<em>The aircraft altitude above the Earth’s surface</em> as represented by the next variable. If GGALT is the altitude above mean sea level, ALTG=GGALT<span class="math inline">−</span>SFC.  
 
#### Height of the Earth’s Surface (m MSL): SFC {#sfc .unnumbered}

<em>The altitude of the Earth’s surface</em> at a location directly below the aircraft. The data source is the Shuttle Radar Topography Mission of 2000. The height estimate is described in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/HeightOfTerrain.pdf">this memo</a>.  

#### Pressure-Damped Inertial Altitude (m): HI3 (obsolete) {#hi3 .unnumbered}

<em>The aircraft altitude obtained from the twice-integrated IRU acceleration (ACINS), pressure-adjusted to obtain long-term agreement with PALT.</em> Note that this variable has mixed character, producing short-term variations that accurately track the inertial system changes but with adjustment to the pressure altitude, which is not a true altitude. The variable is not appropriate for estimates of true altitude, but proves useful in the updating algorithm used with the LTN-51 INS for vertical wind. See the discussion of WP3. This variable is now obsolete.  

#### ISA Pressure Altitude (m): PALT {#palt .unnumbered}

<em>The geopotential altitude in the International Standard Atmosphere where the pressure is equal to the reference barometric (ambient) pressure (PSXC).</em>^[See “U.S. Standard Atmosphere, 1976”, NASA-TM-A-74335, available for download at <a href="http://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19770009539_1977009539.pdf">this URL</a>.]
The pressure altitude is best interpreted as a variable equivalent to the measured pressure, not as a geometric altitude. In the following description of the algorithm, some constants (identified by the symbol <span class="math inline"><em></em><sup>‡</sup></span>) are specified as part of the ISA and so should not be “improved” to more modern values such as those given in the table of constants in Section \@ref(constants-and-symbols) (e.g., <span class="math inline"><em>R</em><sub>0</sub><sup>‡</sup>).</span>^[Prior to and including some projects in 2010, processing used slightly different coefficients: for aircraft other than the GV, <span class="math inline"><em>T</em><sub>0</sub>/<em>λ</em></span> was represented by -43308.83, the reference pressure <span class="math inline"><em>p</em><sub>0</sub></span> was taken to be 1013.246, and the exponent <span class="math inline"><em>x</em></span> was represented numerically by 0.190284. For the GV, the value of <span class="math inline"><em>T</em><sub>0</sub>/<em>λ</em></span> was taken to be 44308.0, the transition pressure <span class="math inline"><em>p</em><sub><em>T</em></sub></span> was 226.1551 hPa, <span class="math inline"><em>x</em></span> = 0.190284, and coefficient <span class="math inline">$\frac{R_{0}^{\prime}T_{T}}{gM_{d}}$</span> was taken to be 6340.70 m instead of 6341.620 m as obtained below. The difference between these older values and the ones recommended below is everywhere less than 10 m and so is small compared to the expected uncertainty in pressure measurements, because 1 hPa change in pressure leads to a change in pressure altitude that varies from about 8–40 m over the altitude range of the GV.]
A note at <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PressureAltitude.pdf">this link</a> describes the pressure altitude in more detail and documents the change that was made in November 2010.<br />
```{r child = 'PALTbox.Rmd'}
```
<br />
<br />
<br />

#### Altitude, Reference (m MSL): ALTX (Obsolete), GGALTC (Obsolete) {#altx .unnumbered}

<span id="punch3.6" label="punch3.6">[punch3.6]</span> <em>Derived altitude above the geopotential surface,</em> obtained by combining information from a GPS receiver and an inertial reference system. This variable was intended to compensate for times when GPS reception was lost by incorporating information from the IRS measurement of altitude. GPS status measurements were used to detect signal loss, although sometimes this signal was delayed for a few seconds after the signal was lost. A 10-second running average was calculated of the difference between the GPS altitude and the reference altitude. When the sample-to-sample altitude difference changed more than 50 meters or when the GPS status detected a degraded signal, the derived variable (ALTX or GGALTC) became the alternate reference altitude adjusted by the latest running-average difference between that reference altitude and GGALT. When reception was recovered, to avoid a sudden discontinuity in altitude, the derived variable was adjusted back to the GPS altitude gradually over the next 10 seconds.<br />
<br />
This obsolete variable should be used with caution because the reference altitude used in past calculations was the IRS altitude updated to the pressure altitude of the aircraft. To account for the difference between pressure and geometric altitude, a regression equation was used, normally <span class="math inline"><em>z</em> = <em>a</em><sub>0</sub> + <em>a</em><sub>1</sub> * <em>P</em><em>A</em><em>L</em><em>T</em></span> where <span class="math inline"><em>a</em><sub>0</sub> =  − 46.3</span> m and <span class="math inline"><em>a</em><sub>1</sub> = 0.97866</span> but often adjusted dependent on project conditions. This introduced problems in early applications with the GV because it did not account for the pressure-altitude transition at the ISA tropopause. Use of a pressure altitude as reference introduces additional errors in altitude in regions that are not barotropic.<br />  

<!-- <h2 id="subsecirsgpscombining-irs-and-gps-measurements"><span id="subsec:IRS/GPS" label="subsec:IRS/GPS">[subsec:IRS/GPS]</span>Combining IRS and GPS Measurements</h2> -->

## Combining IRS and GPS Measurements {#combining-irs-and-gps-measurements}

Measurements from the global positioning and inertial navigation systems are combined to produce new variables that take advantage of the strengths of each, so that the resulting variables have the long-term stability of the GPS and the short-term resolution of the INS. This section describes some variables that result from this blending of variables. These corrected variables are usually the best available when the GPS and IRS are both functioning.  

One can determine if the GPS is functioning by examining the GPS status variables described in the previous section or by looking for spikes or “flat-lines” in the data. If the GPS data are missing for a short time (a few seconds to a minute), accuracy is not affected. However, longer dropouts will result in uncertainties degrading toward those of the INS. Without the GPS or another ground reference, the IRS error cannot be determined empirically, and one should assume that it is within the manufacturer’s specification (1 nautical mile of error per hour of flight, 90% CEP). When the GPS is active, RAF estimates that the correction algorithm produces a position with an error less than 1.5 m. <span id="punch3.7" label="punch3.7">[punch3.7]</span>Due to the nature of the algorithm, the error will increase from about 1.5 meters to the INS specification in about one-half hour after GPS information is lost.  

#### GPS-Corrected Inertial Ground Speed Vector (m/s):  VEWC, VNSC {#vewc-vnsc .unnumbered}

These variables result from combining GPS and INS output of the east and north components of ground speed from a complementary-filter algorithm.<span id="compFilter" label="compFilter">[compFilter]</span> Positive values are toward the east and north, respectively. The smooth, high-resolution, continuous measurements from the inertial navigation system, {VNS, VEW}, which can slowly accumulate errors over time, are combined with the measurements from the GPS, {GVNS, GVEW}, which have good long-term stability, via an approach based on a complementary filter. A low-pass filter, <span class="math inline"><em>F</em><sub><em>L</em></sub>({<em>G</em><em>V</em><em>N</em><em>S</em>, <em>G</em><em>V</em><em>E</em><em>W</em>})</span>, is applied to the GPS measurements of groundspeed, which are assumed to be valid for frequencies at or lower than the cutoff frequency <span class="math inline"><em>f</em><sub><em>c</em></sub></span> of the filter. Then the complementary high-pass filter, denoted (<span class="math inline">1 − <em>F</em><sub><em>L</em></sub></span>)(<span class="math inline">{<em>V</em><em>N</em><em>S</em>, <em>V</em><em>E</em><em>W</em>}</span>), is applied to the IRS measurements of groundspeed, which are assumed valid for frequencies at or higher than <span class="math inline"><em>f</em><sub><em>c</em></sub></span>. Ideally, the transition frequency would be selected where the GPS errors (increasing with frequency) are equal to the IRS errors (decreasing with frequency).<br />
<br />
The procedure is use now is documented in the <a href="http://dx.doi.org/10.5065/D60G3HJ8">Technical Note on Wind Uncertainty</a>, beginning on p. 125. It is a three-pole Butterworth low-pass filter, originally coded following the algorithm described in Bosic, S. M., 1980: <em>Digital and Kalman filtering : An Introduction to Discrete-Time Filtering and Optimum Linear Estimation,</em> p. 49. As described in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/checkCompFilter.pdf">this memo</a>, it has been revised (2014) to use coefficients generated by the R routine “butter().” The digital filter used is recursive, not centered, to permit calculation during a single pass through the data. If the cutoff frequency lies where both the GPS and INS measurements are almost the same, then the detailed characteristics of the filter (e.g., phase shift) in the transition region do not matter because the complementary filters have canceling effects when applied to the same signal. The transition frequency <span class="math inline"><em>f</em><sub><em>c</em></sub></span> was chosen to be (1/600) Hz. The Butterworth filter was chosen because it provides flat response away from the transition.^[For historical reasons, the details of the now obsolete filter as originally coded and used for many years are described here. For the current version with coefficients, see the memo referenced above.]<br />
 
```{r child="CF14box.Rmd"}
```
  
The net result then is the sum of these two filtered signals, calculated as described in the following boxes:  
```{r child="CFbox.Rmd"}
```
  
This result is used as long as the GPS signals are continuous and flagged as being valid. When that is not the case, some means is needed to avoid sudden discontinuities in velocity (and hence wind speed), which would introduce spurious effects into variance spectra and other properties dependent on a continuously valid measurement of wind. To extrapolate measurements through periods when the GPS signals are lost (as sometimes occurs, for example, in turns) a fit is determined to the difference between the best-estimate variables {VNSC,VEWC} and the IRS variables {VNS,VEW} for the period before GPS reception was lost, and that fit is used to extrapolate through periods when GPS reception is not available. The procedure is as described below.<br />
<span id="punch:3-15" label="punch:3-15">[punch:3-15]</span>  

<p class=box>
\ 1. If GPS reception has never been valid earlier in the flight, use the INS values without correction.<br>  
\ 2. Whenever both GPS and INS are good, update the low-pass-filtered estimate of the difference between them. This is added to the INS measurement to obtain the corrected variable. Also update a least-squares fit to the difference between the GPS and INS groundspeeds, for each component. The errors are assumed to result primarily from a Schuler oscillation, so the three-term fit is of the form $\Delta=a_1+a_2\sin(\Omega_{Sch}t)+a_3\cos(\Omega_{Sch}t)$, where $\Omega_{Sch}$  is the angular frequency of the Schuler oscillation (taken to be $2\pi/5067$\ s, and $t$ is the time since the start of the flight. A separate fit is used for each component of the velocity and each component of the position (discussed below under LATC and LONC). The fit matrix used to determine these coefficients is updated each time step but the accumulated fit factors decay exponentially with a 30-min decay constant, so the terms used to determine the fit are exponentially weighted over the period of valid data with a time constant that decays exponentially into the past with a characteristic time of 30 min. This is long enough to determine a significant portion of the Schuler oscillation but short enough to emphasize recent measurements of the correction.<br><br>
\ 3. When GPS data become invalid, if sufficient data (spanning 30 min) have been accumulated, invert the accumulated fit matrices to determine the coefficients {$a_1,a_2,a_3$} and then use the formula for $\Delta$ in the preceding step to extrapolate the correction to the IRS measurements while the GPS measurements remain invalid. Doing so immediately would introduce a discontinuity in {VNSC,VEWC}, however, so the correction $\Delta$ is introduced smoothly by adjusting {VNSC, VEWC} as follows: If $dvy$ is the adjustment added to the INS measurement, adjust it according to
$dvy^\prime=\eta\ dvy+(1-\eta)\Delta$ where $dvy^\prime$ is the sequentially adjusted correction and $\eta=0.995$ s$^{-1}$ is chosen to give a decaying transition with a time constant of about 5.5 min. This has the potential to introduce some artificial variance at this scale and so should be considered in cases where variance spectra are analyzed in detail, but it has much less influence on such spectra than a discontinuous transition would. Ideally, the current fit and the last filtered discrepancy (VNSC~0~$-$GVNS~0~ should be about equal, so transitioning between them should not introduce a significant change.<br><br>
\ 4. To avoid transients that would result from switching abruptly to the complementary-filter solution when the GPS measurements again become valid, the correction factors (e.g., $dvy$) are also updated smoothly toward the complementary-filter solution, using for example $dvy^\prime=\eta\ dvy+(1-\eta)F_L(v_y^{GPS}-v_y^{IRS})$ where $F_L$ is the low-pass filter and $v_y$ is the northward component of aircraft groundspeed.
</p>

#### GPS-Corrected Inertial Latitude and Longitude (<span class="math inline">º</span><strong>): LATC, LONC {#latc-lonc .unnumbered}

<em>Combined GPS and IRS output of latitude and longitude.</em> Positive values are north and east, respectively.<span id="punch:3-16" label="punch:3-16">[punch:3-16]</span> These variables are the best estimate of position, obtained by the following approach:<br />  
```{r child='LATLONbox.Rmd'}
```

<!-- <strong><span class="underline"></span></strong><br />   -->


<!--chapter:end:03-StateOfTheAircraft.Rmd-->

# The State of the Atmosphere {#the-state-of-the-atmosphere}

## Information on Instruments and Calibrations

The instruments used to collect the measurements that lead to the variables in this section are described on the EOL web site, in the “State Parameters” section at <a href="http://www.eol.ucar.edu/aircraft-instrumentation">this URL</a>. The data acquisition and processing for these variables and the calibration coefficients used where applicable are described .
 
## Variable Names

Measurements of some meteorological state variables like pressure, temperature, and water vapor pressure may originate from multiple sensors mounted at various locations on an aircraft. To distinguish among similar measurements, many variable names incorporate an indication of where the measurement was made. In this document, locations in variable names are represented by “x”, where “x” may be one of the following:
<center>
```{r, include = TRUE, echo = FALSE}
A.id <- data.frame(Character=c('B', 'B', 'F', 'G', 'R', 'T', 'W'))
A.id$location = c('bottom (or bottom-most)', 
              '(obsolete) boom',
              'fuselage',
              '(obsolete) gust probe',
              'radome',
              'top (or top-most)',
              'wing')
knitr::kable(A.id, align=c('c','l')) %>% kable_styling(bootstrap_options = 'bordered') %>%
  scroll_box(width='50%')
```
</center>
  
In addition, a true letter ’X’ (not replaced by the above letters) may be appended to a measurement to indicate that it is the preferred choice among similar measurements and is therefore used to calculate derived variables that depend on the measured quantity. Other suffixes sometimes used to distinguish among measurements are these: ’D’ for a digital sensor; ’H’ for a heated (usually, anti-iced) sensor, ’L’ for port-side sensors, and ’R’ for starboard-side sensors.  

## Pressure

### Standard Pressure Measurements

#### Static or Ambient Pressure (hPa): PSx, PSxC, PS_A, PSX, PSXC, PSFD, PSFRD {-#psx}

<em>The atmospheric pressure at the flight level of the aircraft, measured by a calibrated absolute (barometric) transducer at location x.</em> PSx is the measured static or ambient pressure before correction, and it may be affected by local flow-field distortion. PS_A is the pressure measurement taken from the avionics system on the aircraft, processed via unknown algorithms in the avionics system that may smooth, correct, and perhaps delay the result. PSxC is PSx corrected for local flow-field distortion (see <a href="https://opensky.ucar.edu/islandora/object/archives%3A8150">RAF Bulletin #21</a> and the discussion in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PCOR.pdf">this memo</a> and <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PcorCalculation.pdf">this supplement</a>), and PSXC is the preferred corrected measurement used for derived calculations. These measurements have been made using various sensors, so it is best to consult the project documentation for the transducer used. Recent measurements from both the C-130 and the GV have been made using a Paroscientific Model 1000 Digiquartz Transducer.

Corrections to the pressures have been determined by reference to some standard, including a “trailing cone” sensor, the pressure PS_A from the cockpit avionics system, or (since 2012) the Laser Air Motion Sensing System (LAMS). The latter correction is discussed in the memo <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PCOR.pdf">referenced above</a>, where corrections used prior to 2011 are also discussed. Beginning in 2012, the deduced corrections <span class="math inline"><em>Δ</em><em>p</em></span> to the measured pressures as functions of dynamic pressure <span class="math inline"><em>q</em>,</span> angle of attack <span class="math inline"><em>α</em>,</span>^[A weakness is this form for the pressure correction is that occasionally the radome ports become plugged with ice and the measurement of angle of attack is not available. When the variable ATTACK representing angle of attack is invalid, the angle of attack is instead calculated from PITCH<span class="math inline">−</span>VSPD/TASX, which approximates the angle of attack if the vertical wind is zero.]
and the Mach number <span class="math inline"><em>M</em></span> are described by the following equations and coefficients:

<blockquote>
<p><strong>For the C-130,</strong>^[For C-130 measurements prior to 2012 but after September 2003, the correction applied to PSF was <span class="math inline"><em>Δ</em><em>p</em> = <em>p</em> + max ((3.29 + {<em>Q</em><em>C</em><em>X</em>} * 0.0273),</span>4.7915) using units of hPa. Prior to Sept 2003, the correction was <span class="math inline"><em>Δ</em><em>p</em> = max ((4.66 + 11.4405<em>Δ</em><em>p</em><sub><em>α</em></sub>/<em>Δ</em><em>q</em><sub><em>r</em></sub></span>), 1.113). For both PSFD and PSFRD, the correction prior to (2012?) was <span class="math inline"><em>Δ</em><em>p</em> = <em>p</em> + max ((3.29 + {<em>Q</em><em>C</em><em>X</em>} * 0.0273),</span>4.7915). For GV measurements Aug 2006 to 2012, <span class="math inline"><em>Δ</em><em>p</em>=</span> (-1.02 + 0.1565<span>*</span>q) + q1<span>*</span>(0.008 + q1<span>*</span>(7.1979e-09<span>*</span>q1 - 1.4072e-05). Before Aug 2006: <span class="math inline"><em>Δ</em><em>p</em>=</span>(3.08 - 0.0894<span>*</span>{PSF}) + {QCF}<span>*</span>(-0.007474 + {QCF}<span>*</span>4.0161e-06).]
\begin{equation}
\frac{\Delta p}{p_{m}}=d_{0}+\frac{q_{m}}{p_{m}}(d_{1}+d_{4}\frac{\alpha^{2}}{a_{r}^{2}})+d_{2}\frac{\alpha}{a_{r}}+d_{3}\thinspace M
(\#eq:PCORC130)
\end{equation}
  
where, for <span class="math inline"><em>p</em><sub><em>m</em></sub></span> = PSFD , <span class="math inline"><em>q</em><sub><em>m</em></sub></span> = dynamic pressure (QCF), <span class="math inline"><em>α</em> = <em>A</em><em>T</em><em>T</em><em>A</em><em>C</em><em>K</em></span> and <span class="math inline"><em>a</em><sub><em>r</em></sub> = 1<sup>∘</sup></span> (included to keep the equation and coefficients dimensionless), and {<span class="math inline"><em>d</em><sub>0</sub>, <em>d</em><sub>1</sub>, <em>d</em><sub>2</sub>, <em>d</em><sub>3</sub>, <em>d</em><sub>4</sub></span>} = {-4.389e-03, -2.966e-02, -6.831e-05, 2.672e-02, 2.4466e-03}. For PSFRD, the corresponding coefficients are {0.007372, 0.12774, <span class="math inline">−</span>6.8776e-4, <span class="math inline">−</span>0.02994, 0.001630}. The latter coefficients are significantly different from the coefficients for PSFD, but the static ports where PSFRD is measured are at a different location on the fuselage so different flow-distortion effects are expected.</p>
</blockquote>

<br />

<blockquote>
<p><strong>For the GV,</strong>^[See <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PCOR.pdf">this memo</a> and <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PcorCalculation.pdf">this revision</a>for details regarding implementation of this representation of <span class="math inline"><em>Δ</em><em>p</em></span> for the GV.]
\begin{equation}
\frac{\Delta p}{p}=a_{0}+a_{1}\frac{q}{p}+a_{2}M^{3}+a_{3}\frac{\alpha}{a_{r}}
(\#eq:PCORforGV)
\end{equation}  
where, for <span class="math inline"><em>p</em></span> = PSF, <span class="math inline"><em>q</em></span> = QCF, <span class="math inline"><em>α</em> = <em>A</em><em>T</em><em>T</em><em>A</em><em>C</em><em>K</em></span>, and <span class="math inline"><em>a</em><sub><em>r</em></sub> = 1<sup>∘</sup></span> (included to keep the equation and coefficients dimensionless) {<span class="math inline"><em>a</em><sub>0</sub>, <em>a</em><sub>1</sub>, <em>a</em><sub>2</sub>, <em>a</em><sub>3</sub></span>} = {<span class="math inline"> − 0.012255</span>, <span class="math inline">0.075372</span>, <span class="math inline"> − 0.087508</span>, <span class="math inline">0.002148</span>}}.<span id="punch:4-10" label="punch:4-10">[punch:4-10]</span></p>
</blockquote>
<p><br />
<br />
In equations \@ref(eq:PCORC130) and \@ref(eq:PCORforGV) the Mach number is calculated from the uncorrected measurements of <span class="math inline"><em>p</em></span> and <span class="math inline"><em>q</em></span>, using dry-air values for <span class="math inline"><em>R</em></span>, <span class="math inline"><em>c</em><sub><em>v</em></sub></span> and <span class="math inline"><em>c</em><sub><em>p</em></sub></span>, via  
\begin{equation}
M=\left\{ \left(\frac{2c_{v}}{R}\right)\left[\left(\frac{p+q}{p}\right)^{R/c_{p}}-1\right]\right\}^{1/2}\,\,\,.
(\#eq:MachEquation)
\end{equation}  

For additional information on these correction coefficients, see <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/ARISTO-LAMS.pdf">this note</a> and Cooper et al. (2014).^[<a href="http://www.atmos-meas-tech.net/7/3215/2014/">Atmos. Meas. Tech., 7, 3215-3231</a>, 2014 doi:10.5194/amt-7-3215-2014.]
<br />

#### Dynamic Pressure (hPa): QCx, QCxC, QCX, QCXC, QC_A {-#qcx}

<em>The pressure excess caused by bringing the airflow to rest relative to the aircraft.</em> These quantities represent the difference between the total pressure <span class="math inline"><em>p</em><sub><em>t</em></sub></span> as measured at the inlet of a pitot tube or other forward-pointing port and the ambient pressure that would be present in the absence of motion through the air. The variable QC_A is provided by the avionic data system and is subject to an unknown delay and smoothing. The variables ending in “C” have been corrected for flow-distortion effects, mostly arising from errors in the measurement of static pressure. Since 2012, the corrections are based on measurements from the LAMS system as described for PSxC, and they have the same functional form as in \@ref(eq:PCORC130) and
\@ref(eq:PCORforGV) except that the correction applied to <span class="math inline"><em>q</em></span> is <span class="math inline"> − <em>Δ</em><em>p</em></span> with reversed sign because <span class="math inline"><em>q</em> = <em>p</em><sub><em>t</em></sub> − <em>p</em><sub><em>a</em></sub></span> and the error arises primarily from the error in <span class="math inline"><em>p</em><sub><em>a</em></sub></span>. The same correction is applied to QCR because it is also measured relative to the static pressure ports so errors in the pressure sensed at those ports affect QCR in the same way that QCF is affected. <span id="punch4.3" label="punch4.3">[punch4.3]</span>See the notes referenced in the preceding section, and also <a href="https://opensky.ucar.edu/islandora/object/archives%3A8150">RAF Bulletin 21</a> for the corrections applied to earlier data files.[^fnlabelspecial]

[^fnlabelspecial]: *C-130*, prior to 2012: For QCFC: subtract  max(4.66+11.4405 * $\mathrm{\{ADIFR\}}$ / $\mathrm{\{QCR\}}$, 1.113); For QCFRC prior to Sept 2003: same as for QCFC; after/including Sept 2003, subtract max(3.29+$\mathrm{\{QCX\}}$ * 0.0273,  4.7915); For QCRC: subtract max((3.29+$\mathrm{\{QCX\}}$ * 0.0273), 4.7915). *GV* Aug 2006 to 2012: For QCF, subtract (1.02+$\mathrm{\{PSF\}}$(0.215 - 0.04 * $\mathrm{\{QCF\}}$/1000.) + {QCF} * ($-0.003266$ + $\mathrm{\{QCF\}}$ * 1.613e-06)) 
<!-- <span id="punch4.2">  (punch4.2)</span> -->



A Rosemount Model 1221 differential pressure transducer is used for current measurements of dynamic pressure on the C-130, and a Honeywell PPT transducer is used on the GV.<span id="punch4.1" label="punch4.1">[punch4.1]</span> This measurement enters the calculation of true airspeed and Mach number and so is needed to calculate many derived variables.<br />
<br />
In the case of QCRC from the GV, one additional correction is applied (beginning 2017). The uncorrected measurement QCR is affected by flow angles, while QCF is not (for modest angle of attack or sideslip), so an additional adjustment is needed. The needed correction can be found by using an empirical relationship matching QCR to QCF, which leads to the following equation:  
\begin{equation}
\mathrm{\{QCR\}}=b_0+b_1\mathrm{\{QCR\}}+b_2\mathrm{\{AKRD\}}^2+b_3\mathrm{\{SSRD\}}^2-\Delta p
(\#eq:PCORforQCR)
\end{equation}

where $\Delta p$ is given by \@ref(eq:PCORforGV) and the coefficients are {<span class="math inline"><em>b</em><sub>0 − 3</sub></span>}={<span class="math inline"> − 0.5635</span>, <span class="math inline">0.9982</span>, 0.0273, <span class="math inline">0.0562</span>}. Some justification for this correction is contained in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107b.pdf">this note.</a> A similar correction is not made for measurements from the C-130 radome because they do not appear to be necessary, as discussed in that note.<br />

#### D-Value (m): DVALUE {-#dvalue}

The difference between geopotential altitude and pressure altitude (m). This variable is calculated from {GEOPHT}<span class="math inline">−</span>{PALT} and, for appropriate flight segments, can be used to measure height gradients on a constant-pressure surface. Prior to 2018, this was calculated from {GGALT} – {PALT}.</p>

### Special Pressure Measurements (hPa): PSDPx, CAVP, PCAB, PSURF {-#p-special}

<em>PSDPx and CAVP_x are measurements of the pressure in the housing of the dew-point sensors,</em> as discussed in connection with DPxC. <em>PCAB is a measurement of the pressure in the cabin of the aircraft. PSURF is the estimated surface pressure</em> calculated from HGME (a radar-altimeter measurement of height), TVIR, PSXC<span id="punch:4-11" label="punch:4-11">[punch:4-11]</span>, and MR using the thickness equation. [TVIR](#TVIR) and [MR](#MR) are described later in this section, and [HGME](#HGME) was described in Section \@ref(other-measurements-of-aircraft-altitude). The average temperature for the layer is obtained by using HGME and assuming a dry-adiabatic lapse rate from the flight level to the surface. Because of this assumption, the result is only valid for flight in a well-mixed surface layer or in other conditions in which the temperature lapse rate matches the dry-adiabatic lapse rate.^[The symbol <span class="math inline"><em></em><sup>†</sup></span> indicates that values are included in the table of constants in Sect.\ \@ref(constants-and-symbols).]
<br />
</p>  

```{r child='PSURFbox.Rmd'}
```

<!-- <h2 id="temperature">Temperature</h2> -->
## Temperature {#temperature-section}

#### Recovery Temperature (<span class="math inline">º</span>C): RTx, RTxH, RTHRx, RTX {-#recovery-t}

<em>The recovery temperature is the temperature sensed by a temperature probe that is exposed to the atmosphere.</em> In flight, the temperature is heated above the ambient temperature because it senses the temperature of air near the sensor that has been heated adiabatically during compression as it is brought near the airspeed of the aircraft. These variables are the measurements of that recovery temperature from calibrated temperature sensors at location x, for processing prior to about 2012; more recently, the names are simply RTF\# or RTH\# where \# is a number starting with 1.^[Prior to 2012, these variables were called “total temperature” and symbols starting with ’TT’ instead of ’RT’ were used. That name was misleading because these values are not true total-temperature measurements, for which the air would be at the same speed as the aircraft, but instead recovery-temperature measurements. The name has been changed to correct this mis-labeling, although this was a long-standing convention in past datasets.]
For Rosemount or HARCO temperature probes in current use, the recovery temperature is near the total temperature, but all probes must be corrected to obtain either true total temperature or true ambient temperature. In the standard output, the variable name also conveys the sensor type: RTF\# or RTx is a measurement from a Rosemount Model 102 non-deiced temperature sensor, RT\#H or RTxH is the measurement from a Rosemount Model 102 anti-iced (heated) temperature sensor, and RTH\# or RTHx is the measurement from a HARCO heated sensor. Some past experiments also used a reverse-flow temperature housing and a fast-response “K” housing; the associated variable names for these probes were TTRF and TTKP.^[See the related obsolete variables TTx, which are previously used names for these variables. The names were changed to clarify that the quantity represented is the recovery temperature, not the total temperature.]
</p>

#### Ambient Temperature (<span class="math inline"><em></em><sup>∘</sup></span>C): ATx, ATX, ATxH, ATxD {-#ambient-t}

<em>The temperature of the atmosphere at the location of the aircraft, as it would be measured by a sensor at rest relative to the air.</em> {#ATX} 
The ’x’ in the name of the variable used for ambient temperature, ATx, conveys the same information regarding sensor type and location as the variable name used with total (recovery) temperature. See the discussion above regarding RTx. The ambient temperature (also known as the static air temperature) is calculated from the measured recovery temperature, which is increased above the ambient temperature by dynamic heating caused by the airspeed of the aircraft. The calculated temperature therefore depends on the recovery temperature RTx as well as the dynamic and ambient pressure, usually respectively QCXC and PSXC. The ambient and dynamic pressures are first corrected from the raw measurements QCX and PSX to obtain variables that account for deviations caused by airflow around the aircraft and/or position-dependent systematic errors, as discussed in the section describing PSxC. The following basic equations are developed on the basis of conservation of energy for a perfect gas undergoing an adiabatic compression.<br />
<br />
This section combines discussion of the calculations of temperature and airspeed, to reflect the linkage between these derived measurements. To provide accuracy in the equations, this discussion considers effects of the humidity of the air on characteristics like the gas constant and the specific heats. Most archived data before 2012 used values for dry air, although a special variable TASHC has been used to represent the true airspeed in cases where the correction was significant. That variable is based on a good approximation to the results from the following equations; see the discussion of TASHC later in this section. TASHC is now considered an obsolete variable. New variables ATxD and TASxD have been introduced that neglect the humidity corrections and perform all calculations as if the humidity is negligible.<br />
<br />  
As discussed above, temperature sensors on aircraft that are exposed to the airflow do not measure the total temperature but rather the temperature of the air immediately in contact with the sensing element. This air will not have undergone an adiabatic deceleration completely to zero velocity and hence will have a temperature <span class="math inline"><em>T</em><sub><em>r</em></sub></span> somewhat less than the total temperature <span class="math inline"><em>T</em><sub><em>t</em></sub></span> that would require the air to reach zero velocity. <span class="math inline"><em>T</em><sub><em>r</em></sub></span> is the measured or “recovery” temperature., The ratio of the actual temperature difference attained to the temperature difference relative to the total temperature is defined to be the “recovery factor” $\alpha_r$:
\begin{equation}
\alpha_{r}=\frac{T_{r}-T_{a}}{T_{t}-T_{a}}
(\#eq:alphar)
\end{equation}
where $T_a$ is the ambient air temperature. From conservation of energy:  
\begin{equation}
\frac{U_{a}^{2}}{2}+c_{p}^{\prime}T_{a}=\frac{U_{r}^{2}}{2}+c_{p}^{\prime}T_{r}=\frac{U_{t}^{2}}{2}+c_{p}^{\prime}T_{t}
(\#eq:Ua)
\end{equation}
where primes on quantities like <span class="math inline"><em>c</em><sub><em>p</em></sub><sup>′</sup></span>, or (below) <span class="math inline"><em>c</em><sub><em>v</em></sub><sup>′</sup></span> and <span class="math inline"><em>R</em><sup>′</sup></span> denote properties of moist air, respectively the specific heat at constant pressure, specific heat at constant volume, and gas constant.<br />  
<p class=box>
**Moist-Air Considerations**  <br><br>
Primes on the symbols denote that these values should be moist-air
values, appropriately weighted averages of the dry-air and water-vapor
contributions. The practice prior to 2014 was to use the dry-air values
for specific heats and the gas constant, except as described in connection
with TASHC below. Since 2014, calculations use the appropriate values
for moist air, except that to avoid errors introduced by unrealistically
high measurements of humidity the humidity correction was limited
to be less than or equal to the equilibrium value at the measured
temperature. The formulas used for the specific heats and gas constant
of moist air in terms of the water vapor pressure $e$, the specific
heats for dry air ($c_{pd}=\frac{7}{2}R_{0},\,c_{vd}=\frac{5}{2}R_{0}$)
and water vapor ($c_{pw}=4R_{0},\,c_{vw}=3R_{0}$), and the ratio
of molecular weights ($\epsilon=M_{W}/M_{d}$) are those of Khelif
et al.\ 1999:  
\begin{equation}
R^{\prime}=R_{d}/[1+(\epsilon-1)\frac{e}{p}]
\end{equation}
\begin{equation}
c_{v}^{\prime} = \frac{(p-e)R^{\prime}}{pR_{d}}\frac{5R_{0}}{2M_{d}}+\frac{eR^{\prime}}{pR_{w}}\frac{3R_{0}}{M_{w}}=c_{vd}\frac{R^{\prime}}{R_{d}}\left(1+\frac{1}{5}\frac{e}{p}\right)
(\#eq:cvMoist)
\end{equation}
\begin{equation}
c_{p}^{\prime} = c_{pd}\frac{R^{\prime}}{R_{d}}\left(1+\frac{1}{7}\frac{e}{p}\right)
(\#eq:cpMoist)
\end{equation}
\begin{equation}
\gamma\,^{\prime} = \gamma_{d}\frac{1+\frac{1}{7}\frac{e}{p}}{1+\frac{1}{5}\frac{e}{p}}
(\#eq:gammaMoist)
\end{equation}  
See also the discussion of TASHC in section XX
and the reference there for Khelif et al.\ 1999.  
</p>  
In \@ref(eq:Ua) <span class="math inline">{<em>U</em><sub><em>a</em></sub>, <em>U</em><sub><em>r</em></sub>, <em>U</em><sub><em>t</em></sub>}</span> are respectively the aircraft true airspeed, the airspeed relative to the aircraft of the air in thermal contact with the sensor, and the airspeed of air relative to the aircraft when fully brought to the motion of the sensor (i.e., zero). Then, from \@ref(eq:Ua)  \begin{equation}
T_{a}=T_{r}-\alpha_{r}\frac{U_{a}^{2}}{2c_{p}^{\prime}}
(\#eq:Tair)
\end{equation}  
<br /> The temperature sensors used on RAF aircraft are designed to decelerate the air adiabatically to near zero velocity. Recovery factors determined from wind tunnel testing for the Rosemount sensors are approximately 0.97 (unheated model) and 0.98 (heated models).^[The recovery factor determined for the now-obsolete NCAR reverse-flow sensor was 0.6. The recovery factor for the now retired NCAR fast-response (K-probe) temperature sensor was 0.8.]
These values have also been confirmed from flight maneuvers, often from “speed runs” where the aircraft is flown level through its speed range and the variation of recovery temperature with airspeed is used with \@ref(eq:Tair), with the assumption that <span class="math inline"><em>T</em><sub><em>a</em></sub></span> remains constant, to determine the recovery factor. Data files and project reports normally document what recovery factor was used for calculating the true airspeed and ambient temperature for a particular project.<br />
<br />
Because the values used in processing have varied, the project reports should be consulted to find what was used for particular projects. The Goodrich Technical Report 5755<span id="punch:4-4" label="punch:4-4">[punch:4-4]</span> documents wind-tunnel testing of the probes formerly made by Rosemount. Their plot showed that, for heated sensors, there is a significant variation with Mach number (<span class="math inline"><em>M</em></span>); cf their Eq.\ (38). The dependence in their plot is represented well by the following equations, where $\alpha_r^{[h]}$ refers to heated probes and $\alpha_r^{[u]}$ to unheated probes:  
\begin{equation}
\alpha_r^{[h]} = 0.988+0.053(\log_{10}M)+0.090(\log_{10}M)^2+0.091(\log_{10}M)^3
(\#eq:alphah)
\end{equation}
\begin{equation}
\alpha_r^{[u]}=0.9959+0.0283(\log_{10}M)+0.0374(\log_{10}M)^2+0.0762(\log_{10}M)^3
(\#eq:alphau)
\end{equation}  
Some studies of the recovery factor are discussed further in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/RecoveryFactorStudy.pdf">this memo</a>.<br />
<br />
The true airspeed $U_a$ is used in \@ref(eq:Tair) to calculate the ambient temperature $T_a$. However, the ambient temperature is also needed to calculate the true airspeed. Therefore the constraints imposed on ambient temperature and true airspeed by the measurements of recovery temperature, total pressure (the pressure measured by a pitot tube pointed into the airstream and assumed to be that obtained when the incoming air is brought to rest relative to the aircraft), and ambient pressure must be used to solve simultaneously for the two unknowns, temperature and airspeed.<br />
<br />
The relationship is conveniently derived by first calculating the dimensionless Mach number $M$, which is the ratio of the airspeed to the speed of sound $U_{s}=\sqrt{\gamma^{\prime}R^{\prime}T_{a}}$, where $\gamma^\prime$ is the ratio of specific heats of (moist) air, $c_p^\prime /c_v^\prime$ and $R^\prime$ is the gas constant for moist air. The Mach number is a function of air temperature only and can be determined as follows:  

a). Express energy conservation, as in \@ref(eq:Tair), in the form  
\begin{equation}
d\left(\frac{U^{2}}{2}\right)+c_{p}^{\prime}dT=0\,\,\,\,.
(\#eq:econ)
\end{equation}  
where the total derivatives apply along a streamline as $U$ changes from $U_a$ to $U_t=0$ and $T$ changes from $T_a$ to $T_t$.  
b). Use the perfect gas law to replace $dT$ with $\frac{pV}{nR}(\frac{dV}{V}+\frac{dp}{p})$ where $V$ and $p$ are the volume and pressure of a parcel of air. Then use the expression for adiabatic compression in the form $pV^\gamma = \mathrm{constant}$ to replace the derivative $\frac{dV}{V}$ with $-\frac{1}{\gamma}\frac{dp}{p}$, leading to $dT=\frac{R^{\prime}T}{c_{p}^{\prime}}\frac{dp}{p}$ or, after integration, $T(p)=T_{a}\left(\frac{p}{p_{a}}\right)^{R^{\prime}/c_{p}^{\prime}}$. Using this expression for $T$ in the formula for $dT$ and then integrating both total derivatives in \@ref(eq:econ) along the streamline leads to  
\begin{equation}
\frac{U_{a}^{2}}{2}+c_{p}^{\prime}T_{a}=c_{p}^{\prime}T_{a}\left(\frac{p_{t}}{p_{a}}\right)^{\frac{R^{\prime}}{c_{p}^{\prime}}}
(\#eq:Ua2)
\end{equation}  
where $p_t$ is the total pressure (i.e., PSXC+QCXC) and
$p_a$ is the ambient pressure (PSXC).  
c). Use the above definition of the Mach number $M$ ($M=U_a/U_s$) in the form
$U_a^2=\gamma^\prime M^2 R^\prime T_a$ to obtain:  
\begin{equation}
M^{2}=\left(\frac{2c_{v}^{\prime}}{R^{\prime}}\right)\left[\left(\frac{p_{t}}{p_{a}}\right)^{\frac{R^{\prime}}{c_{p}^{\prime}}}-1\right]
(\#eq:M2)
\end{equation}  
which is the same as \@ref(eq:MachEquation). This equation shows that $M$ can be found from measurements of $p_t$ and $p_a$ alone, except for the moist-air corrections.  

d). Use the expression for ambient temperature in terms of recovery temperature and airspeed, \@ref(eq:Tair), to obtain the temperature in terms of the Mach number and the recovery temperature:  
\begin{align}
T_{a} & = T_{r}-\alpha_{r}\frac{U_{a}^{2}}{2c_{p}^{\prime}}=T_{r}-\alpha_{r}\frac{M^{2}\gamma^{\prime}R^{\prime}T_{a}}{2c_{p}^{\prime}}\notag\\  
& = \frac{T_{r}}{1+\dfrac{\alpha_{r}M^{2}R^{\prime}}{2c_{v}^{\prime}}}  
(\#eq:TaEQ)
\end{align}
<br /><br />  
e). Express the true airspeed $U_a$ as  
\begin{equation}
U_{a}=M\sqrt{\gamma\,^{\prime}R^{\prime}T_{a}}
(\#eq:UaFinal)
\end{equation}  

Then the temperature is found as described in the following box:^[A problem sometimes arises from use of the measured humidity, because that measurement might be obviously in error. For example, following descents the dew point determined from chilled-mirror hygrometers sometimes overshoots the correct value significantly, producing dew-point measurements well above the measured temperature. If such measurements are used, the result can produce a significant error in derived variables based on the humidity-corrected gas constant and specific heats. If the measurements are flagged as bad, there will be gaps in derived variables. To avoid these two errors, the corrections applied to the gas constant and specific heats are treated as follows: (i) The humidity correction is limited to not more than that given by the water-equilibrium humidity at the temperature ATXD, calculated using dry-air specific heats and gas constant. (ii) If the humidity from the primary sensor is flagged as a missing measurement (e.g., from a dew-point sensor), a secondary measurement is used (e.g., the VCSEL) in cases when the secondary sensor is almost always present in an experiment. (iii) As a backup, the variables TASxD and ATxD are always calculated omitting the humidity correction to the gas constant and the specific heats. These variables usually provide continuous measurements, although they will be offset from the humidity-corrected values. The offset indicates the magnitude of the correction when both are present, and one of the variables TASxD (ATxD) may be selected as TASX (ATX) in cases where missing values might cause a problem for derived variables.]
<br />
</p>  
<p class=box>
RTX\index{RTX} = recovery temperature ($T_{r})$  
QCxC\index{QCxC} = dynamic pressure, corrected ($q_{a}$)  
PSXC\index{PSXC} = ambient pressure, after airflow/location correction
($p_{a}$)  
MACHx\index{MACHx}\sindex[var]{MACH = Mach number} = Mach number
based on QCxC and PSXC; cf.\ \@ref(eq:M2)  
MACHX = best Mach number, based on QCXC and PSXC  
$\alpha_{r}$ = recovery factor for the particular temperature sensor  
$R^{\prime}$, $c_{v}^{\prime}$ and $c_{p}^{\prime}$ as defined
above and in the list of symbols  
</p><p class=box2>
From \@ref(eq:M2),
\begin{equation}
\mathrm{MACHx}=\left\{ \left(\frac{2c_{v}^{\prime}}{R^{\prime}}\right)\left[\left(\frac{\mathrm{\{PSXC\}+\{QCxC\}}}{\mathrm{\{PSXC\}}}\right)^{\frac{R^{\prime}}{c_{p}^{\prime}}}-1\right]\right\} ^{1/2}  
(\#eq:MachBox)
\end{equation}  
From \@ref(eq:TaEQ),
\begin{equation}
\mathrm{ATx}=\frac{\mathrm{\left(\{RTx\}+T_{0}\right)}}{\left(1+\dfrac{\alpha_{r}\mathrm{(\{MACHX\})}^{2}R^{\prime}}{2c_{v}^{\prime}}\right)}-T_{0}
(\#eq:ATbox)
\end{equation}  
</p>

#### In-cloud Air Temperature, Radiometric (<span class="math inline"><em></em><sup>∘</sup></span>C): AT_ITR {-#AT-ITR}

<em>The radiometric ambient air temperature measured by the In-cloud Air Temperature Radiometer,</em> which measures the radiometric temperature in the 4.3 <span class="math inline"><em>μ</em></span>m CO<span class="math inline"><em></em><sub>2</sub></span> band.<span id="AT_ITR" label="AT_ITR">[AT_ITR]</span> Its primary use is in water cloud when the standard thermometers are affected by wetting. In clear air the temperature is an average over an integrating range of up to 100s of meters away from the aircraft, whereas in clouds the integrating range is as little as 10 meters because of water droplets. The calibration is by a polynomial fit of the internal reference temperature and measured radiance to the ATX temperature.<span id="punch:4-5" label="punch:4-5">[punch:4-5]</span></p>

#### Ophir Air Temperature (<span class="math inline"><em></em><sup>∘</sup></span>C): OAT {-#OAT}

<em>The radiometric temperature reported by the Ophir III radiometer,</em> which operates on the same principles as the ITR,<span id="OAT" label="OAT">[OAT]</span> with the same limitations. For more information on this instrument, see this <a href="http://opensky.library.ucar.edu/collections/TECH-NOTE-000-000-000-822">Technical Note</a>. The in-cloud air temperature radiometer is a later, improved version, but the Ophir III radiometer remains in use.</p>
<!-- <h2 id="humidity">Humidity</h2> -->

## Humidity {#humidity}

#### Dew/Frost Point (<span class="math inline">º</span>C): DPx, DP_x, MIRRTMP_DPx {-#dew-point}

<em>The mirror temperature measured directly by a dew-point sensor, without correction.</em> The dew point or frost point is measured by either an EG&amp;G Model 137, a General Eastern Model 1011B or a Buck Model 1011C dew-point hygrometer. Below 0<strong><span class="math inline"><em></em><sup>∘</sup></span>C</strong> the instrument is assumed to be responding to the frost point, although occasionally in climbs there is a short transition near the freezing level before the condensate on the mirror of the instrument freezes and there may be a measurement error before the condensate freezes. The measurements are usually made within a housing where the pressure (<span class="math inline"><em>p</em><sub><em>h</em></sub>)</span> may differ from the ambient pressure, so the pressure in the housing affects the measured dew point or frost point. The housing pressure is often adjusted to be near the ambient pressure by appropriate orientation of inlets, and recently the pressure in the housing is measured and a correction is applied, as discussed in the next paragraph.</p>

#### Corrected Dew Point (<span class="math inline">º</span>C): DPXC, DPxC^[See also DP_VXL and DP_CR2C below.] {-#dewpt-corrected}

<em>The dew point obtained from the original measurement after correction for the housing pressure, the enhancement of the equilibrium vapor pressure arising from the total pressure (discussed below), and conversion from frost point if appropriate,</em> The result is the temperature at which the equilibrium vapor pressure over a plane water surface in the absence of other gases would match the actual water-vapor pressure. Dew/frost-point hygrometers measure the equilibrium point in the presence of air, and the presence of air affects the measurement in a minor way that is represented by a small correction here named the “enhancement factor.” In the case where the dew-point or frost-point sensor is exposed to ambient air directly, the enhancement factor is defined so that the ambient water vapor pressure $e_a$ is related to $T_p$, the *measured* dew or frost point *in the presence of air* having total pressure $p$, by $e_a=f(p,T_P)e_s(T_p)$ where $e_s(T_p)$ is the vapor pressure in equilibrium with ice or water at the dew or frost point $T_p$ *in the absence of air.* Calculation of DPxC removes this dependence, so the vapor pressure obtained from $e_s(\{DPxC\})$ will be that vapor pressure corresponding to equilibrium *in the absence of air.* In addition, if the measurement is below $0^\circ\mathrm{C}$, it is assumed to be a measurement of frost point and a corresponding dew point is calculated from the measurement (also with correction for the influence of the total pressure on the measurement). Some changes were made to these calculations in 2011; for more information, see <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/VaporPressureV3.pdf">this memo</a>.<br />
<br />
An additional correction is needed in those cases where the pressure in the housing of the instrument (measured as PSDPx or CAVP_x) differs from the ambient pressure, because the changed pressure affects the partial pressure of water vapor in proportion to the change in total pressure and so changes the measured dew point from the desired quantity (that in the ambient air) to that in the housing. This is especially important in the case of the GV because the potential effect increases with airspeed. If the pressure in the housing is measured or otherwise known (e.g., from correlations with other measurements), then this correction can be introduced into the processing algorithm at the same time that the correction for the presence of dry air is introduced, and the enhancement factor should be evaluated at the pressure in the housing.<br />  

The relationship between water-vapor pressure and dew- or frost-point temperature is based on the Murphy and Koop^[Q. J. R. Meteorol. Soc. (2005), 131, pp. 1539–1565]
(2005) equations.^[Prior to 2010, the vapor pressure relationship used was the Goff-Gratch formula as given in the Smithsonian Tables (List, 1980).]
They express the equilibrium vapor pressure as a function of frost point or dew point *and at a total air pressure $p$* via equations that are equivalent to the following:  
\begin{equation}
e_{s,i}(T_{FP})= b_{0}^{\prime}\exp(b_{1}\frac{(T_{0}-T_{FP})}{T_{0}T_{FP}}+b_{2}\ln(\frac{T_{FP}}{T_{0}})+b_{3}(T_{FP}-T_{0}))
(\#eq:MKi)
\end{equation}
\begin{equation}
e_{s,w}(T_{DP})=c_{0}\exp\left((\alpha-1)c_{6}+d_{2}(\frac{T_{0}-T_{DP}}{T_{DP}T_{0}})\right)+d_{3}\ln(\frac{T_{DP}}{T_{0}})+d_{4}(T_{DP}-T_{0})
(\#eq:MKw)
\end{equation}
\begin{equation}
f(p, T_P)= 1 + p(f_1 + f_2T_P + f_3T_P^2)
(\#eq:enhance)
\end{equation}
where $e$ is the water vapor pressure, $T_{FP}$ or $T_{DP}$ is the frost or dew point, respectively, expressed in kelvin, $T_0$ = 273.15 K, $e_{s,i}(T_{FP})$ is the equilibrium vapor pressure over a plane ice surface at the temperature $T_{FP}$, $e_{s,w}(T_{DP})$ is the equilibrium vapor pressure over a plane water surface at the temperature $T_{DP}$ (above or below $T_0$), and $f(p,T_P)$ is the enhancement factor at total air pressure $p$ and temperature $T_P$, with $T_P$ equal to $T_{DP}−T_0$ when above $T_0$ and $T_{FP}−T_0$ when below $0^\circ$C.  
<br />
The coefficients used in the above formulas are given in the following tables, with the additional definitions that $\alpha_T=\tanh(c_5(T-T_x))$, $T_X=218.8$\ K, and $d_i=c_i+\alpha_Tc_{i+5}$ for i = {2,3,4}:

<p><center>
```{r MKcoef2, echo = FALSE}
MKC <- data.frame(coefficient=c('$b_0^\\prime$', '$b_1$', '$b_2$', '$b_3$',
                                '$f_1$', '$f_2$', '$f_3$'))
MKC$value <- c('$6.11536$\ hPa', '$-5723.265$\ K', '$3.53068$',
               '$-0.00728332$\ K$^{-1}$', '$4.923\\times 10^{-5}$ hPa$^{-1}$',
               '$-3.25\\times 10^{-7}$hPa$^{-1}$K$^{-1}$', 
               '$5.84\\times 10^{-10}$hPa$^{-1}$K$^{-2}$')
MKC2 <- data.frame(coefficient = c('$c_0$', '$c_1$','$c_2$','$c_3$','$c_4$',
                                   '$c_5$','$c_6$','$c_7$','$c_8$','$c_9$'))
MKC2$value <- c('$6.091886$ hPa', '$6.564725$', '$-6763.22$\ K',
                '$-4.210$', '$0.000367$\ K$^{-1}$', '$0.0415$\ K$^{-1}$',
                '$-0.1525967$', '$-1331.22$\ K', '$-9.44523$',
                '$0.014025$\ K$^{-1}$')
knitr::kables(list(
knitr::kable(MKC, align=c('cc'), valign = 'c') %>% 
  kable_styling(bootstrap_options = 'bordered', position = 'float_left',
                full_width = FALSE),
knitr::kable(MKC2, align=c('cc'), valign = 'c') %>% 
  kable_styling(bootstrap_options = 'bordered', position = 'float_right',
                full_width = FALSE)
))
# scroll_box(list(T1, T2), width='90%')
```
</center></p>
The vapor pressure in the instrument housing, $e_h$, is related to the sensed dew or frost point according to equation \@ref(eq:MKw) or \@ref(eq:MKi),  but further corrections must also be made for the enhancement factor and to account for possible difference between the pressure in the sensor housing ($p_h$) and the ambient pressure ($p_a$):  
\begin{equation}
e_{a}=f(p_{a},T_{p})e_{h}\frac{p_{a}}{p_{h}}
(\#eq:housingCorr)
\end{equation}
<span id="punch:4.6" label="punch:4.6">[punch:4.6]</span>
Because processing to obtain the corrected dew point DPxC from the ambient vapor pressure $e_a$  would require difficult inversion of the above formulas, interpolation is used instead. A table constructed from \@ref(eq:MKw) and another constructed from \@ref(eq:MKi), giving water vapor pressure as a function of frost point or dew point temperature in $1^\circ\mathrm{C}$ increments from $-100$ to $+50^\circ\mathrm{C}$, is then used with three-point Lagrange interpolation (via a function described below as $F_D(e)$) to find the dew point temperature from the vapor pressure.^[prior to 2011 the conversion was made using the formula <span class="math inline"><em>D</em><em>P</em><em>x</em><em>C</em> = 0.009109 + <em>D</em><em>P</em><em>x</em>(1.134055 + 0.001038<em>D</em><em>P</em><em>x</em>)</span>. For instruments producing measurements of vapor density (RHO), the previous Bulletin 9 section incorrectly gave the conversion formula as <span class="math inline"><em>D</em><em>P</em><em>x</em><em>C</em> = 273.0<em>Z</em>/(22.51 − <em>Z</em>)</span>, a conversion that would apply to frost point, not dew point. However, the code in use shows that the conversion was instead <span class="math inline">237.3<em>Z</em>/(17.27 − <em>Z</em>)</span>, where Z in both cases is <span class="math inline"><em>Z</em> = ln ((<em>A</em><em>T</em><em>X</em> + 273.15)<em>R</em><em>H</em><em>O</em>/1322.3)</span>.]
</p>
  
Tests of these interpolation formulas against high-accuracy numerical inversion of formulas \@ref(eq:MKw) and \@ref(eq:MKi) showed that the maximum error introduced by the interpolation formula was about $0.004^\circ\mathrm{C}$ and the standard error about $0.001^\circ\mathrm{C}$. This inversion then provides a corrected dew point that incorporates the effects of the enhancement factor as well as differences between the ambient pressure and that in the housing. The algorithm is documented in the box below.  
```{r child='DPbox.Rmd'}
```
For other instruments that measure vapor density, such as a Lyman-alpha or tunable diode laser hygrometers (including the Vertical Cavity Surface Emitting Laser (VCSEL) hygrometer), a similar conversion is made from vapor density to dew point, as described in the next paragraph.<br />  

#### Dew Point Determined from the VCSEL Hygrometer (<span class="math inline"><em></em><sup>∘</sup></span>C): DP_VXL {-#vcsel-dp}

<em>The dew point temperature determined from the measured water vapor density from the VCSEL hygrometer.</em> The calculation is as described at the bottom of the box immediately above this paragraph (above the footnote). The water vapor density converted from a molecular density [molecules$\,$cm$^{-3}$] to a mass density [g$\,$m$^{-3}$] via^[The conversion factor is given by this formula:<br />
<br /><span class="math display">$$C^{\prime}=\frac{10^{6}\mathrm{cm}^{3}}{\mathrm{m}^{3}}\times\frac{M_{W}^{\dagger}}{N_{A}^{\dagger}}$$</span><br /> where <span class="math inline"><em>N</em><sub><em>A</em></sub></span> is the Avogadro constant, 6.022147<span class="math inline"> × 10<sup>26</sup></span> molecules kmol<span class="math inline"><em></em><sup> − 1</sup></span>.]
{CONCV_VXL} * $2.9915\times 10^{17}$
is used for {RHO}. DP_VXL is given by DPxC on the last line of that algorithm box. See CONCV_VXL below.</p>

#### Frost Point Temperature from the CR2 Cryogenic Hygrometer (<span class="math inline"><em></em><sup>∘</sup></span>C): FP_CR2, MIRRORT_CR2 {-#mirror-cr2}

<em>The mirror temperature in the CR2 cryogenic hygrometer,</em> which is normally the frost point inside the measuring chamber of the instrument<em>.</em> <span id="punch:4-7" label="punch:4-7">[punch:4-7]</span>The measurement is often suspect when the value is above about -15<span class="math inline"><em></em><sup>∘</sup></span>C; the measurement is intended for use below this value. The CR2 is a cabin-mounted instrument, so the measured pressure (P_CR2) in the instrument must be used with the ambient pressure (PSXC) to convert the measurement to ambient humidity measures like DP_CR2 and EW_CR2.</p>

#### Corrected Dew Point Temperature from the CR2 Cryogenic Hygrometer (<span class="math inline"><em></em><sup>∘</sup></span>C): DP_CR2C {-#dp-cr2}

<em>The dew point temperature corresponding to equilibrium at the ambient humidity,</em> as determined by the CR2 hygrometer. The measurement of the mirror temperature inside the CR2, FP_CR2, is converted to a vapor pressure assuming equilibrium water vapor pressure relative to a plane ice surface at that temperature, and the resulting vapor pressure is converted to an ambient value via the assumption that the ratio of vapor pressure internal to the instrument to ambient vapor pressure is the same as the corresponding total pressure ratio. The resulting ambient vapor pressure (EW_CR2) is then converted to an equivalent ambient dew point. The steps are the same as those in the algorithm box for DPxC above, with these substitutions: FP_CR2 is used for DPx and P_CR2 for $p_h$.</p>

#### Uncorrected Water Vapor Number Density from the VCSEL Hygrometer (molecules cm<span class="math inline"><em></em><sup> − 3</sup></span>): >RAWCONC_VXL {-#vcsel-uncor}

<em>The uncorrected water vapor number density reported by the VCSEL hygrometer.</em> This is determined by comparing the measured absorption peak height against a reference spectrum generated using the HITRAN spectral parameters, the ambient temperature and the ambient pressure.^[For details see Zondlo, M. A., M. E. Paige, S. M. Massick, and J. A. Silver, 2010: Vertical cavity laser hygrometer for the National Science Foundation Gulfstream-V aircraft. <em>J. Geophys. Res.,</em> <strong>115,</strong> D20309, doi:10.1029/2010JD014445.]
</p>

#### Corrected Water Vapor Concentration from the VCSEL Hygrometer (molecules cm<span class="math inline"><em></em><sup> − 3</sup></span>): CONCV_VXL {-#vcsel-corr}

<em>The corrected water vapor number density produced by the VCSEL hygrometer,</em> after minor corrections for ambient temperature, pressure, laser intensity and water vapor concentration.<span id="punch:4-8" label="punch:4-8">[punch:4-8]</span> For more information on calibration and data processing for this instrument, see the <a href="https://www.eol.ucar.edu/instruments/vertical-cavity-surface-emitting-laser-vcsel-hygrometer">instrument web page</a> and additional documentation there.</p>
#### Voltage Output from the UV Hygrometer (V): XSIGV_UVH {-#uvh-voltage}

<em>The voltage from a modern (as of 2012) version of the Lyman-alpha hygrometer,</em> which provides a signal that represents water vapor density. The instrument also provides measurements of pressure and temperature inside the sensing cavity; they are, respectively, XCELLPRES_UVH and XCELLTEMP_UVH. See the discussion of EW_UVH below for the data-processing algorithm that uses this variable.</p>

#### Water Vapor Number Density from the UV Hygrometer (molecules cm<span class="math inline"><em></em><sup> − 3</sup></span>): CONCH_UVH {-#uvh-n}

<em>Water vapor number density (or concentration of molecules) measured by the UV Hygrometer.</em> This is the direct measurement from the instrument. Its calculation relies on a bench calibration that fits the water vapor number density to the Beers-Lambert absorption law and corrects for output offsets and the effect of UV absorption by atmospheric constituents other than water vapor. See also the discussion of EW_UVH in the paragraph that immediately follows.</p>

#### Water Vapor Pressure (hPa): EWx, EWX, EW_UVH, EW_VXL, EDPC (obsolete) {-#ewx}

<em>The ambient vapor pressure of water,</em> also used in the calculation of several derived variables. It is often obtained from an instrument measuring dew point or water vapor density. In the case where it is derived from a measurement of dew point (DPx), a correction is applied for the enhancement factor that influences dew point or frost point measurements.^[prior to 2011, this variable was calculated using the Goff-Gratch formula. See the discussion of DPXC for more information on previous calculations.]
The formula for obtaining the ambient water vapor pressure as a function of dew point is given in the discussion of DPxC above, Eqs.\ \@ref(eq:MKw) and \@ref(eq:enhance), where the calculation of the variables EWx and EWX are also discussed. EWX (or previously EDPC) is the preferred variable that is selected from among the possibilities {EWx} for subsequent calculation of derived variables.<br />
<br />
For the case where water vapor pressure is determined by the VCSEL hygrometer, EW_VXL is determined from CONCV_VXL: EW_VXL=<span class="math inline"><em>C</em></span><span class="math inline"><em>k</em></span>{CONCV_VXL}{ATX+273.15) where <span class="math inline"><em>k</em></span> is the Boltzmann constant and <span class="math inline"><em>C</em> = 10<sup> − 4</sup></span>(cm/m)<span class="math inline"><em></em><sup>3</sup></span>(hPa/Pa) converts units to hPa.<br />
<br />
In the case where the water vapor pressure is determined from the UV Hygrometer data, this variable is calculated using one of two methods:  

1. Using the ideal gas law to convert the water vapor number density from the UV Hygrometer to water vapor pressure, using XCELLTEMP_UVH and XCELLPRES_UVH, the measured temperature and pressure in the absorption cell, via the equation:  
\begin{equation}
\mathrm{\{EW\_UVH\}=C\,\{CONC\_UVH\}\notag \\
\times\frac{k\,(\mathrm{\{XCELLTEMP\_UVH\}+273.15)\,\mathrm{\{PSX\}}}}{\mathrm{{\{XCELLPRES\_UVH\}}}}}
(\#eq:UVH1)
\end{equation}
</span><br /> or  
2. Through use of a polynomial fit with coefficients fitted to \{EWX\}:  
\begin{equation}
\mathrm{\{EWX\}}=c_0 + c_1(\mathrm{\{XSIGV\_UVH\}}) + c_2(\mathrm{\{XSIGV\_UVH\}}^2)
(\#eq:UVH2)
\end{equation}  
where \{EWX\} is a reference water vapor pressure provided by another instrument. This preserves the fast-response characteristics of the UV hygrometer while linking the absolute values to a baseline provided by a more stable instrument. This can be done on a flight-by-flight basis and largely eliminates drift.^[For more details see Beaton, S. P. and M. Spowart, 2012: UV Absorption Hygrometer for Fast-Response Airborne Water Vapor Measurements. <em>J. Atmos. Oceanic Technol.,</em> <strong><em>29.</em></strong> DOI: 10.1175/JTECH-D-11-00141.1]
See the project reports to determine which method was used for a particular project.</p>  

#### Relative Humidity (per cent or Pa/hPa): RHUM {-#rhumw}

<em>The ratio of the water vapor pressure to the water vapor pressure in equilibrium over a plane</em> liquid<em>-water surface,</em> scaled to express the result in units of per cent or Pa/hPa:<br />  
```{r child='RHUMbox.Rmd'}
```
To follow normal conventions, the change in equilibrium vapor pressure that arises from the enhancement factor is not included in the calculated relative humidity, even though the true relative humidity should include the enhancement factor as specified in \@ref(eq:enhance) in the denominator of \@ref(eq:RHUM).<br />

#### Relative Humidity with respect to Ice (per cent or Pa/hPa): RHUMI {-#rhumi}

<em>The ratio of the water vapor pressure to the water vapor pressure in equilibrium over a plane</em> ice <em>surface,</em> scaled to express the result in units of per cent or Pa/hPa:<br />
```{r child='RHIbox.Rmd'}
```

To follow normal conventions, the change in equilibrium vapor pressure that arises from the enhancement factor is not included in the calculated relative humidity, even though the true relative humidity should include the enhancement factor as specified in \@ref(eq:enhance) in the denominator of \@ref(eq:RHUMI).<br />

#### Absolute Humidity, Water Vapor Density (g/m<span class="math inline"><em></em><sup>3</sup></span>):RHOx {-#rho}

<em>The water vapor density computed from various measurements of humidity as indicated by the ’x’ suffix,</em> and conventionally expressed in units of g kg<span class="math inline"><em></em><sup> − 1</sup></span> or per mille. The calculation proceeds in different ways for different sensors. For sensors that measure a chilled-mirror temperature, the calculation is based on the equation of state for a perfect gas and uses the water vapor pressure determined by the instrument, as in the following box:<span id="punch:4-9" label="punch:4-9">[punch:4-9]</span><br />
```{r child='RHObox.Rmd'}
```
For instruments measuring the vapor pressure density (including the Lyman-alpha probes and the newer version called the UV hygrometer), the basic measurement from the instrument is the water vapor density, <strong><span class="underline">RHOUV</span></strong> or <strong></strong> <strong><span class="underline">RHOLA</span></strong>, determined by applying calibration coefficients to the measured signals (XUVI or VLA). In addition, a slow update to a dew-point measurement is used to compensate for drift in the calibration. The algorithm for the UV Hygrometer is as described in the following box; the processing used for early projects with the Lyman-alpha instruments is similar but more involved and won’t be documented here because the instruments are obsolete. See <a href="https://opensky.ucar.edu/islandora/object/archives%3A8729">RAF Bulletin 9</a> for the processing previously used for archived measurements from the Lyman-alpha hygrometers.<br />  
<p class=box>  
This algorithm for RHOUV is missing.
</p><p class=box2><p>

#### Specific Humidity (g/kg): SPHUM {-#sphum}

<em>The mass of water vapor per unit mass of (moist) air, conventionally measured in units of g/kg or per mille.</em><br />
```{r child='SPHUMbox.Rmd'}
```

#### Mixing Ratio (g/kg): MR, MRCR, MRLA, MRLA1, MRLH, MRVXL  {-#MR}

<em>The ratio of the mass of water to the mass of dry air in the same volume of air,</em> conventionally expressed in units of g/kg or per mille. Mixing ratios may be calculated for the various instruments measuring humidity on the aircraft, and the variable names reflect the source: MR from the dewpoint hygrometers, MRCR from the cryogenic hygrometer, MRLA from the Lyman-alpha sensor, MRLA1 if there is a second Lyman-alpha sensor, MRLH from a tunable-diode laser hygrometer, and MRVXL from the VCSEL hygrometer (also a laser hygrometer). The example in the box below is for the case of the dewpoint hygrometers; others are analogous.<br /></p>
```{r child='MRbox.Rmd'}
```
<!-- <h2 id="derived-thermodynamic-variables">Derived Thermodynamic Variables</h2> -->
  
## Derived Thermodynamic Variables

#### Potential Temperature (K): THETA {-#theta}

<em>The absolute temperature reached if a dry parcel at the measured pressure and temperature were to be compressed or expanded adiabatically to a pressure of 1000 hPa</em>. It does not take into account the difference in specific heats caused by the presence of water vapor, and water vapor can change the exponent in the formula below enough to produce errors of 1 K or more.<br />
```{r child='THETAbox.Rmd'}
```

#### Pseudo-Adiabatic Equivalent Potential Temperature (K): THETAP, THETAE {-#thetae}

<em>The absolute temperature reached if a parcel of air were to be expanded pseudo-adiabatically (i.e., with immediate removal of all condensate) to a level where no water vapor remains, after which the dry parcel would be compressed to 1000 hPa.</em> Beginning in 2011, pseudo-adiabatic equivalent potential temperature is calculated using the method developed by Davies-Jones (2009).^[Davies-Jones, R., 2009: On formulas for equivalent potential temperature. <em>Mon. Wea. Review,</em> <strong>137,</strong> 3137–3148.]
This is discussed in the memo available at <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/ThetaE.pdf">this link</a>. The following summarizes that study. The Davies-Jones formula is:  
\begin{equation}
\Theta_{P}=\Theta_{DL}\exp\{\frac{r(L_{0}^{*}-L_{1}^{*}(T_{L}-T_{0})+K_{2}r)}{c_{pd}T_{L}}\}
(\#eq:THETAP)
\end{equation}  
\begin{equation}
\Theta_{DL}=T_{K}(\frac{p_{0}}{p_{d}})^{0.2854}\,(\frac{T_{k}}{T_{L}})^{0.28\times10^{-3}r}
(\#eq:THETADL)
\end{equation}  
where $T_K$ is the absolute temperature (in kelvin) at the measurement level, $p_d$ is the partial pressure of dry air at that level, $p_0$ is the reference pressure (conventionally 1000 hPa), $r$ is the (dimensionless) water vapor mixing ratio, $c_p$ the specific heat of dry air, $T_L$ the temperature at the lifted condensation level (in kelvin), and $T_0=273.15\,\mathrm{K}$. The coefficients in this formula are $L_0^* = 2.56313\times 10^6\mathrm{J\,kg^{-1}}$,
$L_1^* = 1754\,\mathrm{J\,kg^{-1}K^{-1}}$, and $K_2 = 1.137\times 10^6\mathrm{J\,kg^{-1}}$. The asterisks on $L_0^*$ and $L_1^*$ indicate that these coefficients depart from the best estimate of the coefficients that give the latent heat of vaporization of water, but they have been adjusted to optimize the fit to values obtained by exact integration. Note that, unlike the formula discussed below that was used prior to 2011, the mixing ratio must be used in dimensionless form (i.e., kg/kg), <em>not</em> with units of g/kg. The following empirical formula, developed by Bolton (1980),^[Bolton, D., 1980: The computation of equivalent potential temperature. <em>Mon. Wea. Rev.,</em> <strong>108,</strong> 1046–1053.]
is used to calculate $T_L$:  
\begin{equation}
T_{L}=\frac{\beta_{1}}{3.5\ln(T_{K}/\beta_{3})-\ln(\mathrm{e/\beta_{4}})+\beta_{5}}+\beta_{2}
(\#eq:TLCL)
\end{equation}  
where $e$ is the water vapor pressure, $\beta_1 = 2840\,\mathrm{K}$, $\beta_2 = 55\,\mathrm{K}$, $\beta_3 = 1\,\mathrm{K}$, $\beta_4 = 1\,\mathrm{hPa}$, and $\beta_5 = -4.805$. ($\beta_3$ and $\beta_4$ have been introduced into \@ref(eq:TLCL) only to ensure that arguments to logarithms are dimensionless and to specify the units that must be used to achieve that.)<br />
```{r child='THETAPbox.Rmd'}
```

Prior to 2011, the variable called the equivalent potential temperature^[The AMS glossary defines equivalent potential temperature as applying to the adiabatic process, not the pseudo-adiabatic process; the name of this variable has therefore been changed.]
and named THETAE in the output data files was that obtained using the method of Bolton (1980), which used the same formula to obtain the temperature at the lifted condensation level ($T_L$) and then used that temperature to find the value of potential temperature of dry air that would result if the parcel were lifted from that point until all water vapor condensed and was removed from the air parcel. The formulas used were as follows:<br />
```{r child='THETAEbox.Rmd'}
```
  
Differences vs the new formula are usually minor but can be as much as 0.5 K.<strong></strong><br />

#### Virtual Temperature (<span class="math inline">º</span>C): TVIR {-#TVIR}

<em>The temperature of dry air having the same pressure and density as the air being sampled.</em> The virtual temperature thus adjusts for the buoyancy added by water vapor.<br />
```{r child='TVIRbox.Rmd'}
```

### Virtual Potential Temperature (K): THETAV {-#thetav}

<em>A potential temperature analogous to the conventional potential temperature except that it is based on virtual temperature instead of ambient temperature.</em> Dry-adiabatic expansion or compression to the reference level (1000 hPa) is assumed. As for THETA, use of dry-air values for the gas constant and specific heat at constant pressure can lead to significant errors in humid conditions. For further information, see <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/VirtualTemperature.pdf">this note</a>.<br />
<a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/VirtualTemperature.pdf">this note</a><br />
```{r child='THETAVbox.Rmd'}
```
#### Wet-Equivalent Potential Temperature (K): THETAQ {-#thetaq}

<em>The absolute temperature reached if a parcel of air were to be expanded adiabatically (i.e., retaining the condensed water in the liquid phase and accounting for the specific heat of that condensate) to a level where no water vapor remains, after which the condensate would be removed and the resulting dry parcel compressed to 1000 hPa.</em> This variable was not included in data archives prior to 2012. Emanuel (1994) gives the following formula (his Eq. 4.5.11):  
\begin{equation}
\Theta_{q}=T(\frac{p_{0}}{p_{d}})^{\frac{R_{d}}{c_{pt}}}\exp\left\{ \frac{L_{v}r}{c_{pt}T}\right\} \left(\frac{e}{e_{s,w}(T)}\right)^{-rR_{w}/c_{pt}}
(\#eq:THETAQ)
\end{equation}  
where $\Theta_q$ is the wet-equivalent potential temperature, $L_v$ the latent heat of vaporization, $r$ the (dimensionless) water-vapor mixing ratio, $c_{pt} = c_{pd}+r_tc_w$ with $r_t$  the total-water mixing ratio including vapor and condensate, $c_w$ the specific heat of liquid water, and other symbols are as used previously. See <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/ThetaE.pdf">this memo</a> for additional discussion of this variable, for values to use for the latent heat and specific heat, and in particular for analysis indicating that $\Theta_Q$ evaluated with this formula can be expected to vary from the true adiabatic value by a few tenths kelvin (in a worst case, by about 1 K) because of variation in (and uncertainty in) the specific heat of supercooled water at low temperature. The details of the calculation are described in the following box. Note that this algorithm only uses the liquid water content as measured by a King probe, PLWCC; other similar calculations could be based on other measures of liquid water such as that from a cloud-droplet spectrometer.  
</p>
```{r child='THETAQbox.Rmd'}
```

<!-- <h2 id="windsecwind">Wind<span id="sec:WIND" label="sec:WIND">[sec:WIND]</span></h2> -->

## Wind {#wind}

<p><a href="https://opensky.ucar.edu/islandora/object/archives%3A8152">RAF Bulletin 23</a> documents the calculation of wind components, both with respect to the earth (UI, VI, WI, WS and WD) and with respect to the aircraft (UX and VY). In data processing, a separate function (GUSTO in GENPRO, gust.c in NIMBUS) is used to derive these wind components. That function uses the measurements from an Inertial Navigation System (INS) as well as aircraft true airspeed, aircraft angle of attack, and aircraft sideslip angle. The wind components calculated in GUSTO/gust.c are used to derive the wind direction (WD) and wind speed (WS). Additional variables UIC, VIC, WSC, WDC, UXC, and VYC are also calculated based on the variables VNSC, VEWC discussed in Section \@ref(combining-irs-and-gps-measurements), which combine INS and GPS information to obtain improved measurements of the aircraft motion. Those are usually the highest-quality measurements of wind because the merged INS/GPS variables combine the high-frequency response of the INS with the long-term accuracy of the GPS.</p>
<p>There is an extensive discussion of the wind-sensing system and the uncertainties associated with measurements of wind in this <a href="http://dx.doi.org/10.5065/D60G3HJ8">Technical Note</a>. The details contained therein and in Bulletin 23 will not be repeated here, so those documents should be consulted for additional information. There are two exceptions that are discussed in more detail here:</p>
<ol class="incremental">
<li><p>The calculation of vertical wind is described in more detail below for the variables WI and WIC.</p></li>
<li><p>Because measurements obtained by a GPS receiver are often used, the motion of the GPS receiving antenna relative to the IRU must be considered. Standard processing corrects for the motion of the gust system relative to the IRU arising from aircraft rotation, but a similar correction is needed because the GPS antenna is displaced from the IRU. The displacement is almost entirely along the longitudinal axis of the aircraft, so GPS-measured velocities like GGVNS, GGVEW, and GGVSPD (denoted here $v_n$, $v_e$, $v_u$) need correction as follows to give measurements that apply at the location of the IRU. Then these variables can be used in place of or to complement similar measurements from the IRU in the processing algorithms. The equations are:  
\begin{align}\begin{split}
\delta v_{u} = & -L_{G}\dot{\theta}\notag \\
\delta v_{e} = & -L_{G}\dot{\psi}\,{\cos\psi}\notag \\
\delta v_{n} = &  L_{G}\dot{\psi}\,{\sin\psi}
\end{split}
(\#eq:deltav)
\end{align}  
where $\theta$ and $\psi$ respectively are the pitch and heading angles and $L_G$ is the distance forward along the longitudinal axis from the IRU to the GPS antenna ($−4.30$ m for the GV and $-9.88$ m for the C-130 during and after 2015).  The negative signs indicate that the GPS antennas are behind the IRUs. The dots over the attitude-angle symbols represent time derivatives, so for example $\dot{\theta}$ is the rate of change of the pitch angle. All angles are expressed in radians. The correction terms should be added to the GPS-measured velocity components so that they represent the motion of the IRU relative to the Earth. This is done for the vertical wind, beginning in 2017, but for horizontal wind the complementary filter (discussed below) removes high-frequency fluctuations from the GPS-derived measurements so incorporation of these changes would have negligible effect. For more information, see <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107.pdf">this note</a>.</p></li>
</ol>
<p>The variables pertaining to the relative wind are described in the next subsection, and the variables characterizing the wind are then described briefly in the last subsection. Some additional detail is included in cases where procedures are not documented in that earlier bulletin.</p>
<!-- <h3 id="relative-wind">Relative Wind</h3> -->

### Relative Wind

<p>Wind is measured by adding two vectors, the measured air motion relative to the aircraft (called the relative wind) and the motion of the aircraft relative to the Earth. The following are the measurements used to determine the relative wind. The motion of the aircraft relative to the ground was discussed in Section \@ref(inertial-reference-systems), and the combination of these two vectors to measure the wind is described in <a href="https://opensky.ucar.edu/islandora/object/archives%3A8152">RAF Bulletin 23</a>.</p>
<p>RAF uses the radome<span id="radome gust-sensing system" label="radome gust-sensing system"></span> gust-sensing technique^[Brown, E. N, C. A. Friehe, and D. H. Lenschow, 1983: <em>Journal of Climate and Applied Meteorology,</em> <strong>22,</strong> 171–180]
to measure incidence angles of the relative wind (i.e., angles of attack and sideslip). The pressure difference between sensing ports above and below the center line of the radome is used, along with the dynamic pressure measured at a pitot tube and referenced to the static pressure source, to determine the angle of attack. The sideslip angle is determined similarly using the pressure ports on the starboard and port sides of the radome. A Rosemount Model 858AJ gust probe has occasionally been used for specialized measurements. The radome measurements are made by differential pressure sensors located in the nose area of the aircraft and connected to the radome by semi-rigid tubing.</p>

#### Mach Number (dimensionless): MACHx, MACHX {-#mach-number}

<em>The Mach Number that characterizes the flight speed.</em> The Mach number is defined as the ratio of the flight speed (or the magnitude of the relative wind) to the speed of sound.
See Eq.\ \@ref(eq:M2) for the equation used. Many relatively old archived data files have instead a variable XMACH2, which is the square of MACHx.</p>

#### Aircraft True Airspeed (m/s): TASx, TASxD, TASX {-#true-airspeed}

<em>The flight speed of the aircraft relative to the atmosphere.</em> This derived measurement of the flight speed of the aircraft relative to the atmosphere is based on the Mach number calculated from both the dynamic pressure at location x and the static pressure. See the derivation for ATx . The different variables for TASx (TASF, TASR, etc) use different measurements of QCxC in the calculation of Mach number. The variable TASxD is the result of calculations for which the Mach number, air temperature, and true airspeed are determined for dry instead of humid air. See the discussion of [ATX](#ATX) for an explanation of how humidity is handled in the calculation of true airspeed.<br />
```{r child='TASbox.Rmd'}
```

#### Aircraft True Airspeed (Humidity Corrected) (m/s): TASHC {-#tashc}

This derived measurement of true airspeed accounted for deviations of specific heats of moist air from those of dry air. See List, 1971, pp 295, 331-339, and Khelif, et al., 1999. This variable is no longer used because the standard
calculation of TASX (documented in the preceding paragraph) now uses moist-air
values of the specific heats and gas constant. The equation previously used for this variable, given by Khelif et al. 1999,^[Khelif, D., S.P. Burns, and C.A. Friehe, 1999: Improved wind measurements on research aircraft. <em>Journal of Atmospheric and Oceanic Technology,</em> <strong>16,</strong> 860–875.]
added a moisture correction to the true airspeed derived for dry air, as follows:<br />
```{r child='TASHCbox.Rmd'}
```

#### Attack Angle Differential Pressure (mb): ADIFR {-#adifr}

<em>The pressure difference between the top and bottom pressure ports of a radome gust-sensing system.</em> This measurement is used to determine the angle of attack; see AKRD below. <strong></strong> Obsolete variable <span class="underline">ADIF</span> is a similar variable used for old gust-boom systems or for Rosemount Model 858AJ flow-angle sensors.</p>

#### Sideslip Angle Differential Pressure (mb): BDIFR {-#bdifr}

<em>The pressure difference between starboard and port pressure inlets of a radome gust-sensing system.</em> This measurement is used to determine the sideslip angle; see SSRD below. Obsolete variable <span class="underline">BDIF</span> is a similar variable used for old gust-boom systems or for Rosemount Model 858AJ flow-angle sensors.</p>

### Attack Angle, Radome (<span class="math inline">º</span>): AKRD {-#akrd}

<em>The angle of attack of the aircraft.</em> This derived measurement represents the angle between the longitudinal axis of the aircraft and the component of the relative wind vector in the plane of port-starboard symmetry of the aircraft. The tangent of the angle of attack is the ratio of the vertical to longitudinal component of the relative wind. Positive values indicate flow moving upward (in the aircraft reference frame) relative to the longitudinal axis. The calculation is based on ADIFR and a measurement of dynamic pressure, and so is the measurement produced by a radome gust-sensing system. Empirical sensitivity coefficients for each aircraft, determined from special flight maneuvers, are used; see <a href="https://opensky.ucar.edu/islandora/object/archives%3A8152">RAF Bulletin 23</a> and this <a href="http://dx.doi.org/10.5065/D60G3HJ8">Technical Note</a> for more information. The sensitivity coefficients listed below have changed when the radomes were changed or refurbished, so the project documentation should be consulted for the values used in a particular project. For more information on the latest C-130 calibration, see <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/ARISTO-LAMS.pdf">this note</a>.<br />
Prior to 2017, the procedure was based on the following algorithm:<br />
```{r child='AKRDbox.Rmd'}
```
<br />
See also <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/AKRDC130.pdf">this memo</a>.<br />
<br />
Beginning in 2017, a different strategy was used, as documented in more detail in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161121.pdf">this memo</a>. Two variables were used to represent the angle of attack, $A$={ADIFR}/{QCF} and $q$={QCF}. However, each was filtered into complementary low-pass and high-pass components, with the cutoff frequency at (1/600) Hz, and the separate components were used to represent the separate components of angle of attack according to the following formula:<br />
```{r child='newAKRDbox.Rmd'}
```
<strong></strong></p>

#### Reference Attack Angle (<span class="math inline">º</span>): ATTACK {-#attack}

<span id="punch:4-12" label="punch:4-12">[punch:4-12]</span><br />
<em>The reference angle of attack used to calculate derived variables.</em> This variable is the reference selected from other measurements of angle of attack in the data set. In most projects, it is equal to AKRD. It is used where attack angle is needed for other derived calculations (e.g., wind measurements).</p>

#### Sideslip Angle (Differential Pressure) (<span class="math inline">º</span>): SSRD {-#ssrd}

<em>The angle of sideslip of the aircraft.</em> This derived measurement represents the angle between the longitudinal axis of the aircraft and the projection of the relative wind onto the plane determined by the longitudinal and lateral axes. Positive values indicate airflow from the starboard side. This variable is derived from BDIFR and a dynamic pressure using a sensitivity function that has been determined empirically for each aircraft.<br /></p>
```{r child='SSRDbox.Rmd'}
```

#### Reference Sideslip Angle (<span class="math inline">º</span>): SSLIP {-#sslip}

<em>The reference sideslip angle used to calculate derived variables</em>. This variable is the reference selected from other measurements of sideslip angle in the data set. In most projects, it is equal to SSRD. It is used where sideslip angle is needed for other derived calculations (e.g., wind measurements).</p>
  
<!-- <h3 id="wind-components-and-the-wind-vector">Wind Components and the Wind Vector</h3> -->
### Wind Components and the Wind Vector

#### Wind Vector Components (m/s): UI, VI, WI {-#ui-vi-wi}

<em>The three-dimensional wind vector with respect to the earth,</em> as determined from the inertial reference systems. UI is the east-west component with positive values <span class="underline">toward</span> the east, VI is the north-south component with positive values <span class="underline">toward</span> the north, and WI is the vertical component with positive values toward the zenith.<br />
The calculation of WI differs from the description in Bulletin 23 because the output from the inertial reference system is different for the modern units now in use. The vertical wind is the sum of the vertical gust component (represented approximately by TASX sin(ATTACK-PITCH)) and the motion of the aircraft as measured by VSPD (discussed in Section XXX). Bulletin 23 describes the historical calculation of the vertical motion of the aircraft via a barometric-inertial feedback loop, but equivalent calculations (including pressure damping to the pressure altitude) are incorporated into current IRS units so VSPD already is the product of such a calculation. To calculate WI, VSPD is therefore used in place of the obsolete variable WP3 that was discussed in Bulletin 23.
<br />
WIC should usually be used instead of WI because VSPD, entering WI, is updated to the pressure altitude and so can have false variations in baroclinic conditions. WIC uses GGVSPD (or in some cases older GPS-based rate-of-climb variables) in place of VSPD and so is more reliable.<br />
<strong></strong></p>

#### Wind Speed and Direction (m/s and <span class="math inline">º</span>): WS, WD {-#ws-wd}

<em>The magnitude and direction of the horizontal wind.</em> These variables are obtained in a straightforward manner from UI and VI. The resulting wind direction is relative to true north and represents the direction <span class="underline">from which</span> the wind blows. That is the reason that 180<span class="math inline"><em></em><sup>∘</sup></span> appears in the following algorithm.<br />
```{r child='WDWSbox.Rmd'}
```

#### Wind Vector Longitudinal and Lateral Components (m/s): UX and VY {-#ux-vy}

<em>The horizontal wind</em> <em>vector relative to the frame of reference attached to the aircraft.</em> UX is parallel to the longitudinal axis and positive toward the nose. VY is along the lateral axis and normal to the longitudinal axis; positive is toward the port (or left) wing.<br />  

#### GPS-Corrected Wind Vector, East and North Components (m/s): UIC, VIC {-#uic-vic}

<em>The horizontal wind components</em> respectively <em><span class="underline">toward</span></em> <em>the east and</em> <em><span class="underline">toward</span></em> <em>the north.</em> They are derived from measurements from an inertial reference unit (IRU) and a Global Positioning System (GPS), as described in the discussion of VEW and VNS above. They are calculated just as for UX and VY except that the GPS-corrected values for the aircraft groundspeed are used in place of the IRU-based values. They are considered “corrected” from the original measurements from the IRU or GPS, as described in Section \@ref(combining-irs-and-gps-measurements).</p><br />

#### Wind Vector, Vertical Component (m/s): WIC {-#wic}

<em>The component of the wind in the vertical direction.</em> This is the standard calculation of vertical wind, obtained from the difference between the measured vertical component of the relative wind and the vertical motion of the aircraft (usually GGVSPD in recent projects).<span id="punch:4-13" label="punch:4-13">[punch:4-13]</span><strong></strong> This should be used in preference to WI if the latter is present; see the discussion of WP3 in Section \@ref(inertial-reference-systems). Positive values are toward the zenith.<br />

#### GPS-Corrected Wind Speed and Direction (m/s and <span class="math inline"><em></em><sup>∘</sup></span>): WSC, WDC {-#wsc-wdc}

<em>The magnitude and direction of the wind vector,</em> obtained by combining measurements from GPS and IRU units. These variables are obtained in a straightforward manner from UIC and VIC, using equations analogous to \@ref(eq:WS) and \@ref(eq:WD) but with UIC and VIC as input measurements. They are expected to be the preferred measurements of wind because they combine the best features of the IRU and GPS measurements.<br />

#### GPS-Corrected Wind Vector, Longitudinal and Lateral Components (m/s): UXC, VYC {-#uxc-vyc} 

<em>The longitudinal and lateral components of the three-dimensional wind, similar to UX and VY, but corrected by the complementary-filter algorithm that combines IRU and GPS measurements</em>. See the discussion in Section \@ref(combining-irs-and-gps-measurements). The components UXC and VYC are toward the front of the aircraft and toward the port (left) wing, respectively.</p>  

<!-- <h2 id="special-use-remote-sensors">Special-Use Remote Sensors</h2> -->
## Special-Use Remote Sensors {#special-use-remote}

<p>The above variables are normally included in the archived netCDF files from projects, but there are a few remote sensors that provide additional state-parameter measurements in some projects. These include:<span id="subsec:MTP" label="subsec:MTP"></span></p>

* Microwave Temperature Profiler (http://www.eol.ucar.edu/instruments/microwave-temperature-profiler) {MTP})
-- remotely sensed temperature profiles  
* Dropsonde System (https://www.eol.ucar.edu/observing_facilities/avaps-dropsonde-system) {AVAPS})
-- profiles of temperature, humidity, and wind vs pressure.  
* GPS-Occultation Sensor (http://www.eol.ucar.edu/instruments/gnss-instrument-system-multi-static-and-occultation-sensing) {GISMOS})
-- atmospheric soundings of refractivity via GPS occultation.  

<p>The links provided connect to descriptions of these instruments on the EOL web site, and each provides a summary of how data are acquired and processed. These measurements are not normally part of the archived netCDF project files. Those interested in using these measurements should contact EOL data management (<a href="mailto:raf-dm@eol.ucar.edu">mailto:raf-dm@eol.ucar.edu</a>) for access to the measurements and for information on how the measurements are processed.</p>


<!--chapter:end:04-StateOfTheAtmosphere.Rmd-->

# Blocks

## Equations

Here is an equation.

\begin{equation} 
  f\left(k\right) = \binom{n}{k} p^k\left(1-p\right)^{n-k}
  (\#eq:binom)
\end{equation} 

You may refer to using `\@ref(eq:binom)`, like see Equation \@ref(eq:binom).


## Theorems and proofs

Labeled theorems can be referenced in text using `\@ref(thm:tri)`, for example, check out this smart theorem \@ref(thm:tri).

::: {.theorem #tri}
For a right triangle, if $c$ denotes the *length* of the hypotenuse
and $a$ and $b$ denote the lengths of the **other** two sides, we have
$$a^2 + b^2 = c^2$$
:::

Read more here <https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html>.

## Callout blocks


The R Markdown Cookbook provides more help on how to use custom blocks to design your own callouts: https://bookdown.org/yihui/rmarkdown-cookbook/custom-blocks.html

<!--chapter:end:05-blocks.Rmd-->

# Sharing your book

## Publishing

HTML books can be published online, see: https://bookdown.org/yihui/bookdown/publishing.html

## 404 pages

By default, users will be directed to a 404 page if they try to access a webpage that cannot be found. If you'd like to customize your 404 page instead of using the default, you may add either a `_404.Rmd` or `_404.md` file to your project root and use code and/or Markdown syntax.

## Metadata for sharing

Bookdown HTML books will provide HTML metadata for social sharing on platforms like Twitter, Facebook, and LinkedIn, using information you provide in the `index.Rmd` YAML. To setup, set the `url` for your book and the path to your `cover-image` file. Your book's `title` and `description` are also used.



This `gitbook` uses the same social sharing data across all chapters in your book- all links shared will look the same.

Specify your book's source repository on GitHub using the `edit` key under the configuration options in the `_output.yml` file, which allows users to suggest an edit by linking to a chapter's source file. 

Read more about the features of this output format here:

https://pkgs.rstudio.com/bookdown/reference/gitbook.html

Or use:

```{r eval=FALSE}
?bookdown::gitbook
```



<!--chapter:end:06-share.Rmd-->

`r if (knitr::is_html_output()) '
# References {-}
'`

<!--chapter:end:07-references.Rmd-->

<p class=box>
[ADIFR](#adifr) = attack differential pressure, radome [hPa]  
[QCF](#qcx) = uncorrected dynamic pressure [hPa]  
[MACH](#mach-number) = uncorrected Mach number based on QCF and PSF
without humidity correction  
$e_{0},\,e{}_{1},\,e_{2}$ = sensitivity
coefficients determined empirically; typically:  
\ \ \ \ \ {4.7532, 9.7908, 6.0781} for the C-130^(a)^  
\ \ \ \ \ {4.605$\,[^{\circ}]$, $18.44\,[^{\circ}]$, $6.75\,[^{\circ}]$}
for the GV  
\_\_\_\_\_\_\_\_\_\_  
^(a)^ Prior to Jan 2012, when the GV radome was changed: {5.516, 19.07, 2.08}  
</p><p class=box2>
\begin{equation}
\mathrm{\{AKRD\}}=e_{0}+\frac{\{\mathrm{ADIFR}\}}{\{\mathrm{QCF}\}}\left(e_{1}+e{}_{2}\mathrm{\{MACH\}}\right)
(\#eq:AKRD)
\end{equation}
</p>  

<!--chapter:end:AKRDbox.Rmd-->

# (APPENDIX) Appendix {-} 

# Appendix A: List of Symbols {.unnumbered}

<!-- Generated from Symbols.pdf via "convert -density 200 Symbols.pdf -quality 90 Symbols.jpg"  -->

<div class="figure">
  <img src="Symbols-0.jpg" width="1200" height="1200" />
  <img src="Symbols-1.jpg" width="1200" height="1200" />
</div>

<!-- <div class="vscroll-plot"> -->
```{r  echo=FALSE, out.width = "95%", attr.output='style="max-height: 8000px;"'}
# knitr::include_graphics('Symbols.pdf') 
```
<!-- </div> -->

# Appendix B: Variable Names {-}

Links are to the primary discussion of each variable. $\ddagger$ denotes an obsolete variable. 


Variable Name | Variable Name | Variable Name | Variable Name | Variable Name 
------------- | ------------- | ------------- | ------------- | -------------
[A200X](/rmd_output/1/5-cloud-physics-variables.html#CRPC)| [A200Y](/rmd_output/1/5-cloud-physics-variables.html#CRPC)| [A260X](/rmd_output/1/5-cloud-physics-variables.html#CRPC)| [AACT](/rmd_output/1/10-obsolete-variables.html#AACT)| [ACDP](/rmd_output/1/5-cloud-physics-variables.html#CRPC)
[ACINS](/rmd_output/1/3-the-state-of-the-aircraft.html#ACINS)| [ADIFR](/rmd_output/1/4-the-state-of-the-atmosphere.html#adifr)| [AF300](/rmd_output/1/5-cloud-physics-variables.html#CRPC)| [AFIXx$\ddagger$](/rmd_output/1/10-obsolete-variables.html#vanes)| [AFSSP](/rmd_output/1/5-cloud-physics-variables.html#CRPC)
[A1DC](/rmd_output/1/5-cloud-physics-variables.html#a1dc-a1dp)| [A1DP](/rmd_output/1/5-cloud-physics-variables.html#a1dc-a1dp)| [AKFXx$\ddagger$](/rmd_output/1/10-obsolete-variables.html#akfxx)| [AKRD](/rmd_output/1/4-the-state-of-the-atmosphere.html#akrd)| 
[ALAT$\ddagger$](/rmd_output/1/10-obsolete-variables.html#ltn51)| [ALON$\ddagger$](/rmd_output/1/10-obsolete-variables.html#ltn51)| [ALPHA$\ddagger$](/rmd_output/1/10-obsolete-variables.html#ltn51)| [ALT](/rmd_output/1/3-the-state-of-the-aircraft.html#alt)| [ALTG](/rmd_output/1/3-the-state-of-the-aircraft.html#altg)
[ALTX$\ddagger$](/rmd_output/1/3-the-state-of-the-aircraft.html#altx)| [AMS](/rmd_output/1/7-aerosol-particle-measurements.html#special-aerosol)| 
[APCAS](/rmd_output/1/5-cloud-physics-variables.html#CRPC)| [AS100](/rmd_output/1/5-cloud-physics-variables.html#CRPC)| [AS200](/rmd_output/1/5-cloud-physics-variables.html#CRPC)| [ATC](/rmd_output/1/10-obsolete-variables.html#atc)
[AT_ITR](/rmd_output/1/4-the-state-of-the-atmosphere.html#at-itr)| [ATKP$\ddagger$](/rmd_output/1/10-obsolete-variables.html#atkp)| [ATRF$\ddagger$](/rmd_output/1/10-obsolete-variables.html#atrf)| [ATTACK](/rmd_output/1/4-the-state-of-the-atmosphere.html#attack)| [ATx](/rmd_output/1/4-the-state-of-the-atmosphere.html#ambient-t)
[ATX](/rmd_output/1/4-the-state-of-the-atmosphere.html#ambient-t) [ATxH](/rmd_output/1/4-the-state-of-the-atmosphere.html#ambient-t)| [ATxD](/rmd_output/1/4-the-state-of-the-atmosphere.html#ambient-t)| [AUHSAS](/rmd_output/1/5-cloud-physics-variables.html#CRPC)| [AVAPS](/rmd_output/1/4-the-state-of-the-atmosphere.html#special-use-remote)
[AWAS](/rmd_output/1/6-air-chemistry-measurements.html#awas-cims-qcls-toga)| [base_time](/rmd_output/1/2-general-information-about-data-files.html#base-time)| [BDIFR](/rmd_output/1/4-the-state-of-the-atmosphere.html#bdifr)| [BFIXx$\ddagger$](/rmd_output/1/10-obsolete-variables.html#vanes)|
[BLATA](/rmd_output/1/3-the-state-of-the-aircraft.html#blata)| [BLONA](/rmd_output/1/3-the-state-of-the-aircraft.html#blona)| [BNORMA](/rmd_output/1/3-the-state-of-the-aircraft.html#bnorma)| [BPITCHR](/rmd_output/1/3-the-state-of-the-aircraft.html#bpitchr)| [BROLLR](/rmd_output/1/3-the-state-of-the-aircraft.html#brollr)
[BYAWR](/rmd_output/1/3-the-state-of-the-aircraft.html#byawr)| [C1DC](/rmd_output/1/5-cloud-physics-variables.html#c1dc-c1dp)| [C1DP](/rmd_output/1/5-cloud-physics-variables.html#c1dc-c1dp)| [C200X](/rmd_output/1/5-cloud-physics-variables.html#size-distribution)| [C200Y](/rmd_output/1/5-cloud-physics-variables.html#size-distribution)
[C260X](/rmd_output/1/5-cloud-physics-variables.html#size-distribution)| [CAVP_x](/rmd_output/1/4-the-state-of-the-atmosphere.html#p-special)| [CCDP](/rmd_output/1/5-cloud-physics-variables.html#size-distribution)| [CCEP$\ddagger$](/rmd_output/1/10-obsolete-variables.html#loranc)| [CF300](/rmd_output/1/5-cloud-physics-variables.html#size-distribution)
[CFSEC$\ddagger$](/rmd_output/1/10-obsolete-variables.html#loranc)| [CFSSP](/rmd_output/1/5-cloud-physics-variables.html#size-distribution)| [CGS$\ddagger$](/rmd_output/1/10-obsolete-variables.html#loranc)| [CH4_PICx](/rmd_output/1/6-air-chemistry-measurements.html#co2-pic)| [CIMS](/rmd_output/1/6-air-chemistry-measurements.html#awas-cims-qcls-toga)
[CLAT$\ddagger$](/rmd_output/1/10-obsolete-variables.html#loranc)|
[CLON$\ddagger$](/rmd_output/1/10-obsolete-variables.html#loranc)| [CMODE](/rmd_output/1/10-obsolete-variables.html#co-vars)| [CNTEMP](/rmd_output/1/7-aerosol-particle-measurements.html#cntemp)| [CNTS](/rmd_output/1/7-aerosol-particle-measurements.html#cnts)| [CO](/rmd_output/1/10-obsolete-variables.html#co)
[CO2_PICx](/rmd_output/1/6-air-chemistry-measurements.html#co2-pic)| [COCAL](/rmd_output/1/10-obsolete-variables.html#co-vars)| [COCOR](/rmd_output/1/10-obsolete-variables.html#co-vars)| [COMR_AL](/rmd_output/1/6-air-chemistry-measurements.html#comr-al)| [CONC1DC](/rmd_output/1/5-cloud-physics-variables.html#conc2d)
[CONC1DC100](/rmd_output/1/5-cloud-physics-variables.html#conc2d)| [CONC1DC150](/rmd_output/1/5-cloud-physics-variables.html#conc2d)| [CONC1DP](/rmd_output/1/5-cloud-physics-variables.html#conc2d)| [CONC3](/rmd_output/1/5-cloud-physics-variables.html#concentration)| [CONC6](/rmd_output/1/5-cloud-physics-variables.html#concentration)
[CONCD](/rmd_output/1/5-cloud-physics-variables.html#concentration)| [CONCF](/rmd_output/1/5-cloud-physics-variables.html#concentration)| [CONCH_UVH](/rmd_output/1/4-the-state-of-the-atmosphere.html#uvh-n)| [CONCN](/rmd_output/1/7-aerosol-particle-measurements.html#concn)| [CONCP](/rmd_output/1/7-aerosol-particle-measurements.html#special-aerosol)
[CONCP](/rmd_output/1/5-cloud-physics-variables.html#concentration)| [CONCU](/rmd_output/1/7-aerosol-particle-measurements.html#concu-concp)| [CONCU](/rmd_output/1/5-cloud-physics-variables.html#concentration)| [CONCU100](/rmd_output/1/5-cloud-physics-variables.html#concentration)| [CONCU500](/rmd_output/1/5-cloud-physics-variables.html#concentration)
[CONCV_VXL](/rmd_output/1/4-the-state-of-the-atmosphere.html#vcsel-corr)| [CONCX](/rmd_output/1/5-cloud-physics-variables.html#concentration)| [CONCY](/rmd_output/1/5-cloud-physics-variables.html#concentration)| [CORAW_AL](/rmd_output/1/6-air-chemistry-measurements.html#coraw-al)| [COZRO](/rmd_output/1/10-obsolete-variables.html#co-vars)
[CPCAS](/rmd_output/1/5-cloud-physics-variables.html#size-distribution)| [CRHP](/rmd_output/1/10-obsolete-variables.html#cryo-hygro)| [CS100](/rmd_output/1/5-cloud-physics-variables.html#size-distribution)| [CS200](/rmd_output/1/5-cloud-physics-variables.html#size-distribution)| [CSEC$\ddagger$](/rmd_output/1/10-obsolete-variables.html#loranc)
[CSTAT$\ddagger$](/rmd_output/1/10-obsolete-variables.html#loranc)| 
[CUHSAS](/rmd_output/1/5-cloud-physics-variables.html#size-distribution)| [DAY](/rmd_output/1/2-general-information-about-data-files.html#mdy)|
[DBAR1DC](/rmd_output/1/5-cloud-physics-variables.html#dbar2d)| [DBAR1DP](/rmd_output/1/5-cloud-physics-variables.html#dbar2d)| [DBAR3](/rmd_output/1/5-cloud-physics-variables.html#mean-diameter)| [DBAR6](/rmd_output/1/5-cloud-physics-variables.html#mean-diameter)
[DBARD](/rmd_output/1/5-cloud-physics-variables.html#mean-diameter)| [DBARF](/rmd_output/1/5-cloud-physics-variables.html#mean-diameter)| [DBARP](/rmd_output/1/5-cloud-physics-variables.html#mean-diameter)| [DBARU](/rmd_output/1/5-cloud-physics-variables.html#mean-diameter)| [DBARX](/rmd_output/1/5-cloud-physics-variables.html#mean-diameter)
[DBARY](/rmd_output/1/5-cloud-physics-variables.html#mean-diameter)| [DBZ1DC](/rmd_output/1/5-cloud-physics-variables.html#dbz2d)| [DBZ1DP](/rmd_output/1/5-cloud-physics-variables.html#dbz2d)
[DBZ6](/rmd_output/1/5-cloud-physics-variables.html#DBZ)| [DBZD](/rmd_output/1/5-cloud-physics-variables.html#DBZ)| [DBZF](/rmd_output/1/5-cloud-physics-variables.html#DBZ)| [DBZX](/rmd_output/1/5-cloud-physics-variables.html#DBZ)| [DBZY](/rmd_output/1/5-cloud-physics-variables.html#DBZ)
[DEI](/rmd_output/1/3-the-state-of-the-aircraft.html#dei-dni)| [DISP1DC](/rmd_output/1/5-cloud-physics-variables.html#disp2d)| [DISP1DP](/rmd_output/1/5-cloud-physics-variables.html#disp2d)| [DISP3](/rmd_output/1/5-cloud-physics-variables.html#dispersion)| [DISP6](/rmd_output/1/5-cloud-physics-variables.html#dispersion)
[DISPD](/rmd_output/1/5-cloud-physics-variables.html#dispersion)| [DISPF](/rmd_output/1/5-cloud-physics-variables.html#dispersion)| [DISPP](/rmd_output/1/5-cloud-physics-variables.html#dispersion)| [DISPU](/rmd_output/1/5-cloud-physics-variables.html#dispersion)| [DISPX](/rmd_output/1/5-cloud-physics-variables.html#dispersion)
[DISPY](/rmd_output/1/5-cloud-physics-variables.html#dispersion)| [DNI](/rmd_output/1/3-the-state-of-the-aircraft.html#dei-dni)| [DP_CR2C](/rmd_output/1/4-the-state-of-the-atmosphere.html#dp-cr2)| [DPCRC](/rmd_output/1/10-obsolete-variables.html#cryo-hygro)| [DP_VXL](/rmd_output/1/4-the-state-of-the-atmosphere.html#vcsel-dp)
[DPx](/rmd_output/1/4-the-state-of-the-atmosphere.html#dew-point)| [DPx](/rmd_output/1/4-the-state-of-the-atmosphere.html#dew-point)| [DPxC](/rmd_output/1/4-the-state-of-the-atmosphere.html#dewpt-corrected)| [DPXC](/rmd_output/1/4-the-state-of-the-atmosphere.html#dewpt-corrected)| [DP_x](/rmd_output/1/4-the-state-of-the-atmosphere.html#dew-point)
[DT1DC](/rmd_output/1/5-cloud-physics-variables.html#dt1dc)| [DVALUE](/rmd_output/1/4-the-state-of-the-atmosphere.html#dvalue)| [EDPC](/rmd_output/1/4-the-state-of-the-atmosphere.html#ewx)| [EDPC$\ddagger$](/rmd_output/1/10-obsolete-variables.html#edpc)| [EW_UVH](/rmd_output/1/4-the-state-of-the-atmosphere.html#ewx)
[EWx](/rmd_output/1/4-the-state-of-the-atmosphere.html#ewx)| [EWX](/rmd_output/1/4-the-state-of-the-atmosphere.html#ewx)| [FACT](/rmd_output/1/10-obsolete-variables.html#fact)| [FBMFR](/rmd_output/1/10-obsolete-variables.html#fbmfr)| [FCN](/rmd_output/1/7-aerosol-particle-measurements.html#fcnc)
[FCNC](/rmd_output/1/7-aerosol-particle-measurements.html#fcnc)| [FO3_ACD](/rmd_output/1/6-air-chemistry-measurements.html#fo3-acd)| [FO3_CL](/rmd_output/1/6-air-chemistry-measurements.html#fo3-acd)| [FO3_x](/rmd_output/1/6-air-chemistry-measurements.html#fo3-acd)| [FP_CR2](/rmd_output/1/4-the-state-of-the-atmosphere.html#mirror-cr2)
[FPCRC](/rmd_output/1/10-obsolete-variables.html#cryo-hygro)| [FRANGE](/rmd_output/1/5-cloud-physics-variables.html#fssp-range)| [FRESET](/rmd_output/1/10-obsolete-variables.html#freset)| [FRNG](/rmd_output/1/5-cloud-physics-variables.html#fssp-range)| [FRST](/rmd_output/1/10-obsolete-variables.html#freset)
[FSTB](/rmd_output/1/10-obsolete-variables.html#fstrob)| [FSTROB](/rmd_output/1/10-obsolete-variables.html#fstrob)| [FXAZIM](/rmd_output/1/3-the-state-of-the-aircraft.html#fxazim)| [FXDIST](/rmd_output/1/3-the-state-of-the-aircraft.html#fxazim)| [GALT_A](/rmd_output/1/3-the-state-of-the-aircraft.html#ggalt)
[GEOPHT](/rmd_output/1/3-the-state-of-the-aircraft.html#geopth)| [GGALT](/rmd_output/1/3-the-state-of-the-aircraft.html#ggalt)| [GGALTC$\ddagger$](/rmd_output/1/3-the-state-of-the-aircraft.html#altx)| [GGEOIDHT](/rmd_output/1/3-the-state-of-the-aircraft.html#ggeoidht)| [GGHWGS](/rmd_output/1/3-the-state-of-the-aircraft.html#gghwgs)
[GGLAT](/rmd_output/1/3-the-state-of-the-aircraft.html#gglat)| [GGLON](/rmd_output/1/3-the-state-of-the-aircraft.html#gglon)| [GGNSAT](/rmd_output/1/3-the-state-of-the-aircraft.html#ggnsat)| [GGQUAL](/rmd_output/1/3-the-state-of-the-aircraft.html#ggqual)| [GGSPD](/rmd_output/1/3-the-state-of-the-aircraft.html#ggspd)
[GGSTATUS](/rmd_output/1/3-the-state-of-the-aircraft.html#ggstatus)|
[GGTRK](/rmd_output/1/3-the-state-of-the-aircraft.html#ggtrk)| [GGVEW](/rmd_output/1/3-the-state-of-the-aircraft.html#ggvew)| [GGVNS](/rmd_output/1/3-the-state-of-the-aircraft.html#ggvns)| [GGVSPD](/rmd_output/1/3-the-state-of-the-aircraft.html#ggvspd)
[GLAT](/rmd_output/1/3-the-state-of-the-aircraft.html#gglat)| [GLON](/rmd_output/1/3-the-state-of-the-aircraft.html#gglon)| [GMODE$\ddagger$](/rmd_output/1/3-the-state-of-the-aircraft.html#gmode)| [GNI](/rmd_output/1/7-aerosol-particle-measurements.html#special-aerosol)|  [GNSS](/rmd_output/1/4-the-state-of-the-atmosphere.html#special-use-remote)
[GSF](/rmd_output/1/3-the-state-of-the-aircraft.html#gsf)| [GSF_G](/rmd_output/1/3-the-state-of-the-aircraft.html#ggspd)
[GSF$\ddagger$](/rmd_output/1/10-obsolete-variables.html#gsf-obsolete)| [GSTAT_G](/rmd_output/1/3-the-state-of-the-aircraft.html#ggstatus)|
[GSTAT](/rmd_output/1/3-the-state-of-the-aircraft.html#ggstatus)| [GVZI$\ddagger$](/rmd_output/1/3-the-state-of-the-aircraft.html#ggvspd)| [HARP](/rmd_output/1/8-radiation-variables.html#harp)
[HGM](/rmd_output/1/3-the-state-of-the-aircraft.html#hgm)| 
[HGM232](/rmd_output/1/3-the-state-of-the-aircraft.html#hgm-232)| [HGME](/rmd_output/1/3-the-state-of-the-aircraft.html#hgme-159)| [HI3$\ddagger$](/rmd_output/1/3-the-state-of-the-aircraft.html#hi3)| [HOUR](/rmd_output/1/2-general-information-about-data-files.html#hms)|
[IAS](/rmd_output/1/10-obsolete-variables.html#ias)| [IRx](/rmd_output/1/10-obsolete-variables.html#irx)
[IRxC](/rmd_output/1/8-radiation-variables.html#irxc)| [IRXC](/rmd_output/1/8-radiation-variables.html#irxc)| [IRxHT](/rmd_output/1/8-radiation-variables.html#irxht)| [IRxHTV](/rmd_output/1/8-radiation-variables.html#irxht)| [IRXV](/rmd_output/1/8-radiation-variables.html#irxv)
[LAT](/rmd_output/1/3-the-state-of-the-aircraft.html#latitude)| [LATC](/rmd_output/1/3-the-state-of-the-aircraft.html#latc-lonc)| [LAT_G](/rmd_output/1/3-the-state-of-the-aircraft.html#gglat)| [LON](/rmd_output/1/3-the-state-of-the-aircraft.html#longitude)| [LONC](/rmd_output/1/3-the-state-of-the-aircraft.html#latc-lonc)
[LON_G](/rmd_output/1/3-the-state-of-the-aircraft.html#gglon)|  [LWC$\ddagger$](/rmd_output/1/10-obsolete-variables.html#jwlwc)| [LWCC$\ddagger$](/rmd_output/1/10-obsolete-variables.html#jwlw-corrected)|
[MACH](/rmd_output/1/4-the-state-of-the-atmosphere.html#mach-number)| [MACHx](/rmd_output/1/4-the-state-of-the-atmosphere.html#mach-number)
[MACHX](/rmd_output/1/4-the-state-of-the-atmosphere.html#mach-number)]| [MINUTE](/rmd_output/1/2-general-information-about-data-files.html#hms)|
[MIRRORT_CR2](/rmd_output/1/4-the-state-of-the-atmosphere.html#mirror-cr2)| [MR](/rmd_output/1/4-the-state-of-the-atmosphere.html#MR)| [MONTH](/rmd_output/1/2-general-information-about-data-files.html#mdy)|
[MRCR](/rmd_output/1/4-the-state-of-the-atmosphere.html#MR)| [MRLA](/rmd_output/1/4-the-state-of-the-atmosphere.html#MR)
[MRLH](/rmd_output/1/4-the-state-of-the-atmosphere.html#MR)| [MRVXL](/rmd_output/1/4-the-state-of-the-atmosphere.html#MR)| [NO](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)| [NO~y~](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)
[O3FS](/rmd_output/1/10-obsolete-variables.html#o3fs)| [O3MR_CL](/rmd_output/1/6-air-chemistry-measurements.html#f03-acd)|
[MTP](/rmd_output/1/4-the-state-of-the-atmosphere.html#special-use-remote)| [OAT](/rmd_output/1/4-the-state-of-the-atmosphere.html#oat)|
[PACT](/rmd_output/1/10-obsolete-variables.html#AACT)| [PALT](/rmd_output/1/3-the-state-of-the-aircraft.html#palt)| [PCAB](/rmd_output/1/4-the-state-of-the-atmosphere.html#p-special)| [PCN](/rmd_output/1/7-aerosol-particle-measurements.html#pcn)| [P_CR2](/rmd_output/1/4-the-state-of-the-atmosphere.html#p-special)
[PFLW](/rmd_output/1/7-aerosol-particle-measurements.html#pflw)| [PFLWC](/rmd_output/1/7-aerosol-particle-measurements.html#pflw)| [PHDG$\ddagger$](/rmd_output/1/10-obsolete-variables.html#ltn51)| [PITCH](/rmd_output/1/3-the-state-of-the-aircraft.html#pitch)|  [PLWC](/rmd_output/1/5-cloud-physics-variables.html#plwc)
[PLWC1](/rmd_output/1/5-cloud-physics-variables.html#plwc)| [PLWC1DC](/rmd_output/1/5-cloud-physics-variables.html#lwc2d)| [PLWC1DP](/rmd_output/1/5-cloud-physics-variables.html#lwc2d)| [PLWC6](/rmd_output/1/5-cloud-physics-variables.html#PSD-LWC)| [PLWCC](/rmd_output/1/5-cloud-physics-variables.html#plwcc)
[PLWCC1](/rmd_output/1/5-cloud-physics-variables.html#plwcc)| [PLWCD](/rmd_output/1/5-cloud-physics-variables.html#PSD-LWC)| [PLWCF](/rmd_output/1/5-cloud-physics-variables.html#PSD-LWC)| [PLWCG](/rmd_output/1/5-cloud-physics-variables.html#plwcg)| [PLWCX](/rmd_output/1/5-cloud-physics-variables.html#PSD-LWC)
[PLWCY](/rmd_output/1/5-cloud-physics-variables.html#PSD-LWC)| [PS_A](/rmd_output/1/4-the-state-of-the-atmosphere.html#psx)| [PSDPx](/rmd_output/1/4-the-state-of-the-atmosphere.html#p-special)| [PSFD](/rmd_output/1/4-the-state-of-the-atmosphere.html#psx)| [PSFRD](/rmd_output/1/4-the-state-of-the-atmosphere.html#psx)
[PSURF](/rmd_output/1/4-the-state-of-the-atmosphere.html#p-special)| [PSX](/rmd_output/1/4-the-state-of-the-atmosphere.html#psx)| [PSxC](/rmd_output/1/4-the-state-of-the-atmosphere.html#psx)| [PSXC](/rmd_output/1/4-the-state-of-the-atmosphere.html#psx)| [PSx](/rmd_output/1/4-the-state-of-the-atmosphere.html#psx)
[PTIME$\ddagger$](/rmd_output/1/10-obsolete-variables.html#ptime)|
[QC_A](/rmd_output/1/4-the-state-of-the-atmosphere.html#qcx)[ [QCBC$\ddagger$](/rmd_output/1/10-obsolete-variables.html#qcb)| [QCB$\ddagger$](/rmd_output/1/10-obsolete-variables.html#qcb)| [QCGC$\ddagger$](/rmd_output/1/10-obsolete-variables.html#qcb)| [QCG$\ddagger$](/rmd_output/1/10-obsolete-variables.html#qcb)
[QCLS](/rmd_output/1/6-air-chemistry-measurements.html#awas-cims-qcls-toga)| 
[QCx](/rmd_output/1/4-the-state-of-the-atmosphere.html#qcx)| [QCX](/rmd_output/1/4-the-state-of-the-atmosphere.html#qcx)| [QCxC](/rmd_output/1/4-the-state-of-the-atmosphere.html#qcx)| [QCXC](/rmd_output/1/4-the-state-of-the-atmosphere.html#qcx)| [RAWCONC_VXL](/rmd_output/1/4-the-state-of-the-atmosphere.html#vcsel-uncor)
[REFF2DC](/rmd_output/1/5-cloud-physics-variables.html#reff2d)| [REFF2DP](/rmd_output/1/5-cloud-physics-variables.html#reff2d)| [REFFD](/rmd_output/1/5-cloud-physics-variables.html#effective-radius)| [REFFF](/rmd_output/1/5-cloud-physics-variables.html#effective-radius)| [RHOLA](/rmd_output/1/4-the-state-of-the-atmosphere.html#rho)
[RHOUV](/rmd_output/1/4-the-state-of-the-atmosphere.html#rho)| [RHOx](/rmd_output/1/4-the-state-of-the-atmosphere.html#rho)| [RHUM](/rmd_output/1/4-the-state-of-the-atmosphere.html#rhumw)| [RHUMI](/rmd_output/1/4-the-state-of-the-atmosphere.html#rhumi)| [RICE](/rmd_output/1/5-cloud-physics-variables.html#rice)
[ROC](/rmd_output/1/3-the-state-of-the-aircraft.html#roc)| [ROLL](/rmd_output/1/3-the-state-of-the-aircraft.html#roll)| [RSTx](/rmd_output/1/8-radiation-variables.html#rstx)| [RTHRx](/rmd_output/1/4-the-state-of-the-atmosphere.html#recovery-t)| [RTx](/rmd_output/1/4-the-state-of-the-atmosphere.html#recovery-t)|
[RTX](/rmd_output/1/4-the-state-of-the-atmosphere.html#recovery-t)| [RTxH](/rmd_output/1/4-the-state-of-the-atmosphere.html#recovery-t)| [SECOND](/rmd_output/1/2-general-information-about-data-files.html#hms)|
[SCLWC](/rmd_output/1/10-obsolete-variables.html#sclwc)| [SFC](/rmd_output/1/3-the-state-of-the-aircraft.html#sfc)| [SMPS](/rmd_output/1/7-aerosol-particle-measurements.html#special-aerosol)
[SOLAZ](/rmd_output/1/8-radiation-variables.html#solaz)|
[SOLDE](/rmd_output/1/8-radiation-variables.html#solde)| [SOLEL](/rmd_output/1/8-radiation-variables.html#solel)| [SOLZE](/rmd_output/1/8-radiation-variables.html#solze)| [SPHUM](/rmd_output/1/4-the-state-of-the-atmosphere.html#sphum)| [SPxPitch](/rmd_output/1/8-radiation-variables.html#spx)
[SPxRoll](/rmd_output/1/8-radiation-variables.html#spx)| [SSFXx$\ddagger$](/rmd_output/1/10-obsolete-variables.html#akfxx)| [SSLIP](/rmd_output/1/4-the-state-of-the-atmosphere.html#sslip)| [SSRD](/rmd_output/1/4-the-state-of-the-atmosphere.html#ssrd)| [SWTC](/rmd_output/1/10-obsolete-variables.html#swtc)
[SWx](/rmd_output/1/10-obsolete-variables.html#swx)| [TASx](/rmd_output/1/4-the-state-of-the-atmosphere.html#true-airspeed)|
[TASX](/rmd_output/1/4-the-state-of-the-atmosphere.html#true-airspeed)| [TASHC](/rmd_output/1/4-the-state-of-the-atmosphere.html#tashc)| [TASxD](/rmd_output/1/4-the-state-of-the-atmosphere.html#true-airspeed)| [TCAVB](/rmd_output/1/8-radiation-variables.html#rstx)| [TCAVT](/rmd_output/1/8-radiation-variables.html#rstx)
[TCNTP](/rmd_output/1/7-aerosol-particle-measurements.html#tcntu-tcntp)| [TCNTU](/rmd_output/1/7-aerosol-particle-measurements.html#tcntu-tcntp)| [TEMP1](/rmd_output/1/7-aerosol-particle-measurements.html#cntemp)| [TEMP2](/rmd_output/1/7-aerosol-particle-measurements.html#cntemp)| [TEO3](/rmd_output/1/6-air-chemistry-measurements.html#te03)
[TEO3C](/rmd_output/1/6-air-chemistry-measurements.html#te03c)| [TEO3P](/rmd_output/1/6-air-chemistry-measurements.html#tep)| [TEP](/rmd_output/1/6-air-chemistry-measurements.html#tep)| [TET](/rmd_output/1/6-air-chemistry-measurements.html#tet)| [THDG](/rmd_output/1/3-the-state-of-the-aircraft.html#thdg)] 
[THETA](/rmd_output/1/4-the-state-of-the-atmosphere.html#theta)|
[THETAE](/rmd_output/1/4-the-state-of-the-atmosphere.html#thetae)| [THETAP](/rmd_output/1/4-the-state-of-the-atmosphere.html#thetae)| [THETAQ](/rmd_output/1/4-the-state-of-the-atmosphere.html#thetaq)| [THETAV](/rmd_output/1/4-the-state-of-the-atmosphere.html#thetav)| [THF$\ddagger$](/rmd_output/1/10-obsolete-variables.html#thf)
[THI$\ddagger$](/rmd_output/1/10-obsolete-variables.html#ltn51)| [Time](/rmd_output/1/2-general-information-about-data-files.html#time)| [time_offset](/rmd_output/1/2-general-information-about-data-files.html#time-offset)|
[TKAT_G](/rmd_output/1/3-the-state-of-the-aircraft.html#ggtrk)| [TMLAG$\ddagger$](/rmd_output/1/10-obsolete-variables.html#tmlag)| [TOGA](/rmd_output/1/6-air-chemistry-measurements.html#awas-cims-qcls-toga)
[TPTIME$\ddagger$](/rmd_output/1/10-obsolete-variables.html#tptime)| 
[TRSTB](/rmd_output/1/8-radiation-variables.html#trstx), [TRSTT](/rmd_output/1/8-radiation-variables.html#trstx)|  [TTKP$\ddagger$](/rmd_output/1/10-obsolete-variables.html#ttkp)|  [TTRF$\ddagger$](/rmd_output/1/10-obsolete-variables.html#ttrf)
[TTx$\ddagger$](/rmd_output/1/10-obsolete-variables.html#ttx)| [TVIR](/rmd_output/1/4-the-state-of-the-atmosphere.html#TVIR)| [UI](/rmd_output/1/4-the-state-of-the-atmosphere.html#ui-vi-wi)
[UIC](/rmd_output/1/4-the-state-of-the-atmosphere.html#uic-vic)| [UPRESS](/rmd_output/1/7-aerosol-particle-measurements.html#upress)| [USFLWC](/rmd_output/1/7-aerosol-particle-measurements.html#pflw)| [USMPFLW](/rmd_output/1/7-aerosol-particle-measurements.html#pflw)| [UVx](/rmd_output/1/10-obsolete-variables.html#uvx)
[UX](/rmd_output/1/4-the-state-of-the-atmosphere.html#ux-vy)| [UXC](/rmd_output/1/4-the-state-of-the-atmosphere.html#uxc-vyc)| [VCRH](/rmd_output/1/10-obsolete-variables.html#cryo-hygro)| [VEW$\ddagger$](/rmd_output/1/10-obsolete-variables.html#gsf-obsolete)| [VEWC](/rmd_output/1/3-the-state-of-the-aircraft.html#vewc-vnsc)
[VEW](/rmd_output/1/3-the-state-of-the-aircraft.html#vew)_| [VEW_G$\ddagger$](/rmd_output/1/3-the-state-of-the-aircraft.html#ggvew)| [VI](/rmd_output/1/4-the-state-of-the-atmosphere.html#ui-vi-wi)| [VIC](/rmd_output/1/4-the-state-of-the-atmosphere.html#uic-vic)| [VISxC](/rmd_output/1/8-radiation-variables.html#visxc)
[VISxHT](/rmd_output/1/8-radiation-variables.html#visxht)| [VISxHTV](/rmd_output/1/8-radiation-variables.html#visxht)| [VISxV](/rmd_output/1/8-radiation-variables.html#visxv)| [VLA$\ddagger$](/rmd_output/1/10-obsolete-variables.html#vla)
[VNS](/rmd_output/1/3-the-state-of-the-aircraft.html#vns)| [VNSC](/rmd_output/1/3-the-state-of-the-aircraft.html#vewc-vnsc)| [VNS_G](/rmd_output/1/3-the-state-of-the-aircraft.html#ggvns)| [VNS$\ddagger$](/rmd_output/1/10-obsolete-variables.html#gsf-obsolete)| [VSPD](/rmd_output/1/3-the-state-of-the-aircraft.html#vspd)
[VSPD_G](/rmd_output/1/3-the-state-of-the-aircraft.html#ggvspd)| [VY](/rmd_output/1/4-the-state-of-the-atmosphere.html#ux-vy)| [VYC](/rmd_output/1/4-the-state-of-the-atmosphere.html#uxc-vyc)| [VZI$\ddagger$](/rmd_output/1/10-obsolete-variables.html#vzi)| [WD](/rmd_output/1/4-the-state-of-the-atmosphere.html#ws-wd)
[WDC](/rmd_output/1/4-the-state-of-the-atmosphere.html#wsc-wdc)| [WDRCTN$\ddagger$](/rmd_output/1/10-obsolete-variables.html#wspd)| [WI](/rmd_output/1/4-the-state-of-the-atmosphere.html#ui-vi-wi)| [WIC](/rmd_output/1/4-the-state-of-the-atmosphere.html#wic)| [WP3](/rmd_output/1/3-the-state-of-the-aircraft.html#wp3)
[WS](/rmd_output/1/4-the-state-of-the-atmosphere.html#ws-wd)| [WSC](/rmd_output/1/4-the-state-of-the-atmosphere.html#wsc-wdc)| [WSPD$\ddagger$](/rmd_output/1/10-obsolete-variables.html#wspd)| [XCOMR](/rmd_output/1/6-air-chemistry-measurements.html#comr-al)| [XCOMR_AL$\ddagger$](/rmd_output/1/6-air-chemistry-measurements.html#comr-al)
[XFO3FNO](/rmd_output/1/6-air-chemistry-measurements.html#xf03fs)| 
[XFO3FS](/rmd_output/1/6-air-chemistry-measurements.html#xf03fs)| [XFO3P](/rmd_output/1/6-air-chemistry-measurements.html#xf03p)| [XICN](/rmd_output/1/7-aerosol-particle-measurements.html#xicnc)| [XICNC](/rmd_output/1/7-aerosol-particle-measurements.html#xicnc)| [XMACH2](/rmd_output/1/4-the-state-of-the-atmosphere.html#mach-number)
[XNCLF](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)| [XNMBT](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)| [XNO](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)| [XNOCAL](/rmd_output/1/6-air-chemistry-measurements.html#mr-no-no2)| [XNYCAL](/rmd_output/1/6-air-chemistry-measurements.html#mr-no-no2)
[XNOCF](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)| [XNOSF](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)
[XNOY](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)| [XNOYP](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)| [XNOZA](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)| [XNSAF](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)| [XNST](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)
[XNZAF](/rmd_output/1/6-air-chemistry-measurements.html#no-noy)| [XO3](/rmd_output/1/6-air-chemistry-measurements.html#f03-acd)| [XSIG_UVH](/rmd_output/1/4-the-state-of-the-atmosphere.html#uvh-voltage)| [XUVI](/rmd_output/1/10-obsolete-variables.html#xuvi)| 
[XUVP](/rmd_output/1/10-obsolete-variables.html#xuvi)| [XUVT](/rmd_output/1/10-obsolete-variables.html#xuvi)| [XVI$\ddagger$](/rmd_output/1/10-obsolete-variables.html#ltn51)| [YEAR](/rmd_output/1/2-general-information-about-data-files.html#mdy)|
[YVI$\ddagger$](/rmd_output/1/10-obsolete-variables.html#ltn51)|


# Appendix C: How to Edit This Document {.unnumbered}

Here are some notes regarding the construction and structure of this document:

* The original version is ProcessingAlgorithms.lyx, which needs ’LyX’, a user interface to TeX. It is available on EOL machines like tikal. Start it with “lyx ProcessingAlgorithms.lyx”.
* This revised version is written in RMarkdown to facilitate editing by others.
<li><p>The document is broken into many sections, referenced by the above file, so they must be present also. Then have names like Section3.lyx</p></li>
<li><p>The document generates three indices: a regular index, a list of symbols, and a list of variables. The references for these are embedded in the .lyx files, and they can be modified or more can be added via the “Insert -&gt; Index Entry” controls. These practices are useful when generating index entries:</p>
<ol class="incremental">
<li><p>entries like ’wind!relative’ will generate index entries as subordinate entries with ’relative’ below ’wind’</p></li>
<li><p>I have tried to emphasize using nouns to start index entries, so for example I would favor “coefficient!calibration” over “calibration coefficient.</p></li>
<li><p>It is sometimes useful to generate “see xxx” entries, which can be done as follows: “INS|see {Inertial Navigation System}” where the part in braces is also in LaTeX code, generated by pressing CNTL-L.</p></li>
</ol></li>
<li><p>Creating a PDF-format file in LyX usually will generate these lists also. To be safe and ensure that the lists are updated, follow these steps:</p>
<ol class="incremental">
<li><p>Export a LaTeX file from LyX in pdflatex format, using the “export” option.</p></li>
<li><p>Run “pdflatex ProcessingAlgorithms” three times to be sure all references are resolved.</p></li>
<li><p>Run “splitindex ProcessingAlgorithms” to generate files for the lists.</p></li>
<li><p>Run “makeindex ProcessingAlgorithms” to generate the lists.</p></li>
<li><p>Run “pdflatex ProcessingAlgorithms” again.</p></li>
</ol></li>
<li><p>The LyX files have embedded notes with additional information that should be retained, and exporting to LaTeX will lose this information, so it will be useful to retain the LyX format. The suggested next steps in the table above, for example, almost all have associated notes that will appear in yellow and will help identify where the comment applies.</p></li>
<li><p>It is sometimes easiest to edit the PDF file directly. Some of the web references have been changed in this way and can be adjusted as the reference files are moved, e.g., from my Google Drive to the EOL web pages. For this purpose, I found master-pdf-editor useful. This will lose continuity, however, because then the links can’t be re-generated by running LyX.</p></li>
<li><p>As of Feb 2019, many links formerly to google-drive addresses or eol system files have been changed to https://github.com/NCAR/aircraft_ProcessingAlgorithms links. In that directory there is a file (’links’) with a list of all the links in the document. It is worthwhile when updating this document to check that all the links remain current. One way is to use these R statements:<br />
links &lt;- readlines(’./links’); EURL &lt;- rep(FALSE, length(links));<br />
for (i in 1:length(links)) {EURL<span>[</span>i<span>]</span> &lt;- RCurl::url.exists(links<span>[</span>i<span>]</span>)}<br />  
and then check EURL to see that the links are all found.</p></li>
</ol>

## How to Reference Specific Sections or Pages of this Document: {.unnumbered}

### Variables {.unnumbered}

<p>The document includes named destinations for each variable name, so when used in a URL that destination can be reached. This is done differently in different browsers or PDF viewers:</p>
<ul class="incremental">
<li><p>For a web browser like Chrome or Firefox, use the “nameddest” reference; e.g., for the discussion of variable ATX, use<br />
<code>firefox http://www.eol.ucar.edu/system/files/ProcessingAlgorithms.pdf#nameddest=ATX</code></p></li>
<li><p>For a pdf viewer like evince, use this syntax:<br />
<code>evince -n ATX http://www.eol.ucar.edu/system/files/ProcessingAlgorithms.pdf</code></p></li>
</ul>
<p>Most variable names can be used in these URL modifiers. Here is a list of available targets by section in the report:</p>
<p><span class="underline">Section 1:</span> Time</p>
<p><span class="underline">Section 2:</span> <span>[</span>none<span>]</span></p>
<p><span class="underline">Section 3:</span> ACINS ALT BLATA BLONA BNORMA BPITCHR BROLLR BYAWR DEI DNI FXAZIM FXDIST GGALT GGLAT GGLON GGNSAT GGOIDHT GGSPD GGSTATUS GGTRK GGVEW GGVNS GGVSPD GGWUAL GMODE GSF HGM HGM232 HGME HI3 LAT LATC LON LONC PALT PITCH ROLL THDG VEW VEWC VNS VNSC VSPD</p>
<p><span class="underline">Section 4:</span> ADIFR AKRD AT_ITR ATx ATX ATxD ATxJ BDIFR CAVP_x CONCH_UVH CONCV_VXL DP_CR2C DP_VXL DPx DP_x DPxC DPXC DVALUE EDPC EW_UHV EWx EWX FP_CR2 MACHx MACHX MIRRORT_CR2 MIRRTMP_DPX MR MRCR MRLA MRLH MRVCL OAT PCAB PS_A PSDPx PSFD PSFRD PSURF PSx PSX PSxC PSXC QCx QCX QCxC QCXC RAWCONC_VXL RHOx RHUM RHUMI RTHRx RTx RTX RTxH SPHUM SSLIP TASHC TASx TASX TASxD THETA THETAE THETAP THETAQ THETAV TVIR UI UIC UX UXC VI VIC VY VYC WD WDC WI WIC WS WSC XSIGV_UHV</p>
<p><span class="underline">Section 5:</span> A1DC A1DP A200X A200Y A260X ACDP AF300 AFSSP APCAS AS100 AUHSAS C1DC C1DP C200X C200Y C260X CCDP CF300 CFSSP COMCP CONC1DC CONC1DC100 CONC1DC150 CONC1DP CONC3 CONC6 CONCD CONCF CONCU CONCX CONCY CPCAS CS100 CUHSAS DBAR1DC DBAR1DP DBAR3 DBAR6 DBARD DBARF DBARP DBARU DBARX DBARY DBZ DBZ1DC DBZ1DP DISP1DC DISP1DP DISP3 DISP6 DISPD DISPF DISPP DISPU DISPX DISPY DT1DC FRANGE FRNG PLWC1 PLWC1DC PLWC1DP PLWC6 PLWCC PLWCC1 PLWCD PLWCF PLWCG PLWCX PLWCY REFF2DC REFF2DP REFFD REFFF RICE</p>
<p><span class="underline">Section 6:</span> CO2_PIC COMR_AL CORAW_AL FO3_ACD FO3_CL O3MR_CL TEO3 TEO3C TEO3P TEP TET XFO3FNO XFO3FS XFO3P XNCLF XNMBT XNO XNOCAL XNOCF XNOSF XNOY XNOYP XNOZA XNSAF XNST XNYCAL XNZAF XO3</p>
<p><span class="underline">Section 7:</span> CNTEMP CNTS CONCN CONCP CONCU CONCU100 CONCU500 FCN FCNC PCN PFLW PFLWC TCHTP TCNTL TEMP1 TEMP2 UPRESS USFLWC USMPFLW XICN XICNC</p>
<p><span class="underline">Section 8:</span> IRxHT IRxV RSTx SPxPitch SPxRoll TRSTx VISxC VISxHT VISxV</p>
<p><span class="underline">Section 9:</span> <span>[</span>none<span>]</span></p>
<p><span class="underline">Section 10:</span> OBSOLETE</p>

### Page Numbers {.unnumbered}

<p>To reference a specific page in the document, use a web reference like this:<br />
<code>ProcessingAlgorithms.pdf#page=44</code></p>
<p>In evince, this syntax will work, or the page number can be specified in this way:</p>
<p><code>evince -p 115 ProcessingAlgorithms.pdf</code></p>

### Sections and Subsections {.unnumbered}
<p>Targets have not been provided for other parts of the document, but the above method of referencing pages can be used to link to specific sections and other components of the document.</p>

### Adding New Targets

<p>When a new variable is added, a new anchor point can be added by inserting, in LaTeX mode, <code>\nop{LAT} </code>at the appropriate point in the LyX document. (\nop has been defined to use \hypertarget but displace the reference upward one line.) In addition, when a new variable is added, entries should be made in the index items and the variable-names list, following the pattern used for existing variables, and if appropriate any new symbols used in discussing the algorithm should be added to the similar symbols list.</p>


# Appendix D: Suggestions Needing Further Attention {.unnumbered}

<table>
<thead>
<tr class="header">
<th style="text-align: center;"><strong>page</strong></th>
<th style="text-align: left;"><strong>suggested action</strong></th>
<th style="text-align: left;"><strong>who?</strong></th>
</tr>
</thead>
<tbody>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Update MW table for current CO2 concentration</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">Add, to constants table, a reference to what has been in use previously. (See Code.amlib as saved 2011, for examples)</td>
<td style="text-align: left;">WAC – not sure if needed?</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Ask Teresa and Mike R. to review the discussion re trace-gas units</td>
<td style="text-align: left;">done, MR</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">Get info from Chris W describing interpolation and time adjustments, for inclusion as an addition to the section on times. Revise section.</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Get place to put algorithm notes, and include links to those additional discussions in this document.</td>
<td style="text-align: left;">partly done</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">In algorithm boxes, when variables are referenced, make those references active links to the discussion of the variable</td>
<td style="text-align: left;">WAC: use hyperlink{}{}</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Get description of the history of the C-130 INS, with characteristics for the Litton at least.</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">Add history of GPS systems: What was used when (C-130 at least)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Add/clarify section on height-above-terrain; modify to ref. geoid. Need to change HeightAboveTerrain() script.</td>
<td style="text-align: left;">partly done, WAC,</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">check/clarify discussion of height-above-geoid and, generally, geopotential vs geometric vs geoid height</td>
<td style="text-align: left;">done - WAC</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Add a variable representing geopotential height and change DVALUE to be based on it minus PALT</td>
<td style="text-align: left;">WAC - done (proposed)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">Clarify meaning of mode and status for old GPS units, and if used anymore</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Add new section on ALTC? Info is there in comments. Implement?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">should there be a vertical velocity of the AC based on data-system GPS? ROC as used for reprocessing, and WIR as backup to WIC?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Check/update sensors used on both aircraft.</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">Add to historical description of PCORs, esp. re subroutine references (QCF, MACH_A, ADIFR)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Add a discussion of the additional corrections to QCR that could make this less sensitive to AOA? Algorithm is developed and documented; implement? Coefficients in ProcessingAlgorithms.pdf are based on ARISTO2016 flight 6.</td>
<td style="text-align: left;">WAC - done (proposed)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">Suggestion: consider ALT_G and avoid ALT for GPS avionics variable</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Consider change to spherical geometry for distance north and east of reference point because range of GV is so great</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">need to explain how the two measures of longitude, with high and low resolution, are used together.</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Need to implement the discussion re correction for the displacement of the GPS antenna from the INS. When done, need to add LG=-4.30 m to the attributes for GGVSPD, GGVEW, GGVNS (GV) and get appropriate values for the C-130</td>
<td style="text-align: left;">WAC - done (proposed)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">Get Dick Friesen or someone to review and update the discussion of GPS GSTAT</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Revise the values listed for the complementary-filter feedback to match what is used now – better with lower values than listed</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">It might be useful to disable the roll test in gpsc.c, now that GPS is better than when this was implemented</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Goodrich Technical Report 5755: should we get permission and post this? (FAAM has it posted)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">In-cloud air T radiometer: could use more detail re the processing algorithm</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Check all the complex M-K section, esp. <span class="math inline"><em>T</em><sub><em>k</em></sub></span> and DP interp. function</td>
<td style="text-align: left;">partly done - WAC</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">Consider changing name to FP_CR2 in preference to MIRRORT_CR2?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">For CONCV_VXL, I think we need cal coefficients and equations used</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">For RHOx, the code now uses 216.68 instead of 100000/461.5228=216.674 as specified here; change?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Check that current code uses the modified PCOR function with humidity correction and early-error corrected</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">The PSURF definition references PSFDC; replace with PSXC?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">“ATTACK” and “SSLIP” differ from other “preferred” variables by not having “X” at the end. Consider name change?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">The variable WIC is described as “GPS-corrected” but that is misleading because it is really based, for aircraft motion, solely on GPS in recent usage (where dependence is on GGVSPD). Contrast to WDC/WSC which are really GPS-corrected. Suggest a different name, like “Wind Vector, Vertical Component, using GPS”?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Re Gerber probe, I didn’t find code for this; need to describe the algorithm.</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">It would be useful to update Bulletin 24 re hydrometeor spectrometers, with info from Bansemer and reference to work by Korolev, Strapp, Jensen, etc.</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Is “PMS/CSIRO King” correct? DMT?</td>
<td style="text-align: left;">OK - JBJ</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">Variables like AS200 have names with “Raw Accumulation” – seems awkward, consider name change? Maybe “Count” per channel?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">add the variables for total counts?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">some additions are needed here: RAFFD, PVOLU, TCNTD (total counts all cells, CDP); housekeeping variables? All: first and last bins? UHSAS: T and P in canister including UPRESS intensity, etc., better in sect 7</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">REFF2DC seems mis-named; all others based on 1D sizing from 2D have names involving 2DC</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">need Teresa and/or Andy W to check this section</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">need to understand and document what te03c.c does, and perhaps move to obsolete?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">Is NO-related discussion OK? is this right: The one named NO2 is actually for NOy?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">In true measurement mode, XNOZA and XNZAF will be near zero – is this right?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">I think the corrected-NO mixing ratio section may need revision?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">“has the provision for the addition of water vapor ” – does that mean this is always done, or only sometimes?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">to “0.1-360 s” add “but is typically set to 0.1 s”?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">UPRESS: the attributes for this variable say the units are kPa; is that incorrect? Mike R lists it as hPa.</td>
<td style="text-align: left;">resolved</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">check signs here for WD and WS; this differs from the section-9 equation ... ??</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">For EDPC, the &lt;-50 branch looks suspicious and needs checking</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">For old cryogenic hygrometer, find and include the 3rd-order equation referenced here</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">check Goff-Gratch formulas; there was some ambiguity in what was in B9</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">Should include basic equation for SWTC</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">re TECO CO: is the direct measurement (ppb) a mass ratio? Need explanation here if so to describe difference between ppb and ppbv</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">COCAL: how does this differ from XCOMR? Why is this in the “obsolete” section? Same for O3FS?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">For SCLWC, this is missing crucial information like how accreted mass is obtained from voltage. Couldn’t find the algorithm. Consider Mazin version? Or old one for Wyo KA?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">There are some additional notes regarding obsolete variables, esp. involving FSSP processing, that are not included here.</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">WIC, GGALT, etc.</td>
<td style="text-align: left;">Review and correct descriptive attributes (e.g., WIC, GGALT, <span>*</span>DGPS</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">StdSpeedofSound is wrong; enters ias.c – obsolete now?</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">fix Rd in xlate/const.c: calculated with wrong Md, although right one is listed later in routine. (trivial difference)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: left;">Lv defined in xlate/const.c is not latent heat but derivative of latent heat vs T. Used correctly in thetap.c and plwcc.c, but deceptively commented</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: left;">Review and approve new AKRD description</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>

<!--chapter:end:Appendices.Rmd-->

<style>
p.box {
background-color: #F8F8F8;
padding: 10px;
border: 2px solid black;
margin-left: 20px;
margin-right: 20px;
border-radius: 5px;
}
</style>

<style>
p.box2 {
background-color: #FFFFFF;
padding: 10px;
border: 2px solid red;
margin-left: 10px;
margin-right: 10px;
border-radius: 1px;
}
</style>
```{css, include = TRUE, echo = FALSE}
.box-out {
  background-color: palegrey;
  border: 2px solid darkgrey;
  font-size: 10pt;
}
```

<!--chapter:end:boxStyles.Rmd-->


<p class=box>
**CONSTANTS** (dependent on time constant $\tau$):^(a)^   
\footnote{}  
$a=\frac{2\pi}{\tau}$, 
$a_{2}$=$a\ e^{-a/2}(\cos(a\sqrt{\frac{3}{2}})+\sqrt{\frac{1}{3}}\sin(a\sqrt{\frac{3}{2}}))$,
$a_{3}$=2$e^{-a/2}$$\cos(a\sqrt{\frac{3}{2}})$, $a_{4}$=$e^{-a}$  
\_\_\_\_\_\_\_\_\_\_  
^(a)^ For processing prior to the 2014, the factor $\sqrt{\frac{3}{2}}$
was erroneously $\frac{\sqrt{3}}{2}$.  
</p>
```
// input x = unfiltered signal  
// output returned is low-pass-filtered input  
// tau determines the cutoff  
// zf[] saves values for recursion  
zf[2] = -a * x + a2 * zf[5] + a3 * zf[3] - a4 * zf[4];  
zf[1] = a{*}x + a4{*}zf[1];     
zf[4] = zf[3];  
zf[3] = zf[2];  
zf[5] = x;  
return(zf[1] + zf[2]); 
```

<!--chapter:end:CF14box.Rmd-->


<p class=box>  
VEW = IRS-measured east component
of the aircraft ground speed    
VNS = IRS-measured north component of the aircraft ground speed  
GGVEW = GPS-measured east component of the aircraft ground speed  
GGVNS = GPS-measured north component of the aircraft ground speed  
$F_{L}()$ = three-pole Butterworth low-pass recursive digital filter  
</p>
<p class=box2>
\begin{align}\begin{split}
\{\mathrm{VNSC}\} & = F_{L}(\mathrm{\{GGVNS\})}+(1-F_{L})(\{\mathrm{VNS\}})\\
\{\mathrm{VEWC}\} & = F_{L}(\mathrm{\{GGVEW\})}+(1-F_{L})(\{\mathrm{VEW\}})
\end{split}(\#eq:VC)
\end{align}
</p>


<!--chapter:end:CFbox.Rmd-->

```{r child='boxStyles.Rmd'}
```

<p class=box>
[CO$_{2}$]$_{wet}$ = carbon dioxide mixing ratio as measured
in the sensing cell (with water)  
[CO$_{2}$]$_{dry}$ = carbon dioxide mixing ratio in dry air,
corrected for the effects of water vapor  
[CH$_{4}$]$_{wet}$ = methane mixing ratio as measured in the
sensing cell (with water)  
[CH$_{4}$]$_{dry}$ = methane mixing ratio in dry air, corrected
for the effects of water vapor  
$W$ = water vapor mixing ratio measured in the instrument cell [percent
by volume]  
{$c_{0}$, $c_{1}$} = {$-0.01200,\,-2.674\times10^{-4}$} [dimensionless]  
{$d_{0}$, $d_{1}$} = {$-0.00982,\ -2.393\times10^{-4}$} [dimensionless]  
</p><p class=box2>
\begin{equation}
\{\mathrm{CO2\_PICX\}}=[\mathrm{CO_{2}]_{dry}=}\frac{[\mathrm{CO_{2}]_{wet}}}{1+c_{0}W+c_{1}W^{2}}
(\#eq:CO2PICbox1)
\end{equation}
\begin{equation}
\{\mathrm{CH4\_PICX\}}=[\mathrm{CH_{4}]_{dry}=}\frac{[\mathrm{CH_{4}]_{wet}}}{1+d_{0}W+d_{1}W^{2}}
(\#eq:CO2PICbox2)
\end{equation}
</p>

<!--chapter:end:CO2PICbox.Rmd-->


<p class=box>
CPS\index{CPS=counts per second} = counts per second from the instrument  
S(t) = sensitivity\sindex[lis]{S(t)=sensitivity function, calibration}
at time t  
\ \ \ \ \ \ \ = (CPS when exposed to cal gas) / concentration of cal gas  
Z(t) = zero\sindex[lis]{Z(t)=zero function, calibration} at time t  
\ \ \ \ \ \ \ = CPS when exposed to air passing through the catalyst trap  
</p><p class=box2>
\begin{equation}
\mathrm{\{COMR\_AL\}} = (\mathrm{\{CPS\}}-Z(t))/S(t)
(\#eq:COMRbox)
\end{equation}
</p>  

<!--chapter:end:COMRbox.Rmd-->

<p class=box>
CNTS = particle counts per sample interval from the CN counter  
$\Delta t$ = \sindex[lis]{Deltat@$\Delta t$=time interval}interval
between recorded samples [s]  
$t_{d}$ = cumulative dead time during the sampling interval [s]  
$C_{flow}$ (see preceding box)    
FCNC = corrected sample flow rate (VLPM) for instrument conditions  
PCN = internal pressure of the CN counter [hPa]  
CNTEMP = temperature of the optics block [$^{\circ}$C]  
PSXC = corrected ambient pressure [hPa]  
ATX = ambient temperature [$^{\circ}$C]  
$T_{0}$ = 273.15\ K  
</p><p class=box2>
\begin{equation}
\mathrm{A=\frac{\{CNTS\}}{\mathrm{(\{FCNC\}\times C_{flow})}(\Delta t-t_{d})}}
(\#eq:CONCN2box1)
\end{equation}
\begin{equation}
\mathrm{\{CONCN\}}=A\frac{\mathrm{\{PSXC\}}}{\mathrm{\{PCN\}}}\frac{\mathrm{(\{CNTEMP\}}+T_{0})}{(\mathrm{\{ATX\}}+T_{0})}
(\#eq:cwCONCN2box2)
\end{equation}
</p>  

<!--chapter:end:CONCN2box.Rmd-->

<p class=box>
CNTS = particle counts per sample interval from the CN counter\index{CNTS}  
$\Delta t$ = \sindex[lis]{Deltat@$\Delta t$=time interval}interval
between recorded samples [s]  
$D$ = scale factor (legacy; normally 1)  
$C_{flow}$ = \sindex[lis]{Cflow@$C_{flow}$ = flow conversion factor}conversion
factor, (1000/60) cm$^{3}$L$^{-1}$min s$^{-1}$  
FCNC = corrected sample flow rate (VLPM) for instrument conditions\index{FCNC}  
$t_{vv}$ = average time a particle is in the view volume  
\ \ \ \ \ \ \ = 0.4$\times10^{-6}$\ s  
PCN = pressure at the inlet to the CN counter [hPa]\index{PCN}  
CNTEMP = temperature at the inlet of the sample tube [$^{\circ}$C]\index{CNTEMP}  
PSXC = corrected ambient pressure [hPa]\index{PSXC}  
ATX = ambient temperature [$^{\circ}$C]\index{ATX}  
$T_{0}$ = 273.15\ K  
</p><p class=box2>
\begin{equation}
\mathrm{A=\frac{\{CNTS\}}{\mathrm{(\{FCNC\}\times C_{flow})}\Delta t}\,D}
(\#eq:CONCNbox1)
\end{equation}
The flow under instrument conditions, corrected for coincidence, is
then  
\begin{equation}
B\mathrm{=A}\,e^{At_{vv}(\mathrm{\{FCNC\}\times C_{flow})}}
(\#eq:CONCNbox2)
\end{equation}
and the concentration under ambient conditions is\index{CONCN}  
\begin{equation}
\mathrm{\{CONCN\}}=B\frac{\mathrm{\{PSXC\}}}{\mathrm{\{PCN\}}}\frac{\mathrm{(\{CNTEMP\}}+T_{0})}{(\mathrm{\{ATX\}}+T_{0})}
(\#eq:CONCNbox3)
\end{equation}
</p>  

<!--chapter:end:CONCNbox.Rmd-->

```{r child='boxStyles.Rmd'}
```
<p class=box>
TCNTU = total particle counts per sample interval, UHSAS  
TCNTP = total particle counts per sample interval, PCASP  
$\Delta t$ = \sindex[lis]{Deltat@$\Delta t$=time interval}sample
interval [s]  
USFLWC = corrected sample flow rate, UHSAS [cm$^{3}$s$^{-1}$]  
PFLWC = corrected sample flow rate, PCASP [cm$^{3}$s$^{-1}$]  
</p><p class=box2>
\begin{equation}
\mathrm{\{CONCU\}}=\frac{\mathrm{\{TCNTU\}}}{\mathrm{\{USFLWC\}}\Delta t}
(\#eq:CONCUbox1)
\end{equation}
\begin{equation}
\mathrm{\{CONCP\}}=\frac{\mathrm{\{TCNTP\}}}{\mathrm{\{PFLWC\}}\Delta t}
(\#eq:CONCUbox2)
\end{equation}
</p>

<!--chapter:end:CONCUbox.Rmd-->

----
<blockquote>
<center> __[Values Used for "Constants"]{#constants-table}__ </center>  
<br>
$g$ = \label{-constant-g}\sindex[lis]{g@$g$= acceleration of gravity}acceleration
of gravity\ \ $^{(a)}$\footnote{ } at latitude $\lambda$ \sindex[lis]{lambda@$\lambda$=latitude} and
altitude\sindex[lis]{z@$z$ = height} $z$ above the WGS-84 \index{WGS-84 geoid}geoid,\ \ $^{(b)}$\footnote{}  
\begin{align}
g(z,\lambda)=g_{e}\left(\frac{1+g_{1}\sin^{2}(\lambda)}{(1-g_{2}\sin^{2}\lambda)^{1/2}}\right)(1-(k_{1}-k_{2}\sin^{2}(\lambda))z+k_{3}z^{2})
(\#eq:gsublambda)
\end{align}  
\ \ \ \ \ \ \ where $g_{e}=9.780327$\ m\ s$^{-2}$, $g_{1}=0.00193185$, $g_{2}=0.00669438$, and  
\ \ \ \ \ \ \  {$k_{1},k_{2},k_{3}$} = {3.15704$\times 10^{-7}\mathrm{m}^{-1}$,
2.10269$\times 10^{-9}\mathrm{m}^{-1}$, 7.37452$\times 10^{-14}\mathrm{m}^{-2}$}  
$T_{0}$ = temperature in kelvin\sindex[lis]{T0@$T_{0}$=273.15\ K, temperature in kelvin corresponding to $0^{\circ}$C} corresponding to $0^{\circ}$C = 273.15\ K  
$T_{3}$ = temperature\sindex[lis]{T3@$T_{3}$= triple point temperature of water}
corresponding to the triple point of water\index{triple point of water}
= 273.16\ K  
$M_{d}$ = \sindex[lis]{Md@$M_{d}$= molecular weight of dry air}molecular
weight of dry air$^{(a)}$\index{molecular weight!dry air}, 28.9637
kg$\,$kmol$^{-1}$\ \ $^{(c)}$  
$M_{w}$ = \sindex[lis]{Mw@$M_{w}$= molecular weight of water}molecular
weight of water\index{molecular weight!water}, 18.0153 kg\ kmol$^{-1}$\ \ $^{(d)}$\footnote{}  
$R_{0}$ = \sindex[lis]{R@$R_{0}$= universal gas constant}universal
gas constant$^{a}$\index{universal gas constant}\index{gas constant!universal}
= 8.314472$\times 10^{3}$ J\ kmol$^{-1}$K$^{-1}$\ \    $^{(e)}$\footnote{\label{fn:2006-CODATA}}  
$N_{A}$ = Avogadro constant = 6.022141$\times 10^{26}$ molecules\ kmol$^{-1}$\index{Avogadro constant}\sindex[lis]{NA@$N_{A}$ = Avogadro constant, molecules per kmol}  
$k=R_{0}/(\mathrm{N_{A})}=1.38065\times10^{-23}\mathrm{J}\,\mathrm{K}^{-1}$\sindex[lis]{k@$k$=Boltzmann Constant}\index{Boltzmann constant}  
$R_{d}=(R_{0}/M_{d}$) = \sindex[lis]{Rd@$R_{d}=$gas constant for dry air}gas
constant for dry air\index{gas constant!dry air}  
$R_{w}$ = ($R_{0}/M_{w})$ = \sindex[lis]{Rw@$R_{W}$= gas constant for water vapor}gas
constant for water vapor\index{gas constant!water vapor}  
$R_{E}$ = \sindex[lis]{Re@$R_{E}$= radius of the Earth}radius of
the Earth\index{radius of the Earth} = 6.371229$\times 10^{6}$m\ \ $^{(f)}$\footnote{ discussed
in \prettyref{sec:INS}}  
$c_{p}$ = \sindex[lis]{cp@$c_{p}$ or $c_{pd}$ = specific heat of dry air at constant pressure}specific
heat of dry air at constant pressure\index{specific heat!dry air!constant pressure}
= $\frac{7}{2}R_{d}$ = 1.00473$\times10^{3}$ J\ kg$^{-1}$K$^{-1}$\ \ $^{(g)}$\footnote{}  
$c_{v}$ = \sindex[lis]{cv@$c_{v}$ or $c_{vd}$ = specific heat of dry air at constant volume}specific
heat of dry air at constant volume\index{specific heat!dry air!constant volume}
= $\frac{5}{2}R_{d}$ = 0.71766$\times 10^{3}$ J\ kg$^{-1}$K$^{-1}$  
\ \ \ \ \ *(specific heat values are at 0$^{\circ}$C; small variations
with temperature are not included here)*  
$\gamma$ = \sindex[lis]{gamma or gamma_{d} = ratio of specific heats of air, c_{p}/c_{v}@$\gamma$ or $\gamma_{d}$ = ratio of specific heats of air, $c_{p}/c_{v}$}ratio
of specific heats\index{specific heat ratio, dry air}, $c_{p}/c_{v}$,
taken to be 1.4 (dimensionless) for dry air  
$\Omega$ = \sindex[lis]{Omega= angular rotation rate of the Earth@$\Omega$= angular rotation rate of the Earth}angular
rotation rate of the Earth\index{Earth, angular rotation rate} =
7.292115$\times10^{-5}$ radians/s  
$\Omega_{Sch}$ = \sindex[lis]{Omega_{Sch}= angular frequency of the Schuler oscillation@$\Omega_{Sch}$= angular frequency of the Schuler oscillation}angular
frequency of the Schuler oscillation\index{Schuler oscillation} =
$\sqrt{\frac{g}{R_{E}}}$  
$\sigma$ = \sindex[lis]{sigma= Stephan-Boltzmann constant@$\sigma$= Stephan-Boltzmann constant}Stephan-Boltzmann
Constant\index{Stephan-Boltzmann Constant} = 5.6704$\times10^{-8}$W\ m$^{-2}$K$^{-4}$\ \ $^{(e)}$  
```{r include = TRUE, echo = FALSE, eval = FALSE, results = 'asis'}
cat('$g$ = \\label{-constant-g}\\sindex[lis]{g@$g$= acceleration of gravity}acceleration
of gravity\ \ $^{(a)}$\\footnote{ } at latitude $\\lambda$ \\sindex[lis]{lambda@$\\lambda$=latitude}and
altitude\\sindex[lis]{z@$z$ = height} $z$ above the WGS-84 \\index{WGS-84 geoid}geoid,\ \ $^{(b)}$\\footnote{}', '\\',
'\\begin{align}',
'g(z,\\lambda)=g_{e}\\left(\\frac{1+g_{1}\\sin^{2}(\\lambda)}{(1-g_{2}\\sin^{2}\\lambda)^{1/2}}\\right)(1-(k_{1}-k_{2}\\sin^{2}(\\lambda))z+k_{3}z^{2})  ',
'\\ \\ \\ \\ \\ (1.1)  ',
'\\end{align}',
'\\ \\ \\ \\ \\ \\ \\ where $g_{e}=9.780327$\ m\ s$^{-2}$, $g_{1}=0.00193185$, $g_{2}=0.00669438$, and<br>
\\ \\ \\ \\ \\ \\ \\  {$k_{1},k_{2},k_{3}$} = {3.15704$\\times 10^{-7}\\mathrm{m}^{-1}$,
2.10269$\\times 10^{-9}\\mathrm{m}^{-1}$, 7.37452$\\times 10^{-14}\\mathrm{m}^{-2}$}',
'<br>$T_{0}$ = temperature in kelvin\\sindex[lis]{T0@$T_{0}$=273.15\ K, temperature in kelvin corresponding to $0^{\\circ}$C} corresponding to $0^{\\circ}$C = 273.15\ K',
'<br>$T_{3}$ = temperature\\sindex[lis]{T3@$T_{3}$= triple point temperature of water}
corresponding to the triple point of water\\index{triple point of water}
= 273.16\ K',
'<br>',
'$M_{d}$ = \\sindex[lis]{Md@$M_{d}$= molecular weight of dry air}molecular
weight of dry air$^{(a)}$\\index{molecular weight!dry air}, 28.9637
kg\ kmol$^{-1}\ \ $^{(c)}$\\footnote{}<br>',
'$M_{w}$ = \\sindex[lis]{Mw@$M_{w}$= molecular weight of water}molecular
weight of water\\index{molecular weight!water}, 18.0153 kg\ kmol$^{-1}$\ \ $^{(d)}$\\footnote{}',
'<br>$R_{0}$ = \\sindex[lis]{R@$R_{0}$= universal gas constant}universal
gas constant$^{a}$\\index{universal gas constant}\\index{gas constant!universal}
= 8.314472$\\times 10^{3}$ J\ kmol$^{-1}$K$^{-1}$\ \ $^{(e)}$\\footnote{\\label{fn:2006-CODATA}}
<br>$N_{A}$ = Avogadro constant = 6.022141$\\times 10^{26}$ molecules\ kmol$^{-1}$\\index{Avogadro constant}\\sindex[lis]{NA@$N_{A}$ = Avogadro constant, molecules per kmol}<br>',
'$k=R_{0}/(\\mathrm{N_{A})}=1.38065\\times10^{-23}\\mathrm{J}\\,\\mathrm{K}^{-1}$\\sindex[lis]{k@$k$=Boltzmann Constant}\\index{Boltzmann constant}',
'<br>$R_{d}=(R_{0}/M_{d}$) = \\sindex[lis]{Rd@$R_{d}=$gas constant for dry air}gas
constant for dry air\\index{gas constant!dry air}<br>',
'$R_{w}$ = ($R_{0}/M_{w})$ = \\sindex[lis]{Rw@$R_{W}$= gas constant for water vapor}gas
constant for water vapor\\index{gas constant!water vapor}<br>',
'$R_{E}$ = \\sindex[lis]{Re@$R_{E}$= radius of the Earth}radius of
the Earth\\index{radius of the Earth} = 6.371229$\\times 10^{6}$m\ \ $^{(f)}$\\footnote{ discussed
in \\prettyref{sec:INS}}<br>',
'$c_{p}$ = \\sindex[lis]{cp@$c_{p}$ or $c_{pd}$ = specific heat of dry air at constant pressure}specific
heat of dry air at constant pressure\\index{specific heat!dry air!constant pressure}
= $\\frac{7}{2}R_{d}$ = 1.00473$\\times10^{3}$ J\ kg$^{-1}$K$^{-1}$\ \ $^{(g)}$\\footnote{}<br>',
'$c_{v}$ = \\sindex[lis]{cv@$c_{v}$ or $c_{vd}$ = specific heat of dry air at constant volume}specific
heat of dry air at constant volume\\index{specific heat!dry air!constant volume}
= $\\frac{5}{2}R_{d}$ = 0.71766$\\times 10^{3}$ J\ kg$^{-1}$K$^{-1}$<br>',
'\\noindent\\parbox[t]{1\\textwidth}{%
\\hskip0.6cm(specific heat values are at 0$^{\\circ}$C; small variations
with temperature are not included here)%
}<br>',
'$\\gamma$ = \\sindex[lis]{gamma or gamma_{d} = ratio of specific heats of air, c_{p}/c_{v}@$\\gamma$ or $\\gamma_{d}$ = ratio of specific heats of air, $c_{p}/c_{v}$}ratio
of specific heats\\index{specific heat ratio, dry air}, $c_{p}/c_{v}$,
taken to be 1.4 (dimensionless) for dry air<br>',
'$\\Omega$ = \\sindex[lis]{Omega= angular rotation rate of the Earth@$\\Omega$= angular rotation rate of the Earth}angular
rotation rate of the Earth\\index{Earth, angular rotation rate} =
7.292115$\\times10^{-5}$ radians/s<br>
$\\Omega_{Sch}$ = \\sindex[lis]{Omega_{Sch}= angular frequency of the Schuler oscillation@$\\Omega_{Sch}$= angular frequency of the Schuler oscillation}angular
frequency of the Schuler oscillation\\index{Schuler oscillation} =
$\\sqrt{\\frac{g}{R_{E}}}$<br>
$\\sigma$ = \\sindex[lis]{sigma= Stephan-Boltzmann constant@$\\sigma$= Stephan-Boltzmann constant}Stephan-Boltzmann
Constant\\index{Stephan-Boltzmann Constant} = 5.6704$\\times10^{-8}$W\ m$^{-2}$K$^{-4}$\ \ $^{(e)}$'
)
```
```{r echo=FALSE}
## get the values for the table in footnote (c):
fnc <- matrix(c('N~2~', 0.78102, 28.01340, 21.87903, 'O~2~', 0.20946, 31.99880, 6.70247,
                'Ar', 0.00916, 39.94800, 0.36592, 'CO~2~', 0.00033, 44.00950, 0.01452))
dim(fnc) <- c(4,4)
fnc <- as.data.frame(t(fnc))
names(fnc) <- c('Gas', 'mole fraction x', 'molecular weight M', 'x*M')
meanValue <- round(sum(as.numeric(fnc[, 4])), 4)
```
\_\_\_\_\_\_\_\_\_\_<br>
^(a)^ The International Standard Atmosphere specifies $g=9.80665$ m s^-2^,
$M_{w}$=28.9644 and $R_{0}$ = 8.31432x10^3^ J kmol^-1^K^-1^,
so these values are used to calculate pressure altitude.  
^(b)^ cf. Moritz, H., 1988: Geodetic Reference System 1980, Bulletin Geodesique,
Vol. 62 , no. 3, and [this link](http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf).    
^(c)^ Jones, F. E., 1978: J. Res. Natl. Bur. Stand., 83(5), 419, as quoted
by Lemmon, E. W., R. T. Jacobsen, S. G. Penoncello, and D. G., Friend,
J. Phys. Chem. Ref. Data, Vol. 29, No. 3, 2000, pp. 331-385. The quoted
values of mole fraction are from Jones (1978) and the calculation of mean
molecular weight is shown in the following table
using values of molecular weights
taken from the NIST Standard Reference Database 69: NIST Chemistry
WebBook as of March 2011. With CO~2~ about 0.00041 (as in 2020) and others
decreased proportionately, the mean is 28.9640.
```{r include = TRUE, echo = FALSE}
knitr::kable(fnc, format = 'html', caption = 'Calculation of the mean molecular weight of air',
             table.attr = "style='width:70%;'")
```
\ \ \ \ \ \ \ \ \ \ The mean value is `r meanValue`, but see above for a more modern adjustment.<br><br>
^(d)^ NIST Standard Reference Database 69: NIST Chemistry WebBook as of
March 2011.<br>
^(e)^ 2006 CODATA  
^(f)^ matching the value used by the inertial reference systems, as discussed 
in the "INS" section.  
^(g)^ The specific heat of dry air at 1013 hPa and 250--280 K as given
by Lemmon et al. (2000) is 29.13 J/(mol-K), which translates to $1005.8\pm 0.3$
J/(kg-K). However, the uncertainty limit associated with values of
specific heat is quoted as 1%, and the experimental data cited in
that paper show scatter that is at least comparable to several tenths
percent, so the ideal-gas value cited here is well within the range
of uncertainty. For this reason, and because this value is in widespread
use, the ideal-gas value is used throughout the algorithms described
here.

```{r include = FALSE, echo = FALSE, eval = FALSE, results = 'asis'}
cat(

'\\begin{center}
\\begin{tabular}{|c|c|c|c|}
\\hline 
Gas & mole fraction $x$ & molecular weight $M$ & $x*M$\\tabularnewline
\\hline 
\\hline 
N$_{2}$ & 0.78102 & 28.01340 & 21.87903\\tabularnewline
\\hline 
O$_{2}$ & 0.20946 & 31.99880 & 6.70247\\tabularnewline
\\hline 
Ar & 0.00916 & 39.94800 & 0.36592\\tabularnewline
\\hline 
CO$_{2}$ & 0.00033 & 44.00950 & 0.01452\\tabularnewline
\\hline 
Mean: &  &  & 28.96194\\tabularnewline
\\hline 
\\end{tabular}
\\par\\end{center}}<br>
$M_{w}$ = \\sindex[lis]{Mw@$M_{w}$= molecular weight of water}molecular
weight of water\\index{molecular weight!water}, 18.0153 kg\\,kmol$^{-1}$~~~\\footnote{NIST Standard Reference Database 69: NIST Chemistry WebBook as of
March 2011}<br>
$R_{0}$ = \\sindex[lis]{R@$R_{0}$= universal gas constant}universal
gas constant$^{a}$\\index{universal gas constant}\\index{gas constant!universal}
= 8.314472$\\times10^{3}$ J\\,kmol$^{-1}$K$^{-1}$~~~\\footnote{\\label{fn:2006-CODATA}2006 CODATA}<br>
$N_{A}$ = Avogadro constant = 6.022141$\\times10^{26}$~molecules
kmol$^{-1}$\\index{Avogadro constant}\\sindex[lis]{NA@$N_{A}$ = Avogadro constant, molecules per kmol}<br>
$k=R_{0}/(\\mathrm{N_{A})}=1.38065\\times10^{-23}\\mathrm{J}\\,\\mathrm{K}^{-1}$\\sindex[lis]{k@$k$=Boltzmann Constant}\\index{Boltzmann constant}<br>
$R_{d}=(R_{0}/M_{d}$) = \\sindex[lis]{Rd@$R_{d}=$gas constant for dry air}gas
constant for dry air\\index{gas constant!dry air}<br>
$R_{w}$ = ($R_{0}/M_{w})$ = \\sindex[lis]{Rw@$R_{W}$= gas constant for water vapor}gas
constant for water vapor\\index{gas constant!water vapor}<br>
$R_{E}$ = \\sindex[lis]{Re@$R_{E}$= radius of the Earth}radius of
the Earth\\index{radius of the Earth} = 6.371229$\\times$10$^{6}$
m ~~~\\footnote{matching the value used by the inertial reference systems discussed
in \\prettyref{sec:INS}} \\\\
$c_{p}$ = \\sindex[lis]{cp@$c_{p}$ or $c_{pd}$ = specific heat of dry air at constant pressure}specific
heat of dry air at constant pressure\\index{specific heat!dry air!constant pressure}
= $\\frac{7}{2}R_{d}=$1.00473$\\times10^{3}$ J$\\,$kg$^{-1}$K$^{-1}$~~~\\footnote{The specific heat of dry air at 1013 hPa and 250--280 K as given
by Lemmon et al. (2000) is 29.13 J/(mol-K), which translates to 1005.8$\\pm0.3$
J/(kg-K). However, the uncertainty limit associated with values of
specific heat is quoted as 1\\%, and the experimental data cited in
that paper show scatter that is at least comparable to several tenths
percent, so the ideal-gas value cited here is well within the range
of uncertainty. For this reason, and because this value is in widespread
use, the ideal-gas value is used throughout the algorithms described
here.}\\\\
$c_{v}$ = \\sindex[lis]{cv@$c_{v}$ or $c_{vd}$ = specific heat of dry air at constant volume}specific
heat of dry air at constant volume\\index{specific heat!dry air!constant volume}
= $\\frac{5}{2}R_{d}=$0.71766$\\times10^{3}$ J$\\,$kg$^{-1}$K$^{-1}$\\\\
\\noindent\\parbox[t]{1\\textwidth}{%
\\hskip0.6cm(specific heat values are at 0$^{\\circ}$C; small variations
with temperature are not included here)%
}\\\\
$\\gamma$ = \\sindex[lis]{gamma or gamma_{d} = ratio of specific heats of air, c_{p}/c_{v}@$\\gamma$ or $\\gamma_{d}$ = ratio of specific heats of air, $c_{p}/c_{v}$}ratio
of specific heats\\index{specific heat ratio, dry air}, $c_{p}/c_{v}$,
taken to be 1.4 (dimensionless) for dry air\\\\
$\\Omega$ = \\sindex[lis]{Omega= angular rotation rate of the Earth@$\\Omega$= angular rotation rate of the Earth}angular
rotation rate of the Earth\\index{Earth, angular rotation rate} =
7.292115$\\times10^{-5}$ radians/s\\\\
$\\Omega_{Sch}$ = \\sindex[lis]{Omega_{Sch}= angular frequency of the Schuler oscillation@$\\Omega_{Sch}$= angular frequency of the Schuler oscillation}angular
frequency of the Schuler oscillation\\index{Schuler oscillation} =
$\\sqrt{\\frac{g}{R_{E}}}$\\\\
$\\sigma$ = \\sindex[lis]{sigma= Stephan-Boltzmann constant@$\\sigma$= Stephan-Boltzmann constant}Stephan-Boltzmann
Constant\\index{Stephan-Boltzmann Constant} = 5.6704$\\times10^{-8}$W\\,m$^{-2}\\mathrm{K}^{-4}$~~$^{e}$%')
```
</blockquote>
----

<!--chapter:end:constants.Rmd-->


<p class=box>
VCRH = frost point inside the cryogenic hygrometer [$^{\circ}$C]    
CRHP = pressure inside the chamber of the cryogenic hygrometer [hPa]  
PSXC = reference ambient pressure [hPa]  
f$_{i}$ = enhancement factor (see Appendix C of Bulletin 9)  
$F_{1}$($T_{d}$) =Goff-Gratch formula for vapor pressure at dew
point $T_{d}$  
$F_{2}(T_{f})$ = Goff-Gratch formula for vapor pressure at frost
point $T_{f}$   
$T_{3}$ = temperature at the triple point of water = 273.16 K  
</p><p class=box2>
chamber vapor pressure $e_{ic}$ (hPa):  
\begin{equation}
e_{ic}=(6.1071\,\mathrm{mb})\times10^{A}  
(\#eq:DPCRCbox1)
\end{equation}  
where 
\begin{align}  
A=&-9.09718\left(\frac{T_{3}}{\mathrm{\{VCRH\}}+T_{3}}-1\right) \notag \\
+ & 3.56654\log_{10}\left(\frac{T_{3}}{\mathrm{\{VCRH\}}+T_{3}}\right) \notag \\
+ & 0.876793\left(1-\frac{\mathrm{\{VCRH\}}+T_{3}}{T_{3}}\right)
(\#eq:DPCRCbox2)
\end{align}  
The ambient vapor pressure $e_{a}$ (hPa) then is:  
\begin{equation}
e_{a}=e_{ic}\left(\frac{\mathrm{\{PSXC\}}}{\mathrm{\{CRHP\}}}\right)f_{i}
(\#eq:DPCRCbox3)
\end{equation}  
The ambient dew and frost points DPCRC and FPCRC are found iteratively by finding
the values that lead to $e_a$ in the Goff-Gratch equations:  
\begin{align}
e_{a} & = F_{1}\left(\mathrm{\{DPCRC\}}\right)\notag \\
 & = F_{2}\left(\mathrm{\{FPCRC\}}\right)
(\#eq:DPXRXbox4)
\end{align}
</p>  

<!--chapter:end:CRCDPbox.Rmd-->

<p class=box>
\{Cy$_{i}$\} = concentration\sindex[lis]{Cyi@$Cy_{i}$= concentration from hydrometeor probe y in channel i}
from probe y in channel i
\hspace*{0.6cm}(e.g., y=FSSP to calculate DBARF)  
i1 = lowest usable channel for the probe  
i2 = highest usable channel for the probe  
$d_{i}$\sindex[lis]{di@$d_{i}$= diameter of hydrometeor in channel $i$}
= diameter of particles in channel i for this probe ($\mu m$)  
\hspace*{0.6cm}(calculated as the average of the lower and upper
size limits for the channel)  
</p><p class=box2>
\begin{equation}
\mathrm{\{DBARx\}}=\frac{{\textstyle \sum_{i=i1}^{i2}}{\displaystyle {\displaystyle \left\{ \mathrm{Cy}_{i}\right\} d_{i}}}}{\sum_{i=i1}^{i2}\left\{ \mathrm{Cy}_{i}\right\} }
(\#eq:DBARbox)
\end{equation}
</p>  

<!--chapter:end:DBARbox.Rmd-->

<p class=box>
$d_{i}$ = diameter for channel $i$ of probe x  
\{Cy$_{i}$\}, i1, and i2 as for mean diameter above  
$Z_{r}$ \sindex[lis]{Zr@$Z_{r}$= scale factor for calculation of the radar reflectivity
factor}= reference factor for units = 1\ mm$^{6}$m$^{-3}$  
</p><p class=box2>
\begin{equation}
\mathrm{\{DBZx\}}=10\log_{10}\left({\textstyle \frac{1}{Z_{r}}\sum_{i=i1}^{i2}}{\displaystyle {\displaystyle \left\{ \mathrm{Cy}_{i}\right\} d_{i}^{6}}}\right)
(\#eq:DBZbox)
\end{equation}
</p>  

<!--chapter:end:DBZbox.Rmd-->

<p class=box>
\{DBARx\} = mean particle diameter [$\mu m$]  
\{Cy$_{i}$\}, i1, i2, $d_{i}$ as for mean diameter above    
</p><p class=box2>
\begin{equation}
\mathrm{\{DISPx\}}==\frac{1}{\{\mathrm{DBARx}\}}\,\left\{ \frac{{\textstyle \sum_{i=i1}^{i2}}{\displaystyle {\displaystyle \left\{ \mathrm{Cy}_{i}\right\} d_{i}^{2}}}}{\sum_{i=i1}^{i2}\left\{ \mathrm{Cy}_{i}\right\} }-\{\mathrm{DBARx}\}^{2}\right\} ^{1/2}
(\#eq:DISPbox)
\end{equation}
</p>  

<!--chapter:end:DISPbox.Rmd-->


<p class=box>
LON$_{ref}$ = reference longitude (º)  
LAT$_{ref}$ = reference latitude (º)  
$C_{deg2km}=$ conversion factor, degrees latitude to km\sindex[con]{conversion factor, degrees latitude to km} 
$\equiv$ 111.12 km / $^{\circ}$  
</p>
<p class=box2>
\begin{equation}
\begin{split}
\mathrm{DEI} = & \mathrm{C_{deg2km}}(\mathrm{\{LON\}}-\{\mathrm{LON}_{ref}\})\cos(\mathrm{\{LAT\}}) \notag \\ 
\mathrm{DNI} = & \mathrm{C_{deg2km}}(\mathrm{\{LAT\}}-\{\mathrm{LAT}_{ref}\})  
\end{split}
(\#eq:DNSEW)
\end{equation}
</p>

<!--chapter:end:DNSbox.Rmd-->


<p class=box>
$T_{p}$ = DPx from instrument x [$^{\circ}$C], or alternately  
RHO = water vapor density measurement
[$\mathrm{g\ }\mathrm{m}^{-3}$]; only one is used in any calculation  
ATX = reference ambient temperature [$^{\circ}C$]    
$T_{K}$=ATX+$T_{0}$\ $^{\dagger}$ = ambient temperature [K]   
$p$ = PSXC = reference ambient pressure [hPa]  
$p_{h}$ = CAVP\_x = pressure in instrument "x" housing [hPa]  
$e_{t}$ = intermediate vapor pressure used for calculation only  
$e$ = EWx = water vapor pressure from source x [hPa]  
$M_{w}$ = molecular weight of water$^{\dagger}$  
$R_{0}$ = universal gas constant$^{\dagger}$  
$f(p_{h},T_{p})$ = enhancement factor (cf. \@ref(eq:enhance))      
$F_{d}(e)$ = interpolation formula giving dew point temperature from water vapor pressure
</p><p class=box2>
For dew/frost point hygrometers, producing the measurement DPx:  
\ \ \ \ if DPx < 0$^\circ$C:  
\ \ \ \ \ \ \ \ obtain $e_{t}$ from \@ref(eq:MKi) using $T_{FP}$=DPx + $T_{0}$  
\ \ \ \ else (i.e., DPx $\geq 0^\circ$C):  
\ \ \ \ \ \ \ \ obtain $e_{t}$ from \@ref(eq:MKw)
using $T_{DP}=\mathrm{DPx}+T_{0}$  
\ \ \ \ correct $e_{t}$ for enhancement factor and internal pressure 
to get ambient vapor pressure $e$:  
\begin{equation}
e=f(p_{h},T_{P})\,(\frac{p}{p_{h}})\,e_t
(\#eq:ebox)
\end{equation}
\ \ \ \ obtain DPxC by finding the dew point corresponding to the
vapor pressure $e$:  
\begin{equation}
\mathrm{\{DPxC\}} = F_{d}(e) 
(\#eq:DPxCbox)
\end{equation}
- - - - - - - - - - - - - - - - - - - -    
For other instruments producing measurements of vapor density (RHO
[g\ m$^{-3}$]:^(a)^  
\ \ \ \ find the water vapor pressure in units of hPa:
\begin{equation}
e = (\mathrm{\{RHO\}}\,R_{0}\,T_{K}\,/\,M_{w})\times 10^{-5}
(\#eq:RHObox)
\end{equation}
\ \ \ \ find the equivalent dew point:  
\begin{equation}
\mathrm{\{DPxC\}} = F_{d}(e)
(\#eq:DPxC2)
\end{equation}
\_\_\_\_\_\_\_\_\_\_  
^(a)^ prior to 2011 the following formula was used:
$$Z=\frac{\ln((\mathrm{\{ATX\}}+273.15)\,\mathrm{\{RHO\}}}{1322.3}$$  
$$\mathrm{\{DPxC\}}=\frac{273.0\,Z}{(22.51-Z)}$$
</p>

<!--chapter:end:DPbox.Rmd-->

<p class=box2>
For air temperature $T < -50^\circ$C:  
\begin{align}
\mathrm{\{EDPC\}} &= 4.4685 + T(0.27347 + T (6.83811\times 10^{-3}\notag \\
&+ T(8.7094x10^{-5} + T(5.63513x10^{-7} + 1.47796 × 10^{-9}T)))
(\#eq:EDPC1)
\end{align}
For air temperature $T \ge -50^\circ$C:  
\begin{align}
\mathrm{\{EDPC\}} &= 6.107799961 + T(0.4436518521 + T(0.01428945805\notag \\
&+ T(2.650648471 × 10^{-4} + T(3.031240396 × 10^{-6}\notag \\
&+ T (2.034080948 × 10^{-8} + 6.136820929 × 10^{-11}T)))))
(\#eq:EDPC2)
\end{align}
</p>  

<!--chapter:end:EDPCbox.Rmd-->

<p class=box>
FSTROB = strobes generated by particles in the depth-of-field,     
\ \ \ \ \ \ \ \ \ \ per sample interval  
FRESET = ``fast resets'' generated per sample interval  
$t_{1}$ = slow reset time (for each strobe)  
$t_{2}$ - fast reset time (for each fast reset)  
</p><p class=box2>
\begin{equation}
\mathrm{\{FACT\}=\{FSTROB\}}\times t_{1}+\mathrm{\{FRESET\}}\times t_{2}
(\#eq:FACTbox)
\end{equation}
</p>  

<!--chapter:end:FACTbox.Rmd-->

<p class=box>
\{AFSSP\}$_{i}$ = valid particles sized in size interval i  
\{FSTROB\} = strobes generated by particles in the depth-of-field,  
\ \ \ \ \ \ \ \ \ \ \ \ \ \ per sample interval  
</p><p class=box2>
\begin{equation}
\mathrm{\{FBMFR\}=\{AFSSP\}/\{FSTROB\}}
(\#eq:FBMFRbox)
\end{equation}
</p>  

<!--chapter:end:FBMFRbox.Rmd-->

```{r child='boxStyles.Rmd'}
```

<p class=box>
PCN = pressure at the inlet to the CN counter [hPa]  
CNTEMP = temperature at the inlet of the sample tube [$^{\circ}$C]  
$p_{std}$ = \sindex[lis]{Pstd@$p_{std}$=standard pressure}standard
reference pressure, 1013.25\ hPa  
$T_{std}$ = \sindex[lis]{Tstd@$T_{std}$=standard temperature}standard
reference temperature, 294.15 K   
$T_{0}$ = 273.15\ K  
</p><p class=box2>
\begin{equation}
\mathrm{\{FCNC\} = \{FCN\}}\frac{p_{std}}{\mathrm{\{PCN\}}}\frac{(\{\mathrm{CNTEMP\}}+T_{0})}{T_{std}}
(\#eq:FCNCbox)
\end{equation}
</p>  

<!--chapter:end:FCNCbox.Rmd-->


<p class=box>
$H$ = aircraft altitude above mean sea level, [m] (GGALT)  
$\lambda$ = latitude (GGLAT) converted to radians    
$Z(H,\ \lambda)$ = aircraft geopotential height [m] (GEOPTH)  
$g_{0}$ = constant acceleration of gravity as defined for the International
Standard Atmosphere  
$g_{e},\,g_{1},\,g_{2},\,k_{i}$ as defined in the Table of Constants
on p.~ \pageref{constants-table},  
$\Delta$= height of the geoid above the WGS-84 reference ellipse
(GGEOIDHT)  
</p>
<p class=box2>  
\begin{equation}
\mathrm{GEOPHT\}}=Z(H,\lambda)=\frac{1}{g_{0}}\Biggl\{ g_{e}\left(\frac{1+g_{1}\sin^{2}\lambda}{(1-g_{2}\sin^{2}\lambda)^{1/2}}\right) \notag \\   
\times \left(H-\frac{1}{2}\left((H+\Delta)^{2}-\Delta^{2}\right)(k_{1}-k_{2}\sin^{2}\lambda)+\frac{1}{3}\left((H+\Delta)^{3}-\Delta^{3}\right)k_{3}\right)\Biggr\}  
(\#eq:GEOPHT)
\end{equation}
</p>


<!--chapter:end:GEOPTbox.Rmd-->



```{r echo = FALSE, include = TRUE, results = 'asis'}
library(kableExtra)
A <- data.frame(GGQUAL=c(0,1,2,5))
A$description=c('invalid', 'valid but without quality enhancement',
                'Measurement enhanced by the Satellite-Based Augmentation System, a means of improving GPS accuracy and integrity by broadcasting from geostationary satellites wide area corrections for GPS satellite orbits and ionospheric delays. In the US, this uses the Wide-Area Augmentation System or WAAS. This is described in some data files as a differential-GPS measurement.', 'Fully locked-in OmniSTAR XP, usually starting after about 20 minutes of tracking the GPS satellites and receiving the OmniSTAR data feed. This mode tracks the carrier phases of the L1 and L2 GPS carrier frequencies and provides about 15 cm accuracy in position.')
Ak <- kbl(A, align=c('c', 'l'), caption = "**Meaning of GGQUAL:**")
Ak %>% kable_styling(bootstrap_options = 'bordered') %>% scroll_box(width='80%')
```


<!--chapter:end:GGQUALbox.Rmd-->

<p class=box>
IRx = raw pyrgeometer output [W$\,$m$^{-2}$]  
$T_{D}$ = dome temperature [K]  
$T_{S}$ = ``sink'' temperature (approx.\ the thermopile temperature)
[K]  
$\epsilon$ = emissivity of the thermopile (dimensionless) = 0.986  
$\beta$ = empirical constant dependent on the dome type = 5.5  
$\sigma$ = Stephan-Boltzmann constant = 5.6704$\times10^{-8}$ W$\,$m$^{-2}$K$^{-4}$  
</p><p class=box2>
\begin{equation}
\mathrm{\{IRxC\}}=\mathrm{\{IRx\}}-\beta\sigma(T_{D}^{4}-T_{S}^{4})+\epsilon\sigma T_{S}^{4}
(\#eq:IRxTbox)
\end{equation}
</p>  

<!--chapter:end:IRxCbox.Rmd-->

<p class=box>
IRxHTV = voltage from a platinum resistance thermometer attached to the housing
of the pyrgeometer [V]  
{$a_4,\,a_5$} = calibration coefficients [$^\circ$C]  
$V_1$ = 1 V (for consistency of units)
</p><p class=box2>
\begin{equation}
\mathrm{\{IRxHT\}} = a_4 + a_5\,\log_{10}(\mathrm{\{IRxHTV\}}\,/\,V_1)
(\#eq:IRxHTbox)
\end{equation}
</p>  

<!--chapter:end:IRxHTbox.Rmd-->

<style>
  p.box {
    background-color: #F8F8F8;
      padding: 10px;
    border: 2px solid black;
    margin-left: 20px;
    margin-right: 20px;
    border-radius: 5px;
  }
</style>
  
  <style>
  p.box2 {
    background-color: #FFFFFF;
      padding: 10px;
    border: 2px solid red;
    margin-left: 10px;
    margin-right: 10px;
    border-radius: 1px;
  }
</style>
<p class=box>
LAT = latitude measured by the IRS  
LON = longitude measured by the IRS  
GGLAT = latitude measured by the GPS  
GGLON = longitude measured by the GPS  
VNSC = aircraft ground speed, north component, corrected  
VEWC = aircraft ground speed, east component, corrected  
</p><p class=box2>
**1.** Initialize the corrected position at the IRS position at the start of the flight or after
any large change (>5$^\circ$) in the IRS position.  <br><br>
**2.** Integrate forward from that position using the aircraft groundspeed with components
{VNSC,VEWC}. Note that in the absence of GPS information this will introduce
long-term errors because it does not account for the Earth’s spherical geometry. It
provides good short-term accuracy, but the GPS updating in the next step is needed to
compensate for the difference between a rectilinear frame and the Earth’s spherical
coordinate frame and provides a smooth yet accurate track.  <br><br>
**3.** Use an exponential adjustment to the GPS position, with time constant that is typi-
cally about 100 s.^(a)^  <br><br>
**4.** To handle periods when the GPS becomes invalid, use an approach analogous to that
for groundspeed, whereby a Schuler-oscillation fit to the difference between the GPS
and IRS measurements is accumulated and used to extrapolate through periods when
the GPS is invalid.  <br>
\_\_\_\_\_\_\_\_\_\_  
^(a)^ *specifically, LATC += η(GLAT-LATC) with η = 2π/(600 s)*
</p>

<!--chapter:end:LATLONbox.Rmd-->

<p class=box>
$d_{e,i}$\sindex[lis]{dei@$d_{e,i}$= equivalent melted diameter for channel i of a hydrometeor
spectrometer} = equivalent melted diameter for channel $i$ of probe x  
\{Cy$_{i}$\}, i1, i2 as for mean diameter above  
$\varrho_{w}$\sindex[lis]{rhow@$\rho_{w}$= density of liquid water}
= density of water [$10^{3}kg/m^{3}$]  
</p><p class=box2>
\begin{equation}
\mathrm{\{PLWCx\}}=\frac{\pi\varrho_{w}}{6}{\textstyle \sum_{i=i1}^{i2}}{\displaystyle {\displaystyle \left\{ \mathrm{Cy}_{i}\right\} d_{e,i}^{3}}}
(\#eq:LWCbox)
\end{equation}
(units and a scale factor are selected so that the output variable
is in units of g$\,$m$^{-3}$)
</p>  

<!--chapter:end:LWCbox.Rmd-->

```{r child='boxStyles.Rmd'}
```
<p class=box>
PSXC = ambient total air pressure. hPa   
EWX = ambient water vapor pressure, hPa  
$C_{kg2g}=10^{3}\,$g$\,$kg$^{-1}$ (conversion factor to give
final units of g$\,$kg$^{-1}$)  
$M_{w}=$molecular weight of water$^{\dagger}$  
$M_{d}=$molecular weight of dry air$^{\dagger}$  
</p><p class=box2>
\begin{equation}
\mathrm{\{MR\}}=C_{kg2g}\frac{M_{w}}{M_{d}}\frac{\mathrm{\{EWX\}}}{(\mathrm{\{PSXC\}-\{EWX\})}}
(\#eq:MR)
\end{equation}
</p>  

<!--chapter:end:MRbox.Rmd-->

<p class=box>
[ADIFR](#adifr) = attack differential pressure, radome [hPa]  
[QCF](#qcx) = uncorrected dynamic pressure [hPa]  
$A$ = (ADIFR/QCF) = $A_{f}+A_{s}$ where $A_{f}$ is the high-pass
and $A_{s}$ the low-pass component  
$e_{1},\,d_{0},\,d{}_{1},\,d_{2}$ = sensitivity
coefficients determined empirically; typically, for the GV,  
\ \ \ \ \ $e_{1}=21.481\,[^{\circ}]$   
\ \ \ \ \ $d_{1-3}$ = {$4.5253\,[^{\circ}]$, $19.9332\,[^{\circ}]$, $-0.00196099\,[^{\circ}\mathrm{hPa}^{-1}]$}  
</p><p class=box2>  
\begin{equation}
\mathrm{\{AKRD\}}=d_{0}+d_{1}A_{s}+d_{2}\mathrm{\{QCF\}_{s}+}e_{1}A_{f}
(\#eq:newAKRD)
\end{equation}
</p>  

<!--chapter:end:newAKRDbox.Rmd-->

<p class=box>
CPS\index{CPS=counts per second} = counts per second from the instrument  
[O$_{3}$]$_{wet}$ = ozone mixing ratio as measured in the sensing
cell (with water)  
[O$_{3}$]$_{dry}$ = ozone mixing ratio in dry air, corrected
for the effects of water vapor  
$S(t)$ = sensitivity at time t = (CPS when exposed to cal gas)
/ concentration of cal gas  
$Z(t)$ = background at time t = CPS when exposed to zero-ozone
air  
$r_v$ = water vapor mixing ratio by volume\sindex[lis]{rv@$r_{v}$=water vapor mixing ratio by volume}
[expressed as a fraction; dimensionless]  
$\kappa$ = correction factor for water vapor = 4.3 [dimensionless]  
</p><p class=box2>
\begin{equation}
[\mathrm{O}_{3}]_{wet}=\frac{\mathrm{\{CPS\}}-Z(t)}{S(t)}
(\#eq:O3box1)
\end{equation}
\begin{equation}
\mathrm{\{F03\_ACD\}}=[\mathrm{O_{3}}]_{dry} = \mathrm{[O_{3}]_{wet}}\times(1+\kappa r_{v})
(\#eq:O3box2)
\end{equation}
</p>

<!--chapter:end:O3box.Rmd-->

```{r child='boxStyles.Rmd'}
```
<p class=box>
$T_{0}^{\ddagger}$= 288.15 K, reference temperature  
$\lambda_{a}^{\ddagger}$ \sindex[lis]{lambdaa@$\lambda_{a}$= tropospheric lapse rate, standard atmosphere}=
-0.0065 $^{\circ}$C per geopotential meter = the lapse rate\index{International Standard Atmosphere!lapse rate} for the troposphere$^{\ddagger}$  
$p$ = measured static (ambient) pressure, hPa, usually from PSXC  
$p_{0}^{\ddagger}$\sindex[lis]{P0star@$p_{0}^{\ddagger}$= reference pressure for zero altitude,
ISA} = 1013.25 hPa, reference pressure for PALT=0 $^{\ddagger}$  
$M_{d}^{\ddagger}$ = 28.9644 kg/kmol = molecular weight of dry
air, ISA definition $^{\ddagger}$  
$g^{\ddagger}$ = 9.80665 m\ s$^{-2}$, acceleration of gravity $^{\ddagger}$  
$R_{0}^{\ddagger}$ = universal gas constant, defined$^{\ddagger}$
as 8.31432$\times10^{3}$ J\ kmol^-1^\ K^-1^      
$z_{T}^{\ddagger}$ = altitude of the ISA tropopause = 11,000 m $^{\ddagger}$  
$x=-R_{0}^{\ddagger}\lambda_{a}^{\ddagger}/(M_{d}^{\ddagger}g^{\ddagger})$
$\approx$ 0.1902632 (dimensionless)\footnote{This is the value, rounded to seven significant figures, that is used for data processing.}  
</p>
<p class=box2>

For pressure > 226.3206 hPa (equivalent to a pressure altitude < $z_{T}$):
\begin{equation}
\mathrm{PALT}=-\left(\frac{T_{0}^{\ddagger}}{\lambda^{\ddagger}}\right)\left(1-\left(\frac{p}{p_{0}^{\ddagger}}\right)^{x}\right)
(\#eq:PALT1)
\end{equation}  
otherwise, if $T_{T}$\sindex[lis]{Tt@$T_{T}$= temperature at the ISA tropopause}
and $p_{T}$\sindex[lis]{pT@$p_{T}$= pressure at the ISA tropopause}
are respectively the temperature and pressure at the altitude\index{International Standard Atmosphere!tropopause} $z_{T}$:  
$$T_{T}=T_{0}+\lambda^{\ddagger}z_{T}^{\ddagger}=216.65\,\mathrm{K}$$
$$p_{T}=p_{0}^{\ddagger}\Bigl(\frac{T_{0}^{\ddagger}}{T_{T}}\Bigr)^{\frac{g^{\ddagger}M_{d}^{\ddagger}}{\lambda^{\ddagger}R_{0}^{\ddagger}}}=226.3206\,\mathrm{hPa}$$
\begin{equation}
\mathrm{PALT}=z_{T}^{\ddagger}+\frac{R_{0}^{\ddagger}T_{T}}{g^{\ddagger}M_{d}^{\ddagger}}\ln\left(\frac{p_{T}}{p}\right)
(\#eq:PALT2)
\end{equation}  
which, after conversion from natural to base-10 logarithm, is coded
to be equivalent to the following:  
</p>
```{r class.source="box-out", echo=TRUE, include=TRUE, eval=FALSE, highlight=FALSE}
// transition pressure at the assumed ISA tropopause:
#define ISAP1 226.3206
// reference pressure for standard atmosphere:
#define ISAP0 1013.25
if (psxc > ISAP1):
 palt = 44330.77 * (1.0 - pow(psxc / ISAP0, 0.1902632));
else:
 palt = 11000.0 + 14602.12 * log10(ISAP1 / psxc);
```

<!--chapter:end:PALTbox.Rmd-->


<p class=box>
UPRESS = internal UHSAS pressure [kPa]\index{UPRESS}  
USMPFLW = measured volumetric sample flow [cm$^{3}$s$^{-1}$]  
PFLW = sample mass flow referenced to standard conditions [cm$^{3}$s$^{-1}$]  
$T_{blk}$ = UHSAS optical block temperature, 305 K  
$p_{std}$ = standard pressure, 1013.25 hPa  
$T_{std}$ = standard temperature, 298.15 K\index{UHSAS!STP}  
PSXC = corrected ambient pressure [hPa]  
ATX = ambient temperature [$^{\circ}$C]  
$T_{0}$ = 273.15\ K  
</p><p class=box2>  
\begin{equation}
\mathrm{\{PFLWC\}}=\mathrm{\{PFLW\}}\frac{p_{std}}{\mathrm{\{PSXC\}}}\frac{(\mathrm{\{ATX\}}+T_{0})}{T_{std}}  
(\#eq:PFLWCbox1)
\end{equation}
\begin{equation}
\mathrm{\{USFLWC\}}=\mathrm{\{USMPFLW\}}\frac{\mathrm{\{UPRESS/10\}}}{\mathrm{\{PSXC\}}}\frac{\mathrm{(\{ATX\}}+T_{0})}{T_{blk}}  
(\#eq:PFLWCbox2)
\end{equation}
</p>

<!--chapter:end:PFLWCbox.Rmd-->

```{r child='boxStyles.Rmd'}
```
<p class=box>
PLWC = total power dissipated by the probe [W]  
$P_{D}$ = power dissipated\index{King probe!power dissipated}\sindex[lis]{Power@$P$=power}
by the cooling effect of dry air alone  
$P_{W}$ = power needed to heat and vaporize the liquid water that
hits the probe element  
$L$ = length\sindex[lis]{L@$L$ =length (of a King-probe element)}
of the probe sensitive element\index{King probe!element dimensions},
typically 0.021\ m  
$d$= diameter\sindex[lis]{d@$d$=diameter} of the probe sensitive
element, typically 1.805$\times10^{-3}$m  
$T_{s}$= sensor temperature\index{King probe!sensor temperature}\sindex[lis]{Ts@$T_{s}$=temperature of a sensor}
[$^{\circ}$C]  
$T_{a}$= ambient temperature [$^{\circ}$C] = ATX  
$T_{b}$\sindex[lis]{Tb@$T_{b}$= boiling temperature of water} =
boiling temperature of water (dependent on pressure):   
\ \ \ \ \ \ \ \ \ with $x=\log_{10}(p/(1$hPa)), $B=1^{\circ}$C,  
\ \ \ \ \ \ \ \ \ and \{$b_{0},$ $b_{1}$, $b_{2}$, $b_{3}$\} = \{0.03366503, 1.34236135,
-0.33479451, 0.0351934\}:  
\ \ \ \ \ \ \ \ \ \ $T_{b}=B\times10^{(b_{0}+b_{1}x+b_{2}x^{2}+b_{3}x^{3})}$  
$T_{m}=(T_{a}+T_{s})/2$ = mean temperature for air properties  
$L_{v}(T_{b})$ = latent heat of vaporization of water\sindex[lis]{Lv@$L_{v}$=latent heat of vaporization of water}\index{latent heat of vaporization}
= (2.501-0.00237$T_{b}$)$\times10^{6}$J$\,$kg$^{-1}$  
$c_{w}$\sindex[lis]{cw@$c_{w}$= specific heat of liquid water} =
specific heat of water = 4190\ J$\,$kg$^{-1}$K$^{-1}$ (mean value,
0--90$^{\circ}$C)  
$U_{a}$ = true airspeed [m/s] = TASX  
$\lambda_{c}$\sindex[lis]{lambdac@$\lambda_{c}$= thermal conductivity, dry air}
= thermal conductivity\index{thermal conductivity|see {conductivity, thermal}}\index{conductivity!thermal}
of dry air (2.38+0.0071$T_{m}$)$\times10^{-2}$J$\,$m$^{-1}$s$^{-1}$K$^{-1}$  
$\mu$\sindex[lis]{mu_{a}= dynamic viscosity of air@$\mu_{a}$= dynamic viscosity of air}
=viscosity of air =\index{viscosity} (1.718+0.0049$T_{m})\times10^{-5}$
kg$\,$m$^{-1}$s$^{-1}$  
$\rho_{a}$\sindex[lis]{rhoa@$\rho_{a}$= density of air} = density
of air = $p / (R_{d}(T_{a}+T_{0}))$  
Re\sindex[lis]{Re= Reynolds number} = Reynolds number = $\rho_{a}U_{a}d/\mu_{a}$  
Nu\sindex[lis]{Nu= Nusselt number} = Nusselt Number relating conduction
heat loss to the total heat loss for dry air:  
<font size="2" family="tt">
\ \ \ \ \ typically Nu=$a_{0}\mathrm{Re}^{a_{1}}$ where  
\ \ \ \ \ for the GV:  
\ \ \ \ \ \ \ \ $\{a_{0},\,a_{1}\}=\{1.868,\,0.343\}$ for Re<7244   
\ \ \ \ \ \ \ \  and $\{0.135,\,0.638\}$ otherwise,  
\ \ \ \ \ \ \ \ except when TASX < 150 m/s;  
\ \ \ \ \ \ \ \ then use $\{0.133,\,0.382\}$.  
\ \ \ \ \ For the C-130:  
\ \ \ \ \ \ \ \ $\{a_{0},\,a_{1}\}=\{0.118,\,0.675\}$.
</font>  
$C_{kg2g}=1000$\sindex[lis]{Ckg2g@$C_{kg2g}$= conversion factor, g to kg} = grams per kilogram  
\ \ \ \ \ \ \ \ \ \ (unit conversion to conventional units for liquid water content)  
$\chi$ \sindex[lis]{chi@$\chi$=liquid water content}= liquid water
content [g/m$^{3}$] = PLWCC
</p><p class=box2>
\begin{equation}
\mathrm{\{PLWC\}} = P_{D}+P_{W}
(\#eq:PLWCa)
\end{equation}
where  
\begin{equation}
P_{D}=\pi\mathrm{Nu}\,L\lambda_{c}(T_{s}-T_{a})
(\#eq:PLWCb)
\end{equation}
\begin{equation}
P_{W}=L\,d[L_{v}(T_{b})+c_{w}(T_{b}-T_{a})]\,U_{a}\chi
(\#eq:PLWCc)
\end{equation}
*Result:*  
\begin{equation}
\mathrm{\{PLWCC\}}=\chi=\frac{C_{kg2g}(\mathrm{\{PLWC\}}-P_{D})}{L\,d\,U_{a}[L_{v}(T_{b})+c_{w}(T_{b}-T_{a})]}
(\#eq:PLWCd)
\end{equation}
</p>

<!--chapter:end:PLWCCbox.Rmd-->

```{r child='boxStyles.Rmd'}
```
<p class=box>
PSXC = ambient pressure [hPa]  
HGME = (radar) altitude above the surface [m]  
TVIR = virtual temperature [$^{\circ}\mathrm{C}$]  
PSURF = estimated surface pressure [hPa]  
$g$ = acceleration of gravity$^{\dagger}$  
$R_{d}$ = gas constant for dry air$^{\dagger}$  
$c_{pd}$ = specific heat of dry air at constant pressure$^{\dagger}$  
</p><p class=box2>
\begin{equation}
T_{m}=(\mathrm{\{TVIR\}}+T_{0})+0.5\mathrm{\{HGM\}}\frac{g}{c_{pd}}
(\#eq:Tm4PSURF)
\end{equation}
\begin{equation}
\mathrm{PSURF}=\mathrm{\{PSXC\}}\,\exp\left\{ \frac{g\,\{\mathrm{HGME}\}}{R_{d}T_{m}}\right\}
(\#eq:PSURF)
\end{equation}
</p>

<!--chapter:end:PSURFbox.Rmd-->

<p class=box>
$d_{i}$ = diameter for channel $i$ of probe x  
\{Cy$_{i}$\}, i1, and i2 as for mean diameter above  
</p><p class=box2>
\begin{equation}
\mathrm{\{REFFx\}}=\frac{1}{2}\frac{\sum{\displaystyle {\displaystyle \left\{ \mathrm{Cy}_{i}\right\} d_{i}^{3}}}}{\sum{\displaystyle {\displaystyle \left\{ \mathrm{Cy}_{i}\right\} d_{i}^{2}}}}
(\#eq:REFFbox)
\end{equation}
</p>  

<!--chapter:end:REFFbox.Rmd-->


<p class=box>
EWX = atmospheric water vapor pressure (hPa)  
ATX = ambient air temperature [$^{\circ}\mathrm{C}$]  
$T_{0}=273.15$ K  
$e_{s.i}(\mathrm{ATX+T_{0}})$ = equilibrium water vapor pressure
at *frostpoint* ATX (hPa)  
\ \ \ \ \ \ \ \ \ \ (see Eq.\ \@ref(eq:MKi) for the formula
used.)  
</p><p class=box2> 
\begin{equation}
\mathrm{\{RHUMI\}}=100\%\,\times\,\frac{\mathrm{\{EWX\}}}{e_{s,i}(\mathrm{\{ATX\}+T_{0}})}
(\#eq:RHUMI)
\end{equation}
</p>

<!--chapter:end:RHIbox.Rmd-->


<p class=box>
ATX = ambient temperature ($^{\circ}\mathrm{C}$)  
EWX = water vapor pressure, hPa  
$C_{mb2Pa}$= conversion factor, hPa to Pa} = 100 Pa\ hPa$^{-1}$ (conversion factor to MKS units)   
$C_{kg2g}=10^{3}\,\mathrm{g\,kg}^{-1}$ = (conversion
factor to give final units of g$\,$m$^{-3}$)  
$T_{0}$ = 273.15\,K
</p><p class=box2>
\begin{equation}
\mathrm{\{RHOx\}} = C_{kg2g}\frac{C_{mb2Pa}\mathrm{\{EWX\}}}{R_{w}\mathrm{(\{ATX\}+T_{0})}}
(\#eq:RHOx)
\end{equation}
</p>

<!--chapter:end:RHObox.Rmd-->


\newcommand{\pluseq}{\mathrel{+}\mathrel{\mkern-1mu}=}
<p class=box>
XUVI = output from the UV Hygrometer, after application of calibration
coefficients  
DPXC\index{DPXC} = corrected dewpoint from some preferred source,
$^{\circ}$C  
ATX\index{ATX} = preferred temperature, $^{\circ}$C  
RHODT\index{RHODT} =water vapor density determined by a chilled-mirror
sensor  
Tau = time constant for the exponential update (typically 300 s)  
</p><p class=box2>
For valid measurements (i.e., when DPXC $<$ ATX and XUVI and RHODT are not missing}:   
\begin{equation}
\mathrm{Offset}\pluseq (\mathrm{\{RHODT\}-\{XUVI\}-Offset})/Tau
(\#eq:RHOUVbox1)
\end{equation}
\begin{equation}
\mathrm{\{RHOUV\} = \{XUVI\} + Offset}
(\#eq:RHOUBbox2)
\end{equation}
</p>  

<!--chapter:end:RHOUVbox.Rmd-->


<p class=box>
EWX = atmospheric water vapor pressure (hPa)  
ATX = ambient air temperature [$^{\circ}\mathrm{C}$]  
$T_{0}=273.15$ K  
$e_{s.w}(\mathrm{ATX+T_{0}})$ = equilibrium water vapor pressure
at *dewpoint* ATX (hPa)  
\ \ \ \ \ \ \ \ \ \ (see Eq.\ \@ref(eq:MKw) for the formula
used.)  
</p><p class=box2>  
\begin{equation}
\mathrm{\{RHUM\}}=100\%\,\times\,\frac{\mathrm{\{EWX\}}}{e_{s,w}(\mathrm{\{ATX\}+T_{0}})}
(\#eq:RHUM)
\end{equation}
</p>

<!--chapter:end:RHUMbox.Rmd-->

<style>
p.box {
background-color: #F8F8F8;
padding: 10px;
border: 2px solid black;
margin-left: 20px;
margin-right: 20px;
border-radius: 5px;
}
</style>

<style>
p.box2 {
background-color: #FFFFFF;
padding: 10px;
border: 2px solid red;
margin-left: 10px;
margin-right: 10px;
border-radius: 1px;
}
</style>

<!-- \fbox{\begin{minipage}[t]{0.95\textwidth}% -->

<p class=box>  
$g^{\dagger}$ = acceleration of gravity (see Eq. \@ref(eq:gsublambda))  
$R_{d}{}^{\dagger}$ = gas constant for dry air  
$T_{K}$ = absolute temperature = (ATX + 273.15)  
$a$ = ACINS = upward acceleration as measured by the INS [m\ s^-2^]  
$p$ = PSXC = measured ambient pressure [hPa]  
$\Delta p$ = difference between current and last value of PSXC  
$\Delta t$ = time between samples (1/$f$ where $f$ is the sample
frequency)  
$F_{L}$ = low-pass Butterworth filter (cf.\ p.\ \pageref{compFilter}).  
</p><p class=box2>
\ 1. From consecutive measurements of pressure, estimate the rate of climb
from the hydrostatic equation:  
\begin{equation}
w_{p}=-\frac{R_{d}T_{k}}{gp}\frac{\Delta p}{\Delta t}
(\#eq:wphe)  
\end{equation}  
\ 2. Add the current measurement of acceleration to the cumulative sum:
\begin{equation}
w_{p}^{*}\leftarrow w_{p}^{*}+a\Delta t
(\#eq:wpstar)
\end{equation}  
\ 3. Define ROC as the sum of $w_{p}^{*}$ and the low-pass filtered value
of ($w_{p}-w_{p}^{*}$):  
\begin{align}
\mathrm{ROC} & =w_{p}^{*}+F_{L}(w_{p}-w_{p}^{*})
(\#eq:ROC)  
\end{align}
</p>
  

<!--chapter:end:ROCbox.Rmd-->


<p class=box>
A = \sindex[lis]{A=area}effective surface area of the probe [m$^{2}$]  
$\Delta t$ = time interval\sindex[lis]{Deltat@$\Delta t$=time interval}\sindex[lis]{t@$t$=time}
during which an increment of mass accretes [s]  
$\Delta m$ = mass\sindex[lis]{m@$m$=mass} of ice accreted on the
probe in the time interval $\Delta t$ [g]  
$U_{a}$ = true airspeed [m/s]  
</p><p class=box2>
\begin{equation}
\mathrm{\{SCLWC\}}=A\,U_{a}\frac{\Delta m}{\Delta t}
(\#eq:SCLWCbox)
\end{equation}
</p>  

<!--chapter:end:SCLWCbox.Rmd-->

# Introduction

## Background Information

This technical report defines the variables used in data sets that are collected by the research aircraft operated by the Research Aviation Facility (RAF) of the National Center for Atmospheric Research. Where appropriate, it also documents the equations that are used by the processing software (currently “nimbus”) to calculate the derived measurements that result from the use of one or more other basic measurements (e.g., potential temperature). Since 1993, data from research flights have been archived in NetCDF format (cf. <a href="http://www.unidata.ucar.edu/software/netcdf/docs/">http://www.unidata.ucar.edu/software/netcdf/docs/</a>), and the NetCDF header for recent projects includes detailed information on the measurements present in the file, how they depend on other measurements, units, etc. The conventions that the RAF uses for NetCDF data files are documented at <a href=" http://www.eol.ucar.edu/raf/Software/netCDF.html "> http://www.eol.ucar.edu/raf/Software/netCDF.html </a>.  

This document should change as changes in processing algorithms are implemented, but the intent is also to provide a history of algorithms that have been used, so there is an effort to document how historical data files were processed along with the descriptions of current algorithms. Unlike some technical reports, this document is likely to change over time and should provide a history extending back to <a href="https://opensky.ucar.edu/islandora/object/archives%3A8729">RAF Bulletin 9</a>, which documented the processing algorithms as they existed before about 2003.  

Currently, the data acquisition process on the research aircraft of the Research Aviation Facility, Earth Observing Laboratory, proceeds as follows:  

1. Analog or digital outputs from instruments are sampled at regular intervals, typically 50 Hz when possible. Analog outputs are converted to digital values via analog-to-digital converters. The investigators' handbooks for each aircraft describe this process in detail, including resolution of the sampling and handling of the results. Often, signals from user-supplied instruments are also included in the measured values that are handled by the data system.  
2. The digital outputs are then recorded by the data system on the aircraft. Currently, this is a task of the ["NIDAS"](http://www.eol.ucar.edu/data/software/nidas) system described below. That system also controls the sampling, time stamps, and other aspects of data recording.  
3. In flight, the data are processed by the *“nimbus”* data processing program, which makes them available for display via ["aeros"](http://www.eol.ucar.edu/raf/Software/aeros_dnld.html) for real-time monitoring of measurements.  
4. Following the flight, *nimbus* again processes the data. At this stage, measurements can be re-sampled with averaging and/or interpolation to produce various data rates, usually 1 Hz or 25 Hz, and known lags in measurements can be introduced to adjust measurements to a common time basis. As part of this processing, *nimbus* applies calibration coefficients where appropriate to convert recorded values (e.g., voltage) to engineering units (e.g., $^\circ$C). Determining or checking these calibration coefficients is part of the pre-flight and post-flight procedures for each project.  
5. The output from *nimbus* is the data file that is the permanent archive from the experiment, often after merging in additional data sets from users that are not recorded in the original data file produced by *NIDAS.* These files, in NetCDF format, have headers that contain metadata on each measurement (such as the calibration coefficients, the instrument that produced the measurement, etc.). Many of the variables in these files are discussed in this technical note, but the files may also include additional project-specific measurements for which the NetCDF header and the project reports will be the only documentation.  

For assistance accessing data from RAF-supported projects, contact the RAF data management group via <a href="mailto:raf-dm%40eol.ucar.edu">this email address</a>.  

```{r include = TRUE, echo = FALSE}
## construct data.frame for the following table:
DSYS <- data.frame("Data System" = c('ADS I', 'ADS II', 'ADS III (NIDAS)^[ADS III is the name given to the full data system, which includes these components: NIDAS (for data acquisition and recording); NIMBUS (for data processing, both in flight and after the flight); AEROS (for data display in flight); and the Mission Coordinator Station and satellite communications system (for transmission of data to and from the aircraft, display of such data for mission decisions, and support for written “chat” communications among project participants both on the aircraft and on the ground).]'))
DSYS$start <- c('1984', '1992', '2005')
DSYS$end <- c('1992', '2007', ' ')
DSYS$aircraft <- c('King Air 200T, Sabreliner (1987), Electra (1991)', 'C-130', 'GV, C-130 after 2007')
```
The data system has changed several times over the history of RAF. For a discussion of the history of the data systems, see [this note](https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/ADSHistory.pdf) written by Richard Friesen. The versions of data systems that produced most of the data still available were, approximately, as given in the following table: 
```{r include = TRUE}
knitr::kable(DSYS, align=c('cccl')) %>% kable_styling(bootstrap_options = 'bordered') %>%
  scroll_box(width='80%')
```
  
Before 1993, data were processed by a different program, “GENPRO,” and a different output format (also named GENPRO) was used for archived datasets. Appendix E in [RAF Bulletin 9](https://opensky.ucar.edu/islandora/object/archives%3A8729), the previous description of RAF data products that is now superseded by this technical note, describes that format. Some variable names in this document, esp. in section \@ref(obsolete-variables), refer to obsolete variable names, some used with GENPRO and others referring to instruments that are now retired. These names are included here so that this report can be a reference for older archived data as well as for current data files.  

## Alphabetical List of Variables

At the end of this document, there is a list of all the variable names that appear in standard data files along with links to the primary discussion of those variables; see [Appendix B](/rmd_output/1/appendix-b-variable-names.html#variable-names). In some cases redundant measurements are present, often for key measurements like pressure or temperature. When these are used in subsequent calculation of derived variables like potential temperature, some choice is usually made regarding which measurement is considered most reliable for a particular project or flight, and a single derived variable is calculated on the basis of the chosen input variable(s). To record which measurements were so designated, a reference measurement chosen from a group of redundant measurements usually has a variable name ending with the letter(s) X or XC.^[Some that do not follow this convention are ATTACK and SSLIP; see the individual descriptions that follow.] 
To see the variables in a particular netCDF data file, use the command “ncdump -h file.nc”.  

## Constants and Symbols {#constants-and-symbols}

The following table contains values used for some constants in this document. For reference, the symbols used here and elsewhere in this document are defined in the List of Symbols near the end of the document (cf.\ [Appendix A](/rmd_output/1/appendix-a-list-of-symbols.html#list-of-symbols)). Where references are to the “NIST Chemistry WebBook”, the associated URL is <a href="http://webbook.nist.gov">http://webbook.nist.gov</a>. References to the CODATA Internationally recommended values of the Fundamental Physical Constants are available at <a href="http://physics.nist.gov/.cuu/.Constants">http://physics.nist.gov/.cuu/.Constants</a>. The optimization involved in adjustment of these coefficients is documented in [Mohr et al., 2008a](https://physics.nist.gov/cuu/pdf/RevModPhys_80_000633acc.pdf) and 2008b, referenced at that URL.^[P. J. Mohr, B. N. Taylor, and D. B. Newell, Rev. Mod. Phys 80(2), 633-730(2008); P. J. Mohr, B. N. Taylor, and D. B. Newell, J. Phys. Chem. Ref. Data 37(3), 1187-1284(2008).] 
In this technical note, references to these symbols will often have these symbols or definitions marked by the symbol $^\dagger$ to indicate that the values used are the standard ones in the following table.  

```{r child='constants.Rmd'}
```
  

<!--chapter:end:Section1.Rmd-->

# Obsolete Variables {#obsolete-variables}

<p>RAF retired the “GENPRO” processor, the software program previously used to produce data sets, in 1993, but data files produced by that processor are still retained and available for use. Also, there are some instruments that are now retired but provided measurements in some archived data files. Obsolete variable names that are associated only with GENPRO or a retired instrument are discussed below, for reference and to facilitate use of old data files.</p>

#### Unaltered Tape Time (s): TPTIME {-#tptime}

This variable is derived by converting the HOUR, MINUTE and SECOND to elapsed seconds after midnight of the current day. If time increments to the next day, its value is not reset to zero, but 86400 seconds are added to produce ever-increasing values for the data set.</p>

#### Processor Time (s): PTIME {-#ptime}

This is an internal time variable created by the GENPRO processor. It represents elapsed seconds after midnight. It differs from TPTIME in that, after it has been set at the beginning of the data set, it is incremented internally for each second of data processed. If duplicate or missing raw data records exist, it can differ from TPTIME. It is guaranteed to be a monotonically increasing and continuous series of values.</p>

#### INS: Data System Time Lag (s): TMLAG {-#tmlag}

TMLAG is the amount of time between the reference time of a Litton LTN-5l Inertial Navigation System (INS) and the data system clock, in seconds. TMLAG will always be greater than zero and less than 2.</p>
 
#### LORAN-C Variables: {-#loranc}

<strong> Latitude and Longitude (</strong><span class="math inline">º</span><strong>): CLAT, CLON</strong><br />
<strong>Circular Error of Probability (n mi): CCEP</strong><br />
<strong>Ground Speed (m/s): CGS</strong><br />
<strong>Status: CSTAT</strong><br />
<strong>Time (s): CSEC</strong><br />
<strong>Fractional Time (s): CFSEC</strong></p>

Before the advent of GPS, NCAR/RAF operated a LORAN-C receiver that provided information on the position and groundspeed of the aircraft. The measurements of latitude and longitude from this system are CLAT and CLON, measured at 1 Hz and with positive values of longitude to the east and positive values of latitude to the north. and CCEP provides an estimate of the uncertainty in those measurements (in units of nautical miles). A status word, CSTAT, was used to record a value of 15 when the system was operational. The ground speed and reference times were also recorded in the above corresponding variables. The sum of CSEC and CFSEC represented the time of the measurement, which was not always the time in the data file when the measurements were recorded.

#### LTN-51 Variables: {-#ltn51}

<p><strong>INS Latitude (</strong><span class="math inline">º</span><strong>):</strong> <strong><span class="underline">ALAT</span></strong><br />
<strong>INS Longitude (</strong><span class="math inline">º</span><strong>):</strong> <strong><span class="underline">ALON</span></strong><br />
<strong>Raw INS Ground Speed X Component (m/s):</strong> <strong><span class="underline">XVI</span></strong><br />
<strong>Raw INS Ground Speed Y Component (m/s):</strong> <strong><span class="underline">YVI</span></strong><br />
<strong>Raw INS True Heading (</strong><span class="math inline">º</span><strong>):</strong> <strong><span class="underline">THI</span></strong><br />
<strong>INS Wander Angle (</strong><span class="math inline">º</span><strong>):</strong> <strong><span class="underline">ALPHA</span></strong><br />
<strong>INS Platform Heading (</strong><span class="math inline">º</span><strong>):</strong> <strong><span class="underline">PHDG</span></strong></p>

These variables from the Litton LTN-51 Inertial Navigation System (INS) are analogous to the modern variables discussed in Section\ \@ref(inertial-reference-systems) The measurements of latitude and longitude were provided with 1-Hz frequency and had a resolution of 0.0014<span class="math inline">º</span>, while the ground speed components were provided at 10 Hz and had resolution equal to 0.012 m/s. The X component of the ground speed was along the longitudinal axis of the aircraft <em>at the time of alignment,</em> and the Y axis was in the starboard direction at the time of alignment. PHDG recorded the orientation of the platform relative to true north, with resolution 0.0028<span class="math inline">º</span>. THI was the true heading of the aircraft, produced at 5 Hz with resolution of 0.0014<span class="math inline">º</span>. The “wander angle” is an INS-only variable that recorded the angle of the INS platform x-axis relative to its original orientation; it “wandered” in response to east-west motion of the aircraft on a spherical Earth.</p>

#### Raw Aircraft Vertical Velocity (m/s): VZI {-#vzi}

This is an integrated output from an up/down binary counter connected to the INS vertical accelerometer. Resolution is 0.012 m/s. Due to changes in local gravity and accumulated errors, this often develops a significant offset during flight.

#### Aircraft True Heading (</strong><span class="math inline">º</span><strong>): THF {-#thf}

This measurement of aircraft heading was derived from the angle between the horizontal projection of the aircraft center and true north: THF = PHDG + ALPHA. Resolution is 0.0028<span class="math inline">º</span>.</p>

#### Aircraft Ground Speed and East/North Components (m/s): GSF, VEW, VNS {-#gsf-obsolete}

These variables have the same names as the modern variables for ground speed. (Cf.\ Section\ \@ref(the-state-of-the-aircraft).) GSF is the magnitude of the ground speed determined by the INS, as derived from XVI and YVI:  
<p class=box2>
\begin{equation}
\mathrm{GSF=\sqrt{\{XVI\}^{2}+\{YVI\}^{2}}}
(\#eq:GSF)
\end{equation}
</p>

VEW and VNS are the east and north projections of this ground speed, derived using THF for the aircraft heading.

#### Wind Speed and Direction (m/s, <span class="math inline">º</span>): WSPD, WDRCTN {-#wspd}

These variables are calculated from UI and VI, the east and north components of the wind determined as described in RAF Bulletin No. 23 and summarized in Section\ \@ref(wind):<span id="punch:10-1" label="punch:10-1">[punch:10-1]</span></p>
<p class=box2>
\begin{align}
\mathrm{WS} = & \sqrt{\mathrm{\{UI\}^{2}+\{VI\}^{2}}} (\#eq:WSobs)\\
\mathrm{WD} = & \mathrm{\frac{180^{\circ}}{\pi}atan2(-\{UI\},}-\{VI\})+180^{\circ}
(\#eq:WDobs)
\end{align}
</p>

#### Raw Attack and Sideslip Force (Fixed Vane) (g): AFIXx, BFIXx {-#vanes}

AFIXx and BFIXx are amplified outputs from strain-gauges on fixed-vane sensors mounted at the end of a gust boom in the horizontal or vertical planes, respectively of the aircraft . The “force” on the vanes (calibrated in “equivalent grams” at Jefferson County Airport gravity) varies as a function of the aircraft attack or sideslip angles and dynamic pressure. Here x refers to left or right for AFIXx or top or bottom for BFIXx.
 
#### Attack Angle or Sideslip Angle (Fixed Vanes) (</strong><span class="math inline">º</span><strong>): AKFXx, SSFXx {-#akfxx}

AKFXx and SSFXx are the respective angles of attack and sideslip computed from AFIXx or BFIXx and QCx (either boom or gust dynamic pressure). An empirically derived function, HSSATK, is used to determine the attack pr sideslip angle based on wind tunnel test data.
 
#### Dynamic Pressure (Boom or Gust Probe) (mb): QCB or QCBC; QCG or QCGC {-#qcb}

These variables, measured by a differential pressure gauge, record the difference between a pitot (total) pressure and a static pressure. The QCBC and QCGC values are corrected for local flow-field distortion. The boom and gust probe measurements referred to the same aircraft structure. The different designations used for those measurements specified the transducer used and its location. In the gust probe dynamic pressure measurement (QCG), a Rosemount Model 1332 differential pressure transducer was located closer to the sensor in the gust probe itself, whereas in the boom measurement (QCB), a Rosemount Model 1221 pressure transducer was typically located in the aircraft nose.

#### Ambient Temperature (<span class="math inline"><em></em><sup>∘</sup><em>C</em></span>): ATC {-#atc}

A variable obtained by combining the avionics temperature on the GV, AT_A, with a Rosemount temperature, so that the absolute value tracked AT_A but faster response was provided by the Rosemount temperature. This was used in some early GV projects because there were unresolved problems with the data-system temperature sensors and it was thought that AT_A provided a more accurate result, but AT_A was filtered to have slow response to it was combined with the faster-response signal from the Rosemount sensor.

#### Total Temperature (<span class="math inline"><em></em><sup>∘</sup></span>C): TTx {-#ttx}

This variable was used before 2014 for measurements of the recovery temperature, for which the variable is now <strong>RTx</strong>. Because the quantity measured is not the total temperature, the variables TTx were replaced by RTx, but the meaning historically was the same as that now described for <strong>RTX</strong>, apart from how humidity is now handled.

#### Total Temperature, Reverse Flow (<span class="math inline"><em></em><sup>∘</sup><em>C</em></span>): TTRF {-#ttrf}

TTRF is the recovery temperature from a calibrated NCAR reverse-flow temperature sensor, for which the housing was designed to separate water droplets and protect the element from wetting in cloud.

#### Total Temperature (Fast Response) (<span class="math inline"><em></em><sup>∘</sup><em>C</em></span>): TTKP {-#ttkp}

This is the output of recovery temperature from the NCAR fast-response temperature probe, originally designed by Karl Danninger. (See the discussion of total temperature in Section\ \@ref(temperature-section).)

#### Ambient Temperature (<span class="math inline"><em></em><sup>∘</sup><em>C</em></span>): ATRF {-#atrf}

The ambient temperature computed using the NCAR reverse-flow temperature sensor. (See the discussion in Section\ \@ref(temperature-section).)

#### Ambient Temperature (Fast Response) (<span class="math inline"><em></em><sup>∘</sup><em>C</em></span>): ATKP {-#atkp}

The ambient temperature computed using the fast-response temperature probe. (See the discussion of ambient temperature in Section\ \@ref(temperature-section).)

#### Raw Cloud Technology (Johnson-Williams) Liquid Water Content (<span class="math inline"><em>g</em>/<em>m</em><sup>3</sup></span>): LWC {-#jwlwc}

This is the raw output of a Johnson-Williams liquid water content sensor converted to units of grams per cubic meter. The Johnson-Williams indicator measures the evaporative cooling caused by the latent heat of vaporization of droplets contacting the heated sensing element by sensing changes in its resistance as it cools. Through calibration this resistance is converted to a liquid water content. A “compensation” wire is also mounted in the J-W sensor, parallel to the droplet stream, to compensate for cooling effects of the airstream. Typically the instrument is set for a true airspeed of 200 knots. The instrument must be zeroed in “cloud-free air.” The Johnson-Williams liquid water content sensor is designed for the cloud droplet spectrum. There is some evidence to indicate that droplets larger than 30 <span class="math inline"><em>μ</em><em>m</em></span> are shed before completely vaporizing on the sensor element. This tends to underestimate the liquid water content.

#### Corrected Cloud Technology (Johnson-Williams) Liquid Water Content (g/m^3^): LWCC {-#jwlw-corrected}

This is the corrected liquid water content obtained by using the aircraft’s true airspeed after removing the zero offset: LWCC=LWC<span class="math inline"><em>U</em><sub><em>a</em></sub>/<em>U</em><sub><em>r</em><em>e</em><em>f</em></sub></span> where <span class="math inline"><em>U</em><sub><em>a</em></sub></span> is the true airspeed of the aircraft and <span class="math inline"><em>U</em><sub><em>r</em><em>e</em><em>f</em></sub></span> is the true airspeed set on the dial of the instrument. <span class="math inline"><em>U</em><sub><em>r</em><em>e</em><em>f</em></sub></span> was normally 200 kts = 102.88889 m/s.</p>

#### Indicated Airspeed (knots): IAS {-#ias}

In some old data files, a variable representing the indicated airspeed was included because this was used for some derived variables. The indicated airspeed is the airspeed that would produce the observed difference between dynamic and static pressure under standard conditions of 1013.25 mb and <span class="math inline">15<sup>∘</sup></span>C.</p>

#### Water Vapor Pressure (mb): EDPC {-#edpc}

This is a derived intermediate variable used in the calculation of several derived thermodynamic variables. The vapor pressure over a plane water surface is obtained by the method of Paul R. Lowe (1977), a derived, sixth-order, Chebyshev polynomial fit to the Goff-Gratch Formulation (1946) as a function of temperature expressed in <span class="math inline"><em></em><sup>∘</sup><em>C</em></span>. The error is much less than 1% over the range -50<span class="math inline">º</span>C to +50<span class="math inline">º</span>C. EDPC was calculated using this method for most RAF research projects between 1993 and 1996. This variable did not have the enhancement factor applied that was discussed in Appendix C of Bulletin 9. A variable of the same name but calculated differently replaced this in 1996, and with changes described in Section\ \@ref(humidity) continues in use, recently replaced by EWx.<span id="punch:10-2" label="punch:10-2">[punch:10-2]</span>  
```{r child='boxStyles.Rmd'}
```

```{r child='EDPCbox.Rmd'}
```

#### Cryogenic Hygrometer Variables: {-#cryo-hygro}

**Inlet Pressure (hPa): CRHP**<br />
**Frost Point Temperature (<span class="math inline"><em></em><sup>∘</sup><em>C</em></span>): VCRH**<br />
**Corrected Frost Point Temperature (<span class="math inline"><em></em><sup>∘</sup><em>C</em></span>): FPCRC**<br />
**Corrected Dew Point Temperature (<span class="math inline"><em></em><sup>∘</sup><em>C</em></span>): DPCRC**<br />

The first two of these measurements were made directly in the chamber of the cryogenic hygrometer, a now obsolete cabin-mounted instrument connected to outside air by an inlet line. VCRH was determined from a third-order calibration equation applied to the voltage measured by the instrument. <span id="punch:10-3" label="punch:10-3">[punch:10-3]</span>
The corrected frost point and dew point temperatures are those determined after corrections are applied to the direct measurements from a cryogenic hygrometer. These measurements were from a now obsolete instrument but the variables are included here because they appear in some old data files. To obtain estimates of the ambient frost point and dew point, the measurements made inside the chamber of the cryogenic hygrometer (CVRH and CRHP) must be corrected for the difference in water vapor pressure between that chamber and ambient conditions. The ratio of the chamber pressure to the ambient pressure is assumed to be the same as the ratio of the chamber vapor pressure to the ambient vapor pressure. The vapor pressure in the chamber was determined from the Goff-Gratch (1946) equation^[Goff, J. A., and S. Gratch (1946) Low-pressure properties of water from 160 to 212 °F, referenced and used in the Smithsonian Tables (List, 1980).] 
for saturation vapor pressure with respect to a plane ice surface. This vapor pressure was then used with CRHP and a measure of the ambient pressure (PSXC) to determine the vapor pressure in the outside air, and this was converted to an equivalent dew-point. The instrument was only used for measurements of frost point less than -15<span class="math inline"><em></em><sup>∘</sup></span>C because it did not function well above that frost point. <span id="punch:10-4" label="punch:10-4">[punch:10-4]</span>The steps are documented below:  
```{r child='CRCDPbox.Rmd'}
```

#### Voltage Output From the Lyman-alpha Sensor (V): VLA {-#vla}

<em>The voltage output from the Lyman-alpha absorption hygrometer</em>. This instrument provided fast-response, high-resolution measurements of water vapor density. (If a second sensor was used, a 1 was added to the variable name associated with the second sensor.) The sensors are now obsolete.</p>

#### Voltage Output from the UV Hygrometer (V): XUVI {-#xuvi}

<em>The voltage from a modern (as of 2009) version of the Lyman-alpha hygrometer, which provides a signal that represents water vapor density.</em> The instrument also provides measurements of pressure and temperature inside the sensing cavity; they are, respectively, <strong><span class="underline">XUVP</span></strong> and <strong><span class="underline">XUVT</span></strong>. These variables and the processing algorithm below have now been replaced by XSIGV_UVH and the algorithm discussed with the variable EW_UVH.  
```{r child='RHOUVbox.Rmd'}
```

#### Raw Pyrgeometer Output (W m^-2^): IRx {-#irx}

<span id="EppleyReference" label="EppleyReference">[EppleyReference]</span>A pyrgeometer manufactured by Eppley Laboratory, Inc. measures long-wave irradiance using a calibrated thermopile. It has a coated glass hemisphere that transmits radiation in a bandwidth between 3.5 <span class="math inline"><em>μ</em><em>m</em></span> and 50 <span class="math inline"><em>μ</em><em>m</em></span>. It is calibrated at RAF according to procedures specified by Albrecht and Cox (1977). (See the reference in the next paragraph.) The pyrgeometers are usually flown in pairs, one up-looking and one down-looking. The letter ’x’ denotes either bottom (B) or top (T).<br />
<strong>Corrected Infrared Irradiance (W m<span class="math inline"><em></em><sup> − 2</sup></span>):</strong> <strong><span class="underline">IRxC</span></strong><br />
Because the pyrgeometer measures net radiation, IRx must be corrected for emission from the dome covering the sensor and for emission from the thermopile itself. IRxC is the corrected infrared irradiance, determined following procedures of <a href="http://journals.ametsoc.org/doi/pdf/10.1175/1520-0450%281977%29016%3C0190%3APFIPP%3E2.0.CO%3B2">Albrecht and Cox, 1977</a>.  
```{r child='IRxCbox.Rmd'}
```

#### Shortwave Irradiance (W/m^2^): SWx {-#swx}

An Eppley Laboratory, Inc., pyranometer measures short-wave irradiance. The dome normally used is UG295 glass, which gives wide coverage of the solar spectrum (from 0.285 <span class="math inline"><em>μ</em><em>m</em></span> to 2.8 <span class="math inline"><em>μ</em><em>m</em></span>). Different bandwidths can be obtained by use of different glass domes, available from RAF upon request. (See Bulletin No. 25.) The pyranometers are usually flown in pairs, one up-looking and one down-looking. They are calibrated periodically at the NOAA Solar Radiation Facility in Boulder, Colorado. The letter ’x’ denotes either bottom (B) or top (T).</p>

#### Corrected Incoming Shortwave Irradiance (W/m^2^): SWTC {-#swtc}

The down-welling shortwave irradiance measured by the difference between SWT and SWB) is corrected to take into account the sun angle and small variations in the aircraft attitude angles (pitch and roll). The correction is limited to <span class="math inline"> ± 6<sup>∘</sup></span> in either angle, so these measurements should be considered invalid beyond these limits. This is the derived output of incoming (down-welling) shortwave irradiance, taking into account both solar position (sun angle) and modest variations in aircraft attitude (at present, restricted to less than 6<span class="math inline">º</span> in pitch and/or roll). (For more information, refer to <a href="https://opensky.ucar.edu/islandora/object/archives%3A6963">RAF Bulletin 25</a>.)<span id="punch:10-5" label="punch:10-5">[punch:10-5]</span>

#### Ultraviolet Irradiance (W/m^2^): UVx {-#uvx}

A pair of UV radiometer/photometers measure either down-welling (x=T) or up-welling (x=B) irradiance in the ultraviolet, approximately from 0.295 <span class="math inline"><em>μ</em><em>m</em></span> to 0.385 <span class="math inline"><em>μ</em><em>m</em></span>. These units are periodically returned to the Eppley Laboratories for recalibration.

#### Raw Carbon Monoxide Concentration (ppb): CO {-#co}

CO is the uncorrected output of the TECO model 48 CO analyzer. <span id="punch:10-6" label="punch:10-6">[punch:10-6]</span>This instrument measures the concentration of CO by gas filter correlation. The optics of the version operated by the RAF have been modified to increase the light through the absorption cell, and a zero trap has been added that periodically removes CO from the sample air stream to obtain an accurate zero. This permits correction for the significant temperature-dependent drift of the zero level of the measurement.</p>
 
#### Carbon Monoxide Analyzer Variables: {-#co-vars}

**Status (V): CMODE**<br />
**Baseline Zero Signal (V): COZRO**<br />
**Raw Carbon Monoxide Signal, Baseline Corrected (V): COCOR*</span></strong></p>**<br />
**Corrected Carbon Monoxide Concentration (ppmv): COCAL**<br />

CMODE records if the CO analyzer is supplied with air from which CO has been removed and so is recording its zero level. When CMODE is less than 0.2 V, the instrument is in the normal operational mode, and when CMODE is greater than 8.0 V the instrument is in the “zero” mode. When measurements are processed, the zero-mode signals are represented by a cubic spline to obtain a reference baseline for the signal (COZRO), and this baseline is subtracted from the measured value (CO) to obtain COCOR. This variable still jumps to zero periodically and does not include the calibration that enters the corrected variable, COCAL, which is the calibrated signal from the CO instrument after correction for drift of the baseline and after application of the appropriate calibration coefficients to produce units of ppmv. The quality of the baseline fit can be judged by examining the offset at the zero points. If there are relatively small changes in the baseline, the zero offset will be only a few ppbv. If there have been rapid changes in the baseline, the zero offset can be up to 50 ppbv. The magnitude of the offset at the zero values gives a good measure of uncertainty in the data set. The detection limit is 10 ppbv, with an uncertainty of <span class="math inline"> ± 15%</span>. At 1 Hz, data will have considerable variability, so 10-s averaging is often useful when the measurements are used for analysis.

#### Raw Chemiluminescent Ozone Signal (V): O3FS {-#o3fs}

<em>Voltage output from the chemiluminescence ozone instrument,</em> which operates on the basis of reacting nitric oxide with ozone and detecting the resulting chemiluminescence.

#### Derived Supercooled Liquid Water Content (g/m^3^): SCLWC {-#SCLWC}

This variable is the supercooled liquid water content obtained from the change in accreted mass on the Rosemount 871F ice-accretion probe over one second. The output is not valid during the probe deicing cycle. This cycle is apparent in the RICE output (a peak followed by a decrease to near zero). Supercooled liquid water content is determined by first calculating a water drop impingement rate which is a function of the effective surface area, the collection efficiency, the true airspeed, and the supercooled liquid water content. The impingement rate obtained is equated to the accreted mass of ice collected by the probe in one second (empirical voltage/mass relationship). The resulting equation is solved for supercooled water content. This calculation is not included in normal processing or special processing, but some users of the instrument use an approach like the following to calculate supercooled liquid water:<span id="punch:10-8" label="punch:10-8">[punch:10-8]</span>  
```{r child='SCLWCbox.Rmd'}
```

#### FSSP-100 Fast Resets</strong> (number per sample interval):  FRST, FRESET {-#freset}

<em>The rate at which fast resets occur in an FSSP-100 probe.</em> The FSSP-100 records events called “fast resets” that occur when a particle traverses the beam outside the depth-of-field and therefore is not accepted for sizing. To avoid the processing time associated with sizing, the probe resets quickly in this case, but there is still some dead time when the probe cannot record another event. Fast resets consume a time determined by circuit characteristics, and that time has been determined in laboratory tests of the FSSP circuitry. This variable is needed in addition to the “Total Stobes” to determine what fraction of the time the probe is unable to accept another particle, and this “dead time” enters calculation of the concentration for the original (old) FSSP.

#### FSSP-100 Total Strobes (number per sample interval): FSTB, FSTROB {-#fstrob}

<em>The rate at which strobes are generated in an FSSP-100 probe.</em> A “strobe” is generated in the FSSP-100 whenever a particle is detected within its depth-of-field. Not all such particles are accepted for inclusion in the size distribution, however, because some pass through the outer regions of the illuminating laser beam and therefore produce shorter and smaller-amplitude pulses than those passing through the center of the beam. The probe maintains a running estimate of the average transit time and rejects particles with transit times shorter than this average. The total number of strobes recorded is therefore more than the number of sized particles, and the ratio of strobes to accepted particles can indicate quality of operation of the probe. Also, the strobes require processing and so contribute to the dead time of the probe, affecting the concentration unless a correction is made. See <a href="https://opensky.ucar.edu/islandora/object/archives%3A8155">RAF Bulletin 24</a> for more discussion on the operation of the “old” FSSP.

#### FSSP-100 Beam Fraction (dimensionless):  FBMFR {-#fbmfr}

<em>The ratio of the number of velocity-accepted particles (particles that pass through the effective beam diameter) to the total number of particles detected in the depth-of-field of the beam (the total strobes).</em> See the discussion of Total Strobes for more information.  
```{r child='FBMFRbox.Rmd'}
```

#### FSSP-100 Calculated Activity Fraction (dimensionless):  FACT {-#fact}

This variable represents the fraction of the time that the FSSP is unable to count and size particles (its “dead time”). The activity fraction is not measured directly but is estimated from fast resets and total strobes along with measurements of the dead times associated with each (as determined in laboratory tests). The characteristic times are in the NetCDF header (for recent projects).  
```{r child='FACTbox.Rmd'}
```

#### PCAS Raw Activity (dimensionless): PACT, AACT {-#AACT}

The PCAS probe provides this measure of dead time, the time that the probe is unable to sample particles because the electronics are occupied with processing particles. The manufacturer suggests that the actual dead time ($f_{PCAS}$) is given by the following formula, which should be used when determining concentrations for the PCAS:  
<p class=box>
$$F_{PCAS} = 1024\,\mathrm{s}^{-1}$$
</p><p class=box2>
\begin{equation}
f_{PCAS} = 0.52\frac{\mathrm{\{PACT\}}}{F_{PCAS}}
(\#eq:fPCAS)
\end{equation}
</p>

However, PACT (or AACT) is the variable archived in the data files.<br />
</p>

<!--chapter:end:Section10.Rmd-->

# General Information About Data Files

## System of Units

This report uses the SI system of units, but with many exceptions. Among them are the following:  

1. The millibar (mb), equal to one hectopascal (hPa), was used for pressure with some older variables.  
2. Many variables are presented in the units most often used for that variable, even when they involve CGS units or mixed CGS-MKS units, as for example [g m^-3^] for liquid water content or
[cm^-3^] for droplet concentration.  
3. Flow rates are often quoted in liters per minute (LPM) or standard liters per minute (SLPM) because those terms are linked to properties of commercially available instruments with flow control. One liter is 10^-3^m^3^. Standard temperature and pressure are respectively 273.15 K and 1013.25 hPa. However, there is considerable ambiguity in the definition of “standard” conditions (mostly regarding the choice of the reference temperature) because some flow controllers and flowmeters specify a different “standard” temperature, so the particular usage will be documented when this term is used. Mass flow meters provide a measure of the flow of mass but usually report the measurement in terms of the volume flow that would be present under standard conditions (e.g.., SLPM). Therefore, to convert to volumetric flow at other conditions, if the fluid density is $\rho$ and the mass flow rate in units of mass per time is denoted by $\dot{m}^\prime$, the volumetric flow is $Q=\dot{m}^\prime/\rho$. Then the mass flow rate in units of standard volume per time is $\dot{m}=\dot{m}^\prime/\rho_s$ where $\rho_s$ is the density of the fluid under standard conditions. To convert to volumetric flow under other conditions, $Q(p,T)=\dot{m}^\prime/\rho$ = $\dot{m}\rho_s/\rho$ = $\dot{m}p_{s}T/(p\thinspace T_{s})$ where $p$ and $T$ are the pressure and absolute temperature for the desired measurement and $p_s$ amd $T_s$ are the corresponding values for standard conditions.  
4. The International Bureau of Weights and Measures recommends against use of units like percent or parts per million, but these are in common use in atmospheric chemistry and elsewhere so data files continue to use those units for relative humidity or the concentration of chemical species. Proper SI units for a volumetric mixing ratio would be, e.g., $\mu$mol\ mol^-1^, nmol\ mol^-1^, or pmol\ mol^-1^, but variables are instead often assigned the respective units of ppmv, ppbv or pptv for parts per million, billion or trillion by volume. Care must be taken to interpret ppbv especially, because “billion” has different meaning in different languages and different countries; herein, 1 ppbv means a volumetric ratio of 1:10^9^. Many measurements produce native results in terms of a mass ratio, often described as a mixing ratio $r_m$ that specifies the mass of the measured gas per unit mass of “air” (where the mass of the “air” does not include the variable constituents, usually only significant for water vapor). The perfect gas law relates the density ratio of two gases $(\rho_1:\rho_2)$ to the ratio of their partial pressures $(p_1:p_2)$ or number densities $(n_1:n_2)$ as follows:  
\begin{align}
r_{m}=\frac{\rho_{1}}{\rho_{2}}=\frac{p_{1}M_{1}}{p_{2}M_{2}}=\frac{n_{1}M_{1}}{n_{2}M_{2}}
(\#eq:rm)
\end{align}
where $M_1$ and $M_2$ are respective molecular weights for the two gases. The ratio of number densities or, equivalently, partial pressures, denoted here as $r_v$ because it is also the volumetric mixing ratio, is related to the mass mixing ratio as follows:  
\begin{equation}
r_{v}=\frac{n_{1}}{n_{2}}=\left(\frac{M_{2}}{M_{1}}\right)r_{m}
(\#eq:rv)
\end{equation}
When concentrations are recorded with units of “ppmv”, “ppbv” or “pptv”, these units refer respectively to $10^6r_v$, $10^9r_v$, and $10^{12}r_v$ with $r_v$ given by the above equation.  
5. The unit “hertz” (abbreviation Hz) is the proper unit for a periodic sampling frequency and will be used here in place of the more awkward “samples per second.” This usage is favored by the International Bureau of Weights and Measures (cf. <a href="http://www.bipm.org/en/si/si_brochure/chapter2/2-2/table3.html#notes">http://www.bipm.org/en/si/si_brochure/chapter2/2-2/table3.html#notes</a>) when the frequency represented refers to the rate of sampling.  
6. In some cases, particularly for older data files, speed has been recorded in units of knots (= 0.514444 m/s) and distance in nautical miles <span class="math inline">≡</span> 1852 m).  

In Appendix A there is a list of symbols.^[Some symbols used only once and defined where they are used are omitted from this list] The next table defines some abbreviations and additional symbols used for units in this report, in addition to the standard abbreviations for the mks system of units:<span id="punch1.2" label="punch1.2">[punch1.2]</span>  
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><strong>abbreviation/symbol</strong></th>
<th style="text-align: left;"><strong>definition</strong>^[where the symbol <span class="math inline">≡</span> is used, the relationship is exact by definition]
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">º</td>
<td style="text-align: left;">degree, angle measurement <span class="math inline">≡</span> (<span class="math inline"><em>π</em></span>/180) radian</td>
</tr>
<tr class="even">
<td style="text-align: center;">ft</td>
<td style="text-align: left;">foot <span class="math inline">≡</span> 0.3048 m</td>
</tr>
<tr class="odd">
<td style="text-align: center;">mb</td>
<td style="text-align: left;">millibar <span class="math inline">≡</span> 100 Pa <span class="math inline">≡</span> 1 hPa</td>
</tr>
<tr class="even">
<td style="text-align: center;">ppmv</td>
<td style="text-align: left;">parts per million by volume (see item 4 above)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ppbv</td>
<td style="text-align: left;">parts per billion (<span class="math inline">10<sup>9</sup>)</span> by volume (see item 4 above)</td>
</tr>
<tr class="even">
<td style="text-align: center;">pptv</td>
<td style="text-align: left;">parts per trillion (<span class="math inline">10<sup>12</sup>)</span> by volume (see item 4 above)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">n mi</td>
<td style="text-align: left;">nautical mile <span class="math inline">≡</span>1852 m</td>
</tr>
<tr class="even">
<td style="text-align: center;">kt</td>
<td style="text-align: left;">knot (n mi/hour) <span class="math inline">≡</span> (1852/3600) m/s = 0.514444... m/s</td>
</tr>
</tbody>
</table>
<!-- % <h2 id="variables-used-to-denote-time">Variables Used To Denote Time</h2> -->

## Variables Used to Denote Time

Although there are some exceptions in old archived data files, the data in all modern output files are referenced to Coordinated Universal Time (UTC). The time and date of the data acquisition system are synchronized to time from the Global Positioning System (GPS) at the beginning of each flight, and for data acquired by the present ADS-3 (NIDAS) data acquisition system time is synchronized continuously with the GPS time. Time variables vary for older archived data files; some of the following are obsolete, but are included here for reference because they are important to those wanting to use those archives.

#### Time (s): Time {-#time} 

<em>The reference-time</em> counter <em>for the output data files,</em> used by data system versions beginning with ADS-3. It is an integer output at 1 Hz <em>and has an initial value of zero at the start of the flight</em>. Add this to the “Time:units” attribute found in the NETCDF header section to obtain the UTC time.</p>
<p>Example attribute: <code></code> <br />
<code></code><code>Time:units = “seconds since 2006-04-26 12:55:00 +0000” </code>;</p>
<p>For code examples that show how to use “Time” see:<br />
<code></code><a href="http://www.eol.ucar.edu/raf/Software/TimeExamp.html">http://www.eol.ucar.edu/raf/Software/TimeExamp.html</a></p>

#### Reference Start Time (s): base_time (<em>Obsolete; versions before ADS-3 only</em>) {-#base-time}

<em>The reference time for the netCDF output data files for data system versions before ADS-3.</em> It represents the time of the first data record. Its format is Unix time (elapsed seconds after midnight 1 January 1970). Add time_offset (below) to obtain the time for each data record. (Note: base_time is a single scalar, not a “record” variable, so it occurs just once in the output file.)

#### Time Offset from Reference Start Time (s): time_offset (<em>Obsolete)</em> {-#time-offset}

<em>The time offset from base_time of each data record used for the NETCDF output files produced by data system versions before ADS-3.</em> It starts at zero (0) and increments each second, so it can also be thought of as a record counter. Use this measurement and add base_time to obtain the time for each data record.

#### Raw Tape Time (h, min, s): HOUR, MINUTE, SECOND (<em>Obsolete</em>) {-#hms}

These three time variables are recorded directly from the aircraft’s data system. Since ADS-3, this information is replaced by the “Time” variable and the “Time:units” attribute of that variable.

#### Date (m, d, y): MONTH, DAY, YEAR (<em>Obsolete</em>) {-#mdy}

These three variables represent the date when the aircraft’s data system began recording data. They are repeated as 1 Hz variables but are NOT incremented if the time rolls over to the next day. Use base_time and time_offset for reference timing. Since ADS-3, this information is replaced by the “Time” variable and the “Time:units” attribute of that variable.

## Synchronization of Measurements {#synchronication-of-measurements}

<p>Measurements sampled under control of the “NIDAS” sampling system are acquired at 50 Hz. However, the standard archive files are produced at a rate of 1 Hz, and each sample is the average of 50 samples. Therefore, the time associated with measurements reported at 1 Hz is actually an average over the specified second, so the reference time for the averaged measurement is actually 0.5 s past the reported time. Analogous offsets apply to variables reported at other rates different from 50 Hz. Where it applies, electronic filters with cutoff frequency of 25 Hz are used with analog measurements. Higher-rate files are sometimes produced, standardized to 25 Hz but sometimes at other frequencies.
  
There are time shifts inherent in many of the measurements, and in some cases (e.g., those produced by inertial reference units) these time shifts arise because the information is transmitted from the measuring system at a time later than when it was sampled. In these cases, shifts (“lags”) are applied to the measurements. The lags may be either static or dynamic. Static lags are specified in a configuration file, saved for each project; dynamic lags provided as part of data sampling by specific instruments are recorded by NIDAS for use in processing. Dynamic lags are usually a difference in time from a gridded time value to the time it was actually acquired. e.g. for a 5-Hz parameter the expected or gridded millisecond offset into each second would be 0, 200, 400, 600, and 800. If the data actually were sampled or acquired at 50, 250, 450, 650, and 850 ms then the dynamic lag for this particular second would be -50 ms. Corrections for time lags are applied to measurements before conversion to one of the standard data rates.</p>
<p>Where data rates for particular measurements do not match the basic 50 Hz sampling rate, linear interpolation is used to obtain higher-rate values. For 1 Hz data files, measurements are then averaged within each second. For 25 Hz files, 50 Hz measurements are digitally filtered using a finite impulse response (FIR) filter, while data acquired at less than 25 Hz are linearly interpolated to 25 Hz and then FIR-filtered for smoothing.  

<p><span id="punch1.3" label="punch1.3">[punch1.3]</span></p>

## Other Comments on Terminology

### Variable Names in Equations

This report often uses variable names in equations, and sometimes there is potential for confusion because the variable names consist of multiple characters. In most cases, to denote that the variable name is the variable in the equation (as opposed to each of the letters in the variable name representing quantities to be multiplied together), the variable name has been enclosed in brackets, as in {TASX}. In addition, variable names are displayed with upright Roman character sets, while other symbols in equations are shown using slanted (script) character sets as is conventional for mathematical equations. In cases where code segments (usually expressed in C code) are included to document how calculations are performed, typewriter character sets indicate that the segment is a representation of how the processing could be coded. Such a code segment is not always a direct copy of the code in use, but such code is sometimes the most convenient way to express the algorithm in use. 

### Distinction Between Original Measurements and Derived Variables
  
Many of the variables in the data files and in this report are derived from combinations of measurements. The terms “raw” or “original” measurement are sometimes used for a minimally processed output received directly from a sensor or instrument. Such measurements may be converted to engineering units via calibration coefficients, but otherwise they are a direct representation of the output from a sensor.^[Calibration coefficients, e.g. those used to convert from voltage output from an analog sensor to a measured quantity with physical units like <span class="math inline">º</span>C, are not included or discussed in this report. They are normally included in project reports and, in recent years, many are included in the header of the NETCDF file.]
In contrast, derived variables (e.g., potential temperature) depend on one or more “raw” measurements and are not direct results of output from an instrument. For most derived measurements, a box that follows an introductory comment is used in this report to document the processing algorithm. The box has two parts; in the top are definitions used and explanations regarding variables that enter the calculation, while the bottom portion contains the equation, algorithm, or code segment that documents how the variable is calculated.<span id="punch1.4" label="punch1.4">[punch1.4]</span>  

### Dimensions in Equations

An effort has been made to avoid dimensions in equations except where it would be awkward otherwise. Some scale factors are introduced for only this purpose (e.g., to avoid dimensions in arguments to logarithmic or exponential functions), and some effort was made to isolate dimensions to defined constants rather than requiring that variables in equations be used with specific units. However, some exceptions remain to be consistent with historical usage.


<!--chapter:end:Section2.Rmd-->

# The State of the Aircraft {#the-state-of-the-aircraft}

The primary sources of information on the location and motion of the aircraft are inertial navigation systems and global positioning systems. Both are described in this section, and combined results that merge the best features of each into composite variables for location and motion are also discussed. Useful references for material in this section are <a href="http://nldr.library.ucar.edu/repository/assets/technotes/TECH-NOTE-000-000-000-064.pdf">Lenschow (1972)</a> and <a href="https://opensky.ucar.edu/islandora/object/archives%3A8152">RAF Bulletin 23</a>.  

## Inertial Reference Systems {#inertial-reference-systems}

An Inertial Navigation System (INS) or Inertial Reference Unit (IRU) provides measurements of aircraft position, velocity relative to the Earth, acceleration and attitude or orientation. The IRU provides basic measurements of acceleration and angular rotation rate, while the INS integrates those measurements to track the position, altitude, velocity, and orientation of the aircraft. For the GV, the system is a Honeywell Laseref IV HG2001 GD03 Inertial Reference System; for the C-130, it is a Honeywell Model HG1095-AC03 Laseref V SM Inertial Reference System. These systems are described on the EOL web site, at <a href="http://www.eol.ucar.edu/instruments/inertial-navigation-system-aka-inertial-reference-unit">this URL</a>. Data from the IRS come via a serial digital bit stream (the ARINC digital bus) to the ADS (Aircraft Data System). Because there is some delay in transmission and recording of these variables, adjustments for this delay are made when the measurements are merged into the processed data files, as documented in the NetCDF header files and as discussed in Section \@ref(synchronication-of-measurements). Typical delays are about 80 ms for variables including ACINS, PITCH, ROLL, and THDG.  

Some variables are recorded only on the original “raw” data tapes and are not usually included in final archived data files; these are discussed at the end of this subsection. See also the discussion in Section \@ref(obsolete-variables) for information on results from inertial systems that were used prior to installation of the present Honeywell systems.<span id="punch3.1" label="punch3.1">[punch3.1]</span>  

An Inertial Navigation System “aligns” while the aircraft is stationary by measurement of the variations in its reference frame caused by the rotation of the Earth. Small inaccuracy in that alignment leads to a “Schuler oscillation” that produces oscillatory errors in position and other measurements, with a period $\tau_{Sch}$ of about 84 minutes ($\tau_{Sch}=2\pi\sqrt{R_{E}/g}$). Position errors of less than $1.0\,$n mi/h are within normal operating specifications. See Section \@ref(combining-irs-and-gps-measurements) for discussion of additional variables, similar to the following, for which corrections are made for these errors via reference to data from a Global Positioning System.  

Some projects have used smaller Systron Donner C-MIGITS Inertial Navigation Systems with GPS coupling, usually in connection with special instruments like a wing-mounted wind-sensing system. For these units, variable names usually begin with the letter C but otherwise have names matching the following variables (e.g., CLAT). GPS coupling via a Kalman filter is incorporated in the measurements from these units. They are described at <a href="https://www.eol.ucar.edu/instruments/c-migits-insgps-system">this web address</a>.

Uncertainties associated with measurements from the IRS are discussed in a Technical Note, available at <a href="http://dx.doi.org/10.5065/D60G3HJ8">this URL</a>. See page 7 of that document and the tables on pages 41 and 49.  

### Standard Variables

#### Latitude (<span class="math inline">º</span>): LAT {#latitude .unnumbered}

<em>The aircraft latitude</em> <em>or angular distance north of the equator in an Earth reference frame</em>. <em></em> Positive values are north of the equator; negative values are south. The resolution is 0.00017<span class="math inline"><em></em><sup>∘</sup></span> and the accuracy is reported by the manufacturer to be 0.164<span class="math inline"><em></em><sup>∘</sup></span> after 6 h of flight. Values are provided by the INS at a frequency of 10 Hz.  

#### Longitude (<span class="math inline">º</span>): LON {#longitude .unnumbered}

<em>The aircraft longitude</em> or angular distance east of the prime meridian in an Earth reference frame. Positive values are east of the prime meridian; negative values are west. The resolution is 0.00017<span class="math inline"><em></em><sup>∘</sup></span> and the accuracy is reported by the manufacturer to be 0.164<span class="math inline"><em></em><sup>∘</sup></span> after 6 h of flight. Values are provided by the INS at a frequency of 10 Hz.  

#### Aircraft True Heading (<span class="math inline"><em></em><sup>∘</sup></span>): THDG {#thdg .unnumbered}

<em>The azimuthal angle between the center-line of the aircraft (pointing ahead, toward the nose) and a line of meridian.</em> This azimuthal angle is measured in a polar coordinate system oriented relative to the Earth with polar axis upward and azimuthal angle measured relative to true north. The heading thus indicates the orientation of the aircraft, not necessarily the direction in which the aircraft is traveling. The resolution is 0.00017<span class="math inline">º</span> and the accuracy is quoted by the manufacturer as 0.2<span class="math inline">º</span> after 6 h of flight. Values are provided by the INS at a frequency of 25 Hz. “True” distinguishes the heading from the magnetic heading, the heading that would be measured by a magnetic compass. For more information on the coordinate system used, see <a href="https://opensky.ucar.edu/islandora/object/archives%3A8152">RAF Bulletin 23</a>.<span id="punch3.2" label="punch3.2">[punch3.2]</span>  

#### Aircraft Pitch Attitude Angle (<span class="math inline">º</span>): PITCH {#pitch .unnumbered}

<em>The angle between the center-line of the aircraft (pointing ahead, toward the nose) and the horizontal plane in a reference frame relative to the Earth with polar axis upward.</em> Positive values correspond to the nose of the aircraft pointing above the horizon. The resolution is 0.00017<span class="math inline">º</span> and the accuracy is quoted by the manufacturer as 0.05<span class="math inline">º</span> after 6 h of flight. Values are provided by the INS at a frequency of 50 Hz.  

#### Aircraft Roll Attitude Angle (<span class="math inline">º</span>): ROLL {#roll .unnumbered}

<em>The angle of rotation about the longitudinal axis of the aircraft required to bring the lateral axis (along the wings) to the horizontal plane.</em> Positive angles indicate that the starboard (right) wing is down ((i.e., a clockwise rotation has occurred from level when facing forward in the aircraft). The resolution is 0.00017<span class="math inline">º</span> and the accuracy is quoted by the manufacturer as 0.05<span class="math inline">º</span> after 6 h of flight. Values are provided by the INS at a frequency of 50 Hz.  

#### Aircraft Vertical Acceleration (m s^-2^): ACINS {#ACINS .unnumbered}

<em>The acceleration upward (relative to the Earth) as measured by an inertial reference unit.</em> With INSs now in use, the internal drift that arises when this measurement is integrated to get aircraft vertical speed and then altitude is removed by the INS via pressure damping through reference to the pressure altitude.^[For earlier projects using the Litton LTN-51 INS, this is a direct measurement without adjustment for changes in gravity during flight and without pressure-damping. Previous use employed a baro-inertial loop to compensate for drift in the integrated measurement. See the discussion of WP3 below.]
Positive values are upward. The sample rate is 50 Hz and the resolution is 0.0024 m s<span class="math inline"><em></em><sup> − 2</sup></span>.  

#### Computed Aircraft Vertical Velocity (m/s): VSPD {#vspd .unnumbered}

<em>The upward velocity of the aircraft, or rate-of-climb relative to the Earth, as measured by the INS.</em> VSPD is determined within the INS by integration of the vertical acceleration, with damping based on measured pressure to correct for accumulated errors in the integration of acceleration. The sample rate is 50 Hz with a resolution of 0.00016 m/s. The Honeywell Laseref INS employs a baro-inertial loop, similar to that described below for WP3 and the Litton LTN-51, to update the value of the acceleration. This variable is also filtered within the INS so that there is little variance with frequency higher than 0.1 Hz.  

#### Aircraft Rate of Climb (m/s): ROC (new 2017) {#roc .unnumbered}

<em>The rate of climb or upward speed of the aircraft,</em> as measured by the INS with correction so as to represent the derivative of the geometric height. This variable is calculated by integration of the variable ACINS and then addition of the low-pass-filtered difference between that integral and the climb rate determined from the hydrostatic equation. The result retains the high-frequency response from the INS while matching the low-frequency average value determined from the hydrostatic equation, and so represents change in geometric height. <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107f.pdf">This memo</a> contains additional background information on this variable.<br />  
```{r child = 'ROCbox.Rmd'}
```

#### Pressure-Damped Aircraft Vertical Velocity (m/s): WP3 {#wp3 .unnumbered}

<span id="WP3 algorithm" label="WP3 algorithm"></span>This was a derived variable incorporating a third-order damping feedback loop to remove the drift from the inertial system’s vertical accelerometer (ACINS or VZI) using pressure altitude (PALT) as a long-term, stable reference. Positive values are up. The Honeywell INS now in use provides its own version of this measurement, VSPD, and WP3 is now considered obsolete (and in any case should not be calculated from ACINS as provided by the Honeywell Laseref IRS because that ACINS already incorporates pressure damping). Documentation is included here because many old data files include this variable. Note that “pressure altitude” is not a true altitude but an altitude equivalent to the ambient pressure in a standard atmosphere, so updating a variable integrated from inertial measurements to this value can introduce errors vs. the true altitude. WP3 was calculated by the data-processing software as follows (with coefficients in historical use and not updated to the recommendations elsewhere in this technical note):^[Regarding signs, note that ACINS is a number near zero, not near g, and so already has the estimated acceleration of gravity removed. The assumption made in the following is that the INS will report values adjusted for the gravitational acceleration <em>at the point of alignment</em>, which would be <span class="math inline"><em>G</em><sub><em>L</em></sub></span>. If <span class="math inline"><em>g</em><sub><em>F</em></sub></span>, the estimate for gravity at the flight altitude (palt) and latitude (lat), is <em>smaller</em> than <span class="math inline"><em>G</em><sub><em>L</em></sub></span> then the difference (<span class="math inline"><em>G</em><sub><em>L</em></sub> − <em>g</em><sub><em>f</em></sub></span>) will be positive; this will correct for the reference value for ACINS being the gravity measured at alignment (<span class="math inline"><em>G</em><sub><em>L</em></sub></span>) when it should actually be the sensed gravity (<span class="math inline"><em>g</em><sub><em>f</em></sub></span>) at the measurement point, so to obtain (sensed acceleration - <span class="math inline"><em>g</em><sub><em>f</em></sub></span>) it is necessary to add (<span class="math inline"><em>G</em><sub><em>L</em></sub> − <em>g</em><sub><em>f</em></sub></span>) to ACINS, <em>increasing</em> “acz” in this case. However, the situation with “vcorac” is reversed: “vcorac” is a positive term for all eastward flight, for example, but in that case the motion of the aircraft makes objects seem lighter (i.e., they experience less acceleration of gravity) than without such flight. ACINS is positive upward so it represents a net acceleration of the aircraft upward (as imposed by the combination of gravity and the lift force of the aircraft). To accomplish level flight in these circumstances, the aircraft must actually accelerate downward so the accelerometer will experience a negative excursion relative to slower flight. To compensate, “vcorac” must make a positive contribution to remove that negative excursion from “acz”. In the conceptual extreme that the aircraft flies fast enough for the interior to appear weightless, ACINS would reduce to -1<span>*</span><span class="math inline"><em>G</em><sub><em>L</em></sub></span> and vcorac would increase to +<span class="math inline"><em>G</em><sub><em>L</em></sub></span>, leaving acz near zero as required if the aircraft were to remain in level flight in the rotating frame.]
<br />  
```{r child = 'WP3box.Rmd'}
```

#### Inertial Altitude (m): ALT {#alt .unnumbered}

<em>The altitude of the aircraft as provided by an INS</em>, with pressure damping applied within the INS to the integrated aircraft vertical velocity to avoid the accumulation of errors. The value therefore is updated to the pressure altitude, not the geometric altitude, and should be regarded as a measurement of pressure altitude that has short-term variations as provided by the INS. The sample rate is 25 Hz with a resolution of 0.038 m. In some projects ALT also referred to the altitude from the avionics GPS system; the preferred and current variable name for that is ALT_G.<span id="punch3.10" label="punch3.10">[punch3.10]</span>  

#### Aircraft Ground Speed (m/s): GSF {-#gsf}

<em>The ground speed of the aircraft as provided by an INS.</em> The resolution is 0.0020 m/s, and the INS provides this measurement at a frequency of 10 Hz.  

#### Aircraft Ground Speed East Component (m/s): VEW {#vew .unnumbered}

<em>The east-directed component of ground speed as provided by an INS.</em> The resolution is 0.0020 m/s, and the INS provides this measurement at a frequency of 10 Hz.  

#### Aircraft Ground Speed North Component (m/s): VNS {#vns .unnumbered}

<em>The north-directed component of ground speed as provided by an INS.</em> The resolution is 0.0020 m/s, and the INS provides this measurement at a frequency of 10 Hz.  

#### Distance East/North of a Reference (km): DEI, DNI {#dei-dni .unnumbered}

<em>Distance east or north of a project-dependent reference point.</em> These are derived outputs obtained by subtracting a fixed reference position from the current position. The values are determined from measurements of latitude and longitude and converted from degrees to distance in a rectilinear coordinate system. The reference position can be either the starting location of the flight or a user-defined reference point (e.g., the location of a project radar). The accuracy of these values is dependent on the accuracy of the source of latitude and longitude measurements (see LAT and LON), and the calculations are only appropriate for short distances because they do not take into account the spherical geometry of the Earth.<span id="punch:3.11" label="punch:3.11">[punch:3.11]</span><br />  
```{r child='DNSbox.Rmd'}
```

#### Radial Azimuth/Distance from Fixed Reference FXAZIM, FXDIST {#fxaxim .unnumbered}

<em>Azimuth and distance from a project-dependent reference point.</em> The units of the azimuthal angle are degrees (relative to true north) and the distance is in kilometers. These are calculated by rectangular-to-polar conversion of DEI and DNI, described in the preceding paragraph.  

### Additional Special-Use Variables

The following INS and IRU variables are not normally included in archived data files, but their values are recorded by the ADS and can be obtained from the original “raw” data files:

#### Raw Lateral Body Acceleration (m/s^2^): BLATA {#blata .unnumbered}

The raw output from the IRU lateral accelerometer. Positive values are toward the starboard, normal to the aircraft center line. The sample rate is 50 Hz with a resolution of 0.0024 m s^-2^.  

#### Raw Longitudinal Body Acceleration (m/s^2^): BLONA {#blona .unnumbered}

The raw output from the IRU longitudinal accelerometer. Positive values are in the direction of the nose of the aircraft and parallel to the aircraft center line. The sample rate is 50 Hz with a resolution of 0.0024 m s^-2^.  

#### Raw Normal Body Acceleration (m/s^2^): BNORMA {#bnorma .unnumbered}

The raw output from the IRU vertical accelerometer. Positive values are upward in the reference frame of the aircraft, normal to the aircraft center line and lateral axis. The sample rate is 50 Hz with a resolution of 0.0024 m s^-2^.

#### Raw Body Pitch Rate (<span class="math inline">º</span>/s): BPITCHR {-#bpitchr}

The raw output of the IRU pitch rate gyro. Positive values indicate the nose moving upward and refer to rotation about the aircraft’s lateral axis. The sample rate is 50 Hz with a resolution of 0.0039<span class="math inline">º</span>/s.  

#### Raw Body Roll Rate (<span class="math inline">º</span>/s): BROLLR {#brollr .unnumbered}

The raw output of the IRU roll rate gyro. Positive values indicate starboard wing moving down and refer to rotation about the aircraft center line. The sample rate is 50 Hz with a resolution of 0.0039<span class="math inline">º</span>/s.  

#### Raw Body Yaw Rate (<span class="math inline">º</span>/s): BYAWR {#byawr .unnumbered}

The raw output of the IRU yaw rate. Positive values represent the nose turning to the starboard and refer to rotation about the aircraft’s vertical axis. The sample rate is 50 Hz with a resolution of 0.0039<span class="math inline">º</span>/s.  

## Global Positioning Systems

Primary GPS variables specifying the position and velocity of the aircraft are provided by GPS receivers, currently a NovAtel Model OEM 5 unit on the GV and a NovAtel Model OEM-4 receiver on the C-130 (to be replaced by an OEM-6 after January 2014). See <a href="http://www.eol.ucar.edu/instruments/research-global-positioning-system">this link</a> for a description of these systems. The coordinate system used for all GPS measurements is the World Geodetic System WGS-84; for details, see <a href="http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf">this link</a>.^[There are four measures of height or altitude discussed in this technical note, height relative to the WGS-84 reference surface, geometric height relative to mean sea level, geopotential height and pressure height. The WGS-84 height (measured by GPS instruments) is height relative to a reference system in which zero is defined by a specified reference ellipsoid representing the shape of the Earth, as specified here: <a href="http://earth-info.nga.mil/GandG/publications/tr8350.2/tr8350_2.html">http://earth-info.nga.mil/GandG/publications/tr8350.2/tr8350_2.html</a>,. This is not defined to be a level surface in the sense of being an equipotential surface. A better approximation of mean sea level is the “geoid”, a surface having constant gravitational equipotential that approximates mean sea level. The geoid is more structured than the WSR-84 reference ellipsoid and departs significantly from it, often by several 10s of meters. Even the geoid does not represent mean sea level exactly because local mean sea level can be influenced by variations in water density, mean wind, or ocean circulation, but the geoid is usually the reference used for measurements labeled “MSL” except when fine-scale local effects must be considered. The geometric height is the true height above a reference surface, often taken to be mean sea level or the geoid; this may therefore differ significantly from the height measured directly by a GPS unit. There is a variable included below, GGEOIDHT, that provides a measure of the difference. Geopotential height is the height above mean sea level that would give the geopotential, or gravitational potential energy per unit mass, of the actual parcel if that mass were raised against standard gravity (not varying, e.g., with latitude or height) to that altitude. For the purpose of this definition, standard gravity is defined to be 9.80665<span class="math inline"> <em>m</em> <em>s</em><sup> − 2</sup></span>. Finally, pressure altitude, defined in detail below, is the altitude in the ISA Standard Atmosphere where the pressure matches a specified value; it is not a geometric coordinate but rather a measure of pressure.]
The uncertainty of the position measurements is specified by the manufacturer to be 1.5 m CEP horizontal (3.3 m 95% CEP).^[CEP is the Circular Error Probability, the radius of a circle that contains 50% of the measurements; 95% CEP contains 95% of the measurements. When OnmiSTAR corrections are available (involving extra cost and not available in all areas of the globe, so not available for all projects) the uncertainty decreases to 0.15 m 95% CEP. The vertical uncertainty is about twice as great as the horizontal uncertainty. Because variables are stored as 4-byte single-precision floating point numbers, the inherent storage precision can limit the precision of the recorded position to about 1 m.]
The accuracy of velocity measurements is 0.03 m/s RMS for all axes. All variables are provided by the GPS receivers at 5 Hz. Latitude and longitude are recorded in a special log file (called the GPGGA log) with a resolution of 0.0001 degree, while Earth-relative velocity is recorded in the GPRMC log with resolution of 0.1 m/s. Starting in January 2014 new logs (named BESTPOS and BESTVEL) have also been recorded to preserve more significant digits in the measurements. The BESTPOS log has a position resolution of <span class="math inline">10<sup> − 11</sup>deg </span>, while the BESTVEL log is recorded with 0.0001 m/s resolution.  

Some of the following variables are also available from alternate Garmin GPS16 receivers, for which the variable name is qualified by the name of that unit; e.g., GGLAT_GMN for GGLAT as measured by a Garmin GPS unit. In addition, some of the measurements from the GPS units that are part of the aircraft avionics systems are recorded; these are denoted by a suffix “_G” or “_A”. Measurements from before about 2000 used Trimble TANS-III receivers, <span id="punch3.3" label="punch3.3">[punch3.3]</span>with the ability to track up to 6 satellites at a time but needing only 4 to provide 3-dimensional position and velocity data (3 satellites for 2-dimensions). The accuracy of the position measurements for that unit was stated to be 25 meters (horizontal) and 35 meters (vertical) under “steady-state conditions.”^[The GPS signals at one time suffered from “selective availability,” a US DOD term for a perturbed signal that degraded GPS absolute accuracy to 100 meters. This was especially noticeable in the altitude measurement, so GALT normally was not useful. As of 1 May 2000, selective availability was deactivated to allow everyone to obtain better position measurements. See the Interagency GPS Executive Board web site for more information on selective availability and GPS measurements prior to 2000.]
Likewise, velocity measurements are within 0.2 m/s for all axes. Measurement resolution is that of 4-byte IEEE format (about 6 significant digits). All variables were provided by the Trimble receivers at 1 Hz.  

A special correction is needed for variables GGVEW, GGVNS, and GGVSPD, which measure the motion <em>at the GPS antenna</em> relative to the Earth. The conventional wind calculation addresses the difference between the motion at the radome (where the relative wind is measured) and the INS (where variables VEW, VNS, VSPD are measured) arising from rotation of the aircraft. However, if GGVSPD is used instead of VSPD for vertical wind or GGVEW and GGVNS are used (perhaps via the complementary filter) for the horizontal wind, an additional correction is needed for the displacement between the GPS antenna and the INS receiver. On the GV, this distance is -4.30 m. A correction for aircraft rotation is therefore applied to GGVSPD, as described below.  

#### GPS Latitude (<span class="math inline">º</span>): GGLAT, LAT_G; also formerly GLAT {#gglat .unnumbered}

<em>The aircraft latitude measured by a global positioning system.</em> Positive values are north of the equator; negative values are south. These variables are recorded in netCDF files as single-precision values. GGLAT is provided by the data-system GPS; LAT_G and LATF_G are from the avionics system GPS. LATF_G is a fine-resolution measurement that requires special processing.</p>

#### GPS Longitude (<span class="math inline">º</span>): GGLON, LON_G; also formerly GLON {#gglon .unnumbered}

<em>The aircraft longitude measured by a global positioning system.</em> Positive values are east of the prime meridian; negative are west. GGLON is provided by the (or a) data-system GPS; LON_G and LONF_G are from the avionics system GPS. LONF_G is a fine-resolution measurement that requires special processing. <span id="punch:3-12" label="punch:3-12">[punch:3-12]</span>  

#### GPS Ground Speed (m/s): GGSPD, GSF_G {#ggspd .unnumbered}

<em>The aircraft ground speed measured by a global positioning system.</em> GGSPD originates from a data-system GPS; GSF_G originates from an avionics-system GPS.  

#### GPS Ground Speed Vector East Component (m/s): GGVEW, VEW_G {#ggvew .unnumbered}

<em>The eastward component of ground speed measured by a global positioning system.</em> GGVEW originates from a data-system GPS; VEW_G originates from an avionics-system GPS. In the case of GGVEW, when this is used in the calculation of horizontal wind, the following correction would be needed:
\begin{equation}
\mathrm{\{GGVEWA\}}=\mathrm{\{GGVEW\}-L_G}\dot{\psi}\frac{\cos\psi}{\cos\phi}
(\#eq:GGVEWA)
\end{equation}  
where GGVEWA is the corrected value used in the wind calculation, , and $\psi$ and $\phi$ are respectively the heading and roll angles, <span class="math inline"><em>L</em><sub><em>G</em></sub> =  − 4.30</span> m for the GV, and $\dot{\psi}$ is the rate-of-change of heading (in radians). The variable BYAWR transmitted from the INS gives the rate-of-change of heading after conversion from <span class="math inline">$^{\circ}\thinspace s^{-1}$</span> to radians <span class="math inline"><em>s</em><sup> − 1</sup></span>. This correction is not applied in normal processing because the use of the complementary filter, discussed in Sect.\ \@ref(combining-irs-and-gps-measurements), makes it of negligible importance. More information is contained in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107.pdf">this memo</a>.  

#### GPS Ground Speed Vector North Component (m/s): GGVNS, VNS_G {#ggvns .unnumbered}

<em>The northward component of ground speed as measured by a global positioning system.</em> GGVNS originates from a data-system GPS; VNS_G originates from an avionics-system GPS. In the case of GGVNS, when this is used in the calculation of horizontal wind, the following correction would be needed:
\begin{equation}
\mathrm{\{GGVNSA\}} = \mathrm{\{GGVNS\}}+L_{G}\dot{\psi}\frac{\sin\psi}{\cos\phi}
(\#eq:GGVNSA)
\end{equation}  
where GGVNSA is the corrected value used in the wind calculation, $\psi$ and $\phi$ are respectively the heading and roll angles, <span class="math inline"><em>L</em><sub><em>G</em></sub> =  − 4.30</span> m for the GV, and $\dot{\psi}$ is the rate-of-change of heading (in radians). The variable BYAWR transmitted from the INS gives the rate-of-change of heading <span class="math inline"><em>ψ̇</em></span> after conversion from <span class="math inline">$^{\circ}\thinspace s^{-1}$</span> to radians <span class="math inline"><em>s</em><sup> − 1</sup></span>. This correction is not applied in normal processing because the use of the complementary filter, discussed in Sect.\ \@ref(combining-irs-and-gps-measurements), makes it of negligible importance, as discussed in the note referenced for GGVEW.  

#### GPS-Measured Aircraft Vertical Velocity (m/s): GGVSPD; also (obsolete) VSPD_G and GVZI {#ggvspd .unnumbered}

<em>The aircraft vertical velocity provided by a GPS unit.</em> Positive values are upward.<span id="punch3.9" label="punch3.9">[punch3.9]</span> When GGVSPD is used in the calculation of vertical wind, the following correction (omitted before 2017) is applied:<span id="punch:3-13" label="punch:3-13">[punch:3-13]</span>
\begin{equation}
\mathrm{\{GGVSPDA\}} = \mathrm{\{GGVSPD\}}-L_{G}\dot{\theta}
(\#eq:GGVSPDA)
\end{equation}
where <span class="math inline"><em>L</em><sub><em>G</em></sub> =  − 4.30</span> m for the GV and $\dot{\theta}$ is the rate-of-change of the pitch angle, corresponding to the IRU variable BPITCHR<span>*</span><span class="math inline"><em>π</em></span>/180. The variable GGVSPDA is used internally but not recorded in the data archives. See <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107.pdf">this memo</a> for additional justification.  

#### GPS Altitude (m MSL): GGALT, GALT_A {#ggalt .unnumbered}

<em>The aircraft altitude</em> <em>measured by a global positioning system.</em> The measurement is with respect to the geoid as represented internally by the GPS receiver and is determined by adding the adjustment --GGEOIDHT to the direct measurement relative to the ellipsoidal Earth model of the GPS, which is defined by WGS-84. Positive values are above the reference surface. GGALT originates from a data-system GPS; GALT_A originates from an avionics-system GPS. See the discussion of height at the beginning of this subsection and the variable GGEOIDHT below for interpretation of these GPS-based measurements.  

#### GPS Altitude above the WGS94 reference ellipse (m): GGHWGS {#gghwgs .unnumbered}

<em>The aircraft altitude above the ellipse that is the reference for the WGS-84 coordinate system.</em> This variable is defined as GGHWGS=GGALT<span class="math inline">+</span>GGEOIDHT.<span id="punch3.4-1" label="punch3.4-1">[punch3.4-1]</span>  

#### GPS Geopotential Altitude (m): GEOPTH {#geoph .unnumbered}

<em>The aircraft geopotential altitude above mean sea level.</em> If <span class="math inline"><em>g</em>(<em>z</em>, <em>λ</em>)</span> is the acceleration of gravity as represented by the formula in the Table of Constants in Section \@ref(constants-and-symbols), then the formula used for calculation of GEOPTH is obtained by integrating that formula from the reference surface for MSL (the geoid, <span class="math inline"><em>Δ</em></span> above the WGS84 reference ellipse) to the geometric altitude <span class="math inline"><em>H</em></span>, which is <span class="math inline"><em>H</em> + <em>Δ</em></span> above the reference ellipse. The result is normally close (within about 0.5 m) to that obtained with <span class="math inline"><em>Δ</em> = 0</span>. There are additional details in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/RecommendationReGEOPHT.pdf">this memo</a>.<br />
```{r child='GEOPTbox.Rmd'}
```

#### GPS Aircraft Track Angle (<span class="math inline">º</span>): GGTRK, TKAT_G {#ggtrk .unnumbered}

<em>The direction of the aircraft track (degrees clockwise from true north)</em> as measured by a data-system global positioning system (GGTRK) or an avionics-system GPS (TKAT_G)<em>.</em>  

#### GPS Height of the Geoid (m): GGEOIDHT {#ggeoidht .unnumbered}

<em>Height of geoid, approximating mean sea level, above the WGS-84 ellipsoid.</em> The height above mean sea level is found by subtracting this value from the height above the WGS-84 reference ellipse as provided by GPS-based measurements.<span id="punch3.4" label="punch3.4">[punch3.4]</span>  

#### GPS Satellites Tracked: GGNSAT {#ggnsat .unnumbered}

<em>The number of satellites tracked by a GPS unit.</em>  

#### GPS Quality Flag: GGQUAL {#ggqual .unnumbered} 

<em>GPS quality flag:</em><br />  
```{r child = 'GGQUALbox.Rmd'}
```

#### GPS Mode: GMODE (obsolete) {#gmode .unnumbered}

This is the former output from the Trimble GPS indicating the mode of operation. The normal value is 4, indicating automatic (not manual) mode and that the receiver is operating in 4-satellite (as opposed to fewer) mode.<span id="punch3.5" label="punch3.5">[punch3.5]</span>  

#### GPS Status: GGSTATUS, GSTAT_G, GSTAT {#ggstatus .unnumbered}

The status of the GPS receiver. A value of 1 indicates that the receiver is operating normally; a value of 0 indicates a warning regarding data quality. GGSTATUS indicates the status of the data-system GPS; GSTAT_G indicates the status of the avionics-system GPS. The obsolete variable GSTAT, formerly used for the same purpose, has the reverse meaning: A value of 0 indicates normal operation and any other code indicates a malfunction or warning regarding poor data accuracy.  

<span id="punch:3-14" label="punch:3-14">[punch:3-14]</span>

<!-- <h2 id="other-measurements-of-aircraft-altitude">Other Measurements of Aircraft Altitude</h2> -->

## Other Measurements of Aircraft Altitude {#other-measurements-of-aircraft-altitude}

#### Geometric Radio Altitude (m): HGM - (obsolete) {#hgm .unnumbered}

<em>The distance to the surface below the aircraft,</em> measured by a radar altimeter. The maximum range is 762m (2,500 ft). The instrument changes in accuracy at an altitude of 152 m: The estimated error from 152 m to 762 m is 7%, while the estimated error for altitudes below 152 m is 1.5 m or 5%, whichever is greater.  

#### Geometric Radar Altitude (Extended Range) APN-159 (APN-159) (m): HGME {#hgme-159 .unnumbered}

<em>The distance to the surface below the aircraft, measured by a radar altimeter.</em> There are two outputs from an APN-159 radar altimeter, one with coarse resolution (CHGME) and one with fine resolution (HGME). Both raw outputs cycle through the range 0-360 degrees, where one cycle corresponds to 4,000 feet for HGME and to 100,000 feet for CHGME. To resolve the ambiguity arising from these cycles, 4,000-foot increments are added to HGME to maintain agreement with CHGME. This preserves the fine resolution of HGME (1.86 m) throughout the altitude range of the APN-159.  

#### Geometric Radar Altitude (Extended Range) APN-232 (m): HGM232 {#hgm-232 .unnumbered}

<em>Altitude above the ground</em> as measured by an APN-232 radar altimeter.  

#### Height Above Terrain (m): ALTG {#altg .unnumbered}

<em>The aircraft altitude above the Earth’s surface</em> as represented by the next variable. If GGALT is the altitude above mean sea level, ALTG=GGALT<span class="math inline">−</span>SFC.  
 
#### Height of the Earth’s Surface (m MSL): SFC {#sfc .unnumbered}

<em>The altitude of the Earth’s surface</em> at a location directly below the aircraft. The data source is the Shuttle Radar Topography Mission of 2000. The height estimate is described in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/HeightOfTerrain.pdf">this memo</a>.  

#### Pressure-Damped Inertial Altitude (m): HI3 (obsolete) {#hi3 .unnumbered}

<em>The aircraft altitude obtained from the twice-integrated IRU acceleration (ACINS), pressure-adjusted to obtain long-term agreement with PALT.</em> Note that this variable has mixed character, producing short-term variations that accurately track the inertial system changes but with adjustment to the pressure altitude, which is not a true altitude. The variable is not appropriate for estimates of true altitude, but proves useful in the updating algorithm used with the LTN-51 INS for vertical wind. See the discussion of WP3. This variable is now obsolete.  

#### ISA Pressure Altitude (m): PALT {#palt .unnumbered}

<em>The geopotential altitude in the International Standard Atmosphere where the pressure is equal to the reference barometric (ambient) pressure (PSXC).</em>^[See “U.S. Standard Atmosphere, 1976”, NASA-TM-A-74335, available for download at <a href="http://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19770009539_1977009539.pdf">this URL</a>.]
The pressure altitude is best interpreted as a variable equivalent to the measured pressure, not as a geometric altitude. In the following description of the algorithm, some constants (identified by the symbol <span class="math inline"><em></em><sup>‡</sup></span>) are specified as part of the ISA and so should not be “improved” to more modern values such as those given in the table of constants in Section \@ref(constants-and-symbols) (e.g., <span class="math inline"><em>R</em><sub>0</sub><sup>‡</sup>).</span>^[Prior to and including some projects in 2010, processing used slightly different coefficients: for aircraft other than the GV, <span class="math inline"><em>T</em><sub>0</sub>/<em>λ</em></span> was represented by -43308.83, the reference pressure <span class="math inline"><em>p</em><sub>0</sub></span> was taken to be 1013.246, and the exponent <span class="math inline"><em>x</em></span> was represented numerically by 0.190284. For the GV, the value of <span class="math inline"><em>T</em><sub>0</sub>/<em>λ</em></span> was taken to be 44308.0, the transition pressure <span class="math inline"><em>p</em><sub><em>T</em></sub></span> was 226.1551 hPa, <span class="math inline"><em>x</em></span> = 0.190284, and coefficient <span class="math inline">$\frac{R_{0}^{\prime}T_{T}}{gM_{d}}$</span> was taken to be 6340.70 m instead of 6341.620 m as obtained below. The difference between these older values and the ones recommended below is everywhere less than 10 m and so is small compared to the expected uncertainty in pressure measurements, because 1 hPa change in pressure leads to a change in pressure altitude that varies from about 8–40 m over the altitude range of the GV.]
A note at <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PressureAltitude.pdf">this link</a> describes the pressure altitude in more detail and documents the change that was made in November 2010.<br />
```{r child = 'PALTbox.Rmd'}
```
<br />
<br />
<br />

#### Altitude, Reference (m MSL): ALTX (Obsolete), GGALTC (Obsolete) {#altx .unnumbered}

<span id="punch3.6" label="punch3.6">[punch3.6]</span> <em>Derived altitude above the geopotential surface,</em> obtained by combining information from a GPS receiver and an inertial reference system. This variable was intended to compensate for times when GPS reception was lost by incorporating information from the IRS measurement of altitude. GPS status measurements were used to detect signal loss, although sometimes this signal was delayed for a few seconds after the signal was lost. A 10-second running average was calculated of the difference between the GPS altitude and the reference altitude. When the sample-to-sample altitude difference changed more than 50 meters or when the GPS status detected a degraded signal, the derived variable (ALTX or GGALTC) became the alternate reference altitude adjusted by the latest running-average difference between that reference altitude and GGALT. When reception was recovered, to avoid a sudden discontinuity in altitude, the derived variable was adjusted back to the GPS altitude gradually over the next 10 seconds.<br />
<br />
This obsolete variable should be used with caution because the reference altitude used in past calculations was the IRS altitude updated to the pressure altitude of the aircraft. To account for the difference between pressure and geometric altitude, a regression equation was used, normally <span class="math inline"><em>z</em> = <em>a</em><sub>0</sub> + <em>a</em><sub>1</sub> * <em>P</em><em>A</em><em>L</em><em>T</em></span> where <span class="math inline"><em>a</em><sub>0</sub> =  − 46.3</span> m and <span class="math inline"><em>a</em><sub>1</sub> = 0.97866</span> but often adjusted dependent on project conditions. This introduced problems in early applications with the GV because it did not account for the pressure-altitude transition at the ISA tropopause. Use of a pressure altitude as reference introduces additional errors in altitude in regions that are not barotropic.<br />  

<!-- <h2 id="subsecirsgpscombining-irs-and-gps-measurements"><span id="subsec:IRS/GPS" label="subsec:IRS/GPS">[subsec:IRS/GPS]</span>Combining IRS and GPS Measurements</h2> -->

## Combining IRS and GPS Measurements {#combining-irs-and-gps-measurements}

Measurements from the global positioning and inertial navigation systems are combined to produce new variables that take advantage of the strengths of each, so that the resulting variables have the long-term stability of the GPS and the short-term resolution of the INS. This section describes some variables that result from this blending of variables. These corrected variables are usually the best available when the GPS and IRS are both functioning.  

One can determine if the GPS is functioning by examining the GPS status variables described in the previous section or by looking for spikes or “flat-lines” in the data. If the GPS data are missing for a short time (a few seconds to a minute), accuracy is not affected. However, longer dropouts will result in uncertainties degrading toward those of the INS. Without the GPS or another ground reference, the IRS error cannot be determined empirically, and one should assume that it is within the manufacturer’s specification (1 nautical mile of error per hour of flight, 90% CEP). When the GPS is active, RAF estimates that the correction algorithm produces a position with an error less than 1.5 m. <span id="punch3.7" label="punch3.7">[punch3.7]</span>Due to the nature of the algorithm, the error will increase from about 1.5 meters to the INS specification in about one-half hour after GPS information is lost.  

#### GPS-Corrected Inertial Ground Speed Vector (m/s):  VEWC, VNSC {#vewc-vnsc .unnumbered}

These variables result from combining GPS and INS output of the east and north components of ground speed from a complementary-filter algorithm.<span id="compFilter" label="compFilter">[compFilter]</span> Positive values are toward the east and north, respectively. The smooth, high-resolution, continuous measurements from the inertial navigation system, {VNS, VEW}, which can slowly accumulate errors over time, are combined with the measurements from the GPS, {GVNS, GVEW}, which have good long-term stability, via an approach based on a complementary filter. A low-pass filter, <span class="math inline"><em>F</em><sub><em>L</em></sub>({<em>G</em><em>V</em><em>N</em><em>S</em>, <em>G</em><em>V</em><em>E</em><em>W</em>})</span>, is applied to the GPS measurements of groundspeed, which are assumed to be valid for frequencies at or lower than the cutoff frequency <span class="math inline"><em>f</em><sub><em>c</em></sub></span> of the filter. Then the complementary high-pass filter, denoted (<span class="math inline">1 − <em>F</em><sub><em>L</em></sub></span>)(<span class="math inline">{<em>V</em><em>N</em><em>S</em>, <em>V</em><em>E</em><em>W</em>}</span>), is applied to the IRS measurements of groundspeed, which are assumed valid for frequencies at or higher than <span class="math inline"><em>f</em><sub><em>c</em></sub></span>. Ideally, the transition frequency would be selected where the GPS errors (increasing with frequency) are equal to the IRS errors (decreasing with frequency).<br />
<br />
The procedure is use now is documented in the <a href="http://dx.doi.org/10.5065/D60G3HJ8">Technical Note on Wind Uncertainty</a>, beginning on p. 125. It is a three-pole Butterworth low-pass filter, originally coded following the algorithm described in Bosic, S. M., 1980: <em>Digital and Kalman filtering : An Introduction to Discrete-Time Filtering and Optimum Linear Estimation,</em> p. 49. As described in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/checkCompFilter.pdf">this memo</a>, it has been revised (2014) to use coefficients generated by the R routine “butter().” The digital filter used is recursive, not centered, to permit calculation during a single pass through the data. If the cutoff frequency lies where both the GPS and INS measurements are almost the same, then the detailed characteristics of the filter (e.g., phase shift) in the transition region do not matter because the complementary filters have canceling effects when applied to the same signal. The transition frequency <span class="math inline"><em>f</em><sub><em>c</em></sub></span> was chosen to be (1/600) Hz. The Butterworth filter was chosen because it provides flat response away from the transition.^[For historical reasons, the details of the now obsolete filter as originally coded and used for many years are described here. For the current version with coefficients, see the memo referenced above.]<br />
 
```{r child="CF14box.Rmd"}
```
  
The net result then is the sum of these two filtered signals, calculated as described in the following boxes:  
```{r child="CFbox.Rmd"}
```
  
This result is used as long as the GPS signals are continuous and flagged as being valid. When that is not the case, some means is needed to avoid sudden discontinuities in velocity (and hence wind speed), which would introduce spurious effects into variance spectra and other properties dependent on a continuously valid measurement of wind. To extrapolate measurements through periods when the GPS signals are lost (as sometimes occurs, for example, in turns) a fit is determined to the difference between the best-estimate variables {VNSC,VEWC} and the IRS variables {VNS,VEW} for the period before GPS reception was lost, and that fit is used to extrapolate through periods when GPS reception is not available. The procedure is as described below.<br />
<span id="punch:3-15" label="punch:3-15">[punch:3-15]</span>  

<p class=box>
\ 1. If GPS reception has never been valid earlier in the flight, use the INS values without correction.<br>  
\ 2. Whenever both GPS and INS are good, update the low-pass-filtered estimate of the difference between them. This is added to the INS measurement to obtain the corrected variable. Also update a least-squares fit to the difference between the GPS and INS groundspeeds, for each component. The errors are assumed to result primarily from a Schuler oscillation, so the three-term fit is of the form $\Delta=a_1+a_2\sin(\Omega_{Sch}t)+a_3\cos(\Omega_{Sch}t)$, where $\Omega_{Sch}$  is the angular frequency of the Schuler oscillation (taken to be $2\pi/5067$\ s, and $t$ is the time since the start of the flight. A separate fit is used for each component of the velocity and each component of the position (discussed below under LATC and LONC). The fit matrix used to determine these coefficients is updated each time step but the accumulated fit factors decay exponentially with a 30-min decay constant, so the terms used to determine the fit are exponentially weighted over the period of valid data with a time constant that decays exponentially into the past with a characteristic time of 30 min. This is long enough to determine a significant portion of the Schuler oscillation but short enough to emphasize recent measurements of the correction.<br><br>
\ 3. When GPS data become invalid, if sufficient data (spanning 30 min) have been accumulated, invert the accumulated fit matrices to determine the coefficients {$a_1,a_2,a_3$} and then use the formula for $\Delta$ in the preceding step to extrapolate the correction to the IRS measurements while the GPS measurements remain invalid. Doing so immediately would introduce a discontinuity in {VNSC,VEWC}, however, so the correction $\Delta$ is introduced smoothly by adjusting {VNSC, VEWC} as follows: If $dvy$ is the adjustment added to the INS measurement, adjust it according to
$dvy^\prime=\eta\ dvy+(1-\eta)\Delta$ where $dvy^\prime$ is the sequentially adjusted correction and $\eta=0.995$ s$^{-1}$ is chosen to give a decaying transition with a time constant of about 5.5 min. This has the potential to introduce some artificial variance at this scale and so should be considered in cases where variance spectra are analyzed in detail, but it has much less influence on such spectra than a discontinuous transition would. Ideally, the current fit and the last filtered discrepancy (VNSC~0~$-$GVNS~0~ should be about equal, so transitioning between them should not introduce a significant change.<br><br>
\ 4. To avoid transients that would result from switching abruptly to the complementary-filter solution when the GPS measurements again become valid, the correction factors (e.g., $dvy$) are also updated smoothly toward the complementary-filter solution, using for example $dvy^\prime=\eta\ dvy+(1-\eta)F_L(v_y^{GPS}-v_y^{IRS})$ where $F_L$ is the low-pass filter and $v_y$ is the northward component of aircraft groundspeed.
</p>

#### GPS-Corrected Inertial Latitude and Longitude (<span class="math inline">º</span><strong>): LATC, LONC {#latc-lonc .unnumbered}

<em>Combined GPS and IRS output of latitude and longitude.</em> Positive values are north and east, respectively.<span id="punch:3-16" label="punch:3-16">[punch:3-16]</span> These variables are the best estimate of position, obtained by the following approach:<br />  
```{r child='LATLONbox.Rmd'}
```

<!-- <strong><span class="underline"></span></strong><br />   -->


<!--chapter:end:Section3.Rmd-->

# The State of the Atmosphere {#the-state-of-the-atmosphere}

## Information on Instruments and Calibrations

The instruments used to collect the measurements that lead to the variables in this section are described on the EOL web site, in the “State Parameters” section at <a href="http://www.eol.ucar.edu/aircraft-instrumentation">this URL</a>. The data acquisition and processing for these variables and the calibration coefficients used where applicable are described .
 
## Variable Names

Measurements of some meteorological state variables like pressure, temperature, and water vapor pressure may originate from multiple sensors mounted at various locations on an aircraft. To distinguish among similar measurements, many variable names incorporate an indication of where the measurement was made. In this document, locations in variable names are represented by “x”, where “x” may be one of the following:
<center>
```{r, include = TRUE, echo = FALSE}
A.id <- data.frame(Character=c('B', 'B', 'F', 'G', 'R', 'T', 'W'))
A.id$location = c('bottom (or bottom-most)', 
              '(obsolete) boom',
              'fuselage',
              '(obsolete) gust probe',
              'radome',
              'top (or top-most)',
              'wing')
knitr::kable(A.id, align=c('c','l')) %>% kable_styling(bootstrap_options = 'bordered') %>%
  scroll_box(width='50%')
```
</center>
  
In addition, a true letter ’X’ (not replaced by the above letters) may be appended to a measurement to indicate that it is the preferred choice among similar measurements and is therefore used to calculate derived variables that depend on the measured quantity. Other suffixes sometimes used to distinguish among measurements are these: ’D’ for a digital sensor; ’H’ for a heated (usually, anti-iced) sensor, ’L’ for port-side sensors, and ’R’ for starboard-side sensors.  

## Pressure

### Standard Pressure Measurements

#### Static or Ambient Pressure (hPa): PSx, PSxC, PS_A, PSX, PSXC, PSFD, PSFRD {-#psx}

<em>The atmospheric pressure at the flight level of the aircraft, measured by a calibrated absolute (barometric) transducer at location x.</em> PSx is the measured static or ambient pressure before correction, and it may be affected by local flow-field distortion. PS_A is the pressure measurement taken from the avionics system on the aircraft, processed via unknown algorithms in the avionics system that may smooth, correct, and perhaps delay the result. PSxC is PSx corrected for local flow-field distortion (see <a href="https://opensky.ucar.edu/islandora/object/archives%3A8150">RAF Bulletin #21</a> and the discussion in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PCOR.pdf">this memo</a> and <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PcorCalculation.pdf">this supplement</a>), and PSXC is the preferred corrected measurement used for derived calculations. These measurements have been made using various sensors, so it is best to consult the project documentation for the transducer used. Recent measurements from both the C-130 and the GV have been made using a Paroscientific Model 1000 Digiquartz Transducer.

Corrections to the pressures have been determined by reference to some standard, including a “trailing cone” sensor, the pressure PS_A from the cockpit avionics system, or (since 2012) the Laser Air Motion Sensing System (LAMS). The latter correction is discussed in the memo <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PCOR.pdf">referenced above</a>, where corrections used prior to 2011 are also discussed. Beginning in 2012, the deduced corrections <span class="math inline"><em>Δ</em><em>p</em></span> to the measured pressures as functions of dynamic pressure <span class="math inline"><em>q</em>,</span> angle of attack <span class="math inline"><em>α</em>,</span>^[A weakness is this form for the pressure correction is that occasionally the radome ports become plugged with ice and the measurement of angle of attack is not available. When the variable ATTACK representing angle of attack is invalid, the angle of attack is instead calculated from PITCH<span class="math inline">−</span>VSPD/TASX, which approximates the angle of attack if the vertical wind is zero.]
and the Mach number <span class="math inline"><em>M</em></span> are described by the following equations and coefficients:

<blockquote>
<p><strong>For the C-130,</strong>^[For C-130 measurements prior to 2012 but after September 2003, the correction applied to PSF was <span class="math inline"><em>Δ</em><em>p</em> = <em>p</em> + max ((3.29 + {<em>Q</em><em>C</em><em>X</em>} * 0.0273),</span>4.7915) using units of hPa. Prior to Sept 2003, the correction was <span class="math inline"><em>Δ</em><em>p</em> = max ((4.66 + 11.4405<em>Δ</em><em>p</em><sub><em>α</em></sub>/<em>Δ</em><em>q</em><sub><em>r</em></sub></span>), 1.113). For both PSFD and PSFRD, the correction prior to (2012?) was <span class="math inline"><em>Δ</em><em>p</em> = <em>p</em> + max ((3.29 + {<em>Q</em><em>C</em><em>X</em>} * 0.0273),</span>4.7915). For GV measurements Aug 2006 to 2012, <span class="math inline"><em>Δ</em><em>p</em>=</span> (-1.02 + 0.1565<span>*</span>q) + q1<span>*</span>(0.008 + q1<span>*</span>(7.1979e-09<span>*</span>q1 - 1.4072e-05). Before Aug 2006: <span class="math inline"><em>Δ</em><em>p</em>=</span>(3.08 - 0.0894<span>*</span>{PSF}) + {QCF}<span>*</span>(-0.007474 + {QCF}<span>*</span>4.0161e-06).]
\begin{equation}
\frac{\Delta p}{p_{m}}=d_{0}+\frac{q_{m}}{p_{m}}(d_{1}+d_{4}\frac{\alpha^{2}}{a_{r}^{2}})+d_{2}\frac{\alpha}{a_{r}}+d_{3}\thinspace M
(\#eq:PCORC130)
\end{equation}
  
where, for <span class="math inline"><em>p</em><sub><em>m</em></sub></span> = PSFD , <span class="math inline"><em>q</em><sub><em>m</em></sub></span> = dynamic pressure (QCF), <span class="math inline"><em>α</em> = <em>A</em><em>T</em><em>T</em><em>A</em><em>C</em><em>K</em></span> and <span class="math inline"><em>a</em><sub><em>r</em></sub> = 1<sup>∘</sup></span> (included to keep the equation and coefficients dimensionless), and {<span class="math inline"><em>d</em><sub>0</sub>, <em>d</em><sub>1</sub>, <em>d</em><sub>2</sub>, <em>d</em><sub>3</sub>, <em>d</em><sub>4</sub></span>} = {-4.389e-03, -2.966e-02, -6.831e-05, 2.672e-02, 2.4466e-03}. For PSFRD, the corresponding coefficients are {0.007372, 0.12774, <span class="math inline">−</span>6.8776e-4, <span class="math inline">−</span>0.02994, 0.001630}. The latter coefficients are significantly different from the coefficients for PSFD, but the static ports where PSFRD is measured are at a different location on the fuselage so different flow-distortion effects are expected.</p>
</blockquote>

<br />

<blockquote>
<p><strong>For the GV,</strong>^[See <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PCOR.pdf">this memo</a> and <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PcorCalculation.pdf">this revision</a>for details regarding implementation of this representation of <span class="math inline"><em>Δ</em><em>p</em></span> for the GV.]
\begin{equation}
\frac{\Delta p}{p}=a_{0}+a_{1}\frac{q}{p}+a_{2}M^{3}+a_{3}\frac{\alpha}{a_{r}}
(\#eq:PCORforGV)
\end{equation}  
where, for <span class="math inline"><em>p</em></span> = PSF, <span class="math inline"><em>q</em></span> = QCF, <span class="math inline"><em>α</em> = <em>A</em><em>T</em><em>T</em><em>A</em><em>C</em><em>K</em></span>, and <span class="math inline"><em>a</em><sub><em>r</em></sub> = 1<sup>∘</sup></span> (included to keep the equation and coefficients dimensionless) {<span class="math inline"><em>a</em><sub>0</sub>, <em>a</em><sub>1</sub>, <em>a</em><sub>2</sub>, <em>a</em><sub>3</sub></span>} = {<span class="math inline"> − 0.012255</span>, <span class="math inline">0.075372</span>, <span class="math inline"> − 0.087508</span>, <span class="math inline">0.002148</span>}}.<span id="punch:4-10" label="punch:4-10">[punch:4-10]</span></p>
</blockquote>
<p><br />
<br />
In equations \@ref(eq:PCORC130) and \@ref(eq:PCORforGV) the Mach number is calculated from the uncorrected measurements of <span class="math inline"><em>p</em></span> and <span class="math inline"><em>q</em></span>, using dry-air values for <span class="math inline"><em>R</em></span>, <span class="math inline"><em>c</em><sub><em>v</em></sub></span> and <span class="math inline"><em>c</em><sub><em>p</em></sub></span>, via  
\begin{equation}
M=\left\{ \left(\frac{2c_{v}}{R}\right)\left[\left(\frac{p+q}{p}\right)^{R/c_{p}}-1\right]\right\}^{1/2}\,\,\,.
(\#eq:MachEquation)
\end{equation}  

For additional information on these correction coefficients, see <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/ARISTO-LAMS.pdf">this note</a> and Cooper et al. (2014).^[<a href="http://www.atmos-meas-tech.net/7/3215/2014/">Atmos. Meas. Tech., 7, 3215-3231</a>, 2014 doi:10.5194/amt-7-3215-2014.]
<br />

#### Dynamic Pressure (hPa): QCx, QCxC, QCX, QCXC, QC_A {-#qcx}

<em>The pressure excess caused by bringing the airflow to rest relative to the aircraft.</em> These quantities represent the difference between the total pressure <span class="math inline"><em>p</em><sub><em>t</em></sub></span> as measured at the inlet of a pitot tube or other forward-pointing port and the ambient pressure that would be present in the absence of motion through the air. The variable QC_A is provided by the avionic data system and is subject to an unknown delay and smoothing. The variables ending in “C” have been corrected for flow-distortion effects, mostly arising from errors in the measurement of static pressure. Since 2012, the corrections are based on measurements from the LAMS system as described for PSxC, and they have the same functional form as in \@ref(eq:PCORC130) and
\@ref(eq:PCORforGV) except that the correction applied to <span class="math inline"><em>q</em></span> is <span class="math inline"> − <em>Δ</em><em>p</em></span> with reversed sign because <span class="math inline"><em>q</em> = <em>p</em><sub><em>t</em></sub> − <em>p</em><sub><em>a</em></sub></span> and the error arises primarily from the error in <span class="math inline"><em>p</em><sub><em>a</em></sub></span>. The same correction is applied to QCR because it is also measured relative to the static pressure ports so errors in the pressure sensed at those ports affect QCR in the same way that QCF is affected. <span id="punch4.3" label="punch4.3">[punch4.3]</span>See the notes referenced in the preceding section, and also <a href="https://opensky.ucar.edu/islandora/object/archives%3A8150">RAF Bulletin 21</a> for the corrections applied to earlier data files.[^fnlabelspecial]

[^fnlabelspecial]: *C-130*, prior to 2012: For QCFC: subtract  max(4.66+11.4405 * $\mathrm{\{ADIFR\}}$ / $\mathrm{\{QCR\}}$, 1.113); For QCFRC prior to Sept 2003: same as for QCFC; after/including Sept 2003, subtract max(3.29+$\mathrm{\{QCX\}}$ * 0.0273,  4.7915); For QCRC: subtract max((3.29+$\mathrm{\{QCX\}}$ * 0.0273), 4.7915). *GV* Aug 2006 to 2012: For QCF, subtract (1.02+$\mathrm{\{PSF\}}$(0.215 - 0.04 * $\mathrm{\{QCF\}}$/1000.) + {QCF} * ($-0.003266$ + $\mathrm{\{QCF\}}$ * 1.613e-06)) 
<!-- <span id="punch4.2">  (punch4.2)</span> -->



A Rosemount Model 1221 differential pressure transducer is used for current measurements of dynamic pressure on the C-130, and a Honeywell PPT transducer is used on the GV.<span id="punch4.1" label="punch4.1">[punch4.1]</span> This measurement enters the calculation of true airspeed and Mach number and so is needed to calculate many derived variables.<br />
<br />
In the case of QCRC from the GV, one additional correction is applied (beginning 2017). The uncorrected measurement QCR is affected by flow angles, while QCF is not (for modest angle of attack or sideslip), so an additional adjustment is needed. The needed correction can be found by using an empirical relationship matching QCR to QCF, which leads to the following equation:  
\begin{equation}
\mathrm{\{QCR\}}=b_0+b_1\mathrm{\{QCR\}}+b_2\mathrm{\{AKRD\}}^2+b_3\mathrm{\{SSRD\}}^2-\Delta p
(\#eq:PCORforQCR)
\end{equation}

where $\Delta p$ is given by \@ref(eq:PCORforGV) and the coefficients are {<span class="math inline"><em>b</em><sub>0 − 3</sub></span>}={<span class="math inline"> − 0.5635</span>, <span class="math inline">0.9982</span>, 0.0273, <span class="math inline">0.0562</span>}. Some justification for this correction is contained in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107b.pdf">this note.</a> A similar correction is not made for measurements from the C-130 radome because they do not appear to be necessary, as discussed in that note.<br />

#### D-Value (m): DVALUE {-#dvalue}

The difference between geopotential altitude and pressure altitude (m). This variable is calculated from {GEOPHT}<span class="math inline">−</span>{PALT} and, for appropriate flight segments, can be used to measure height gradients on a constant-pressure surface. Prior to 2018, this was calculated from {GGALT} – {PALT}.</p>

### Special Pressure Measurements (hPa): PSDPx, CAVP, PCAB, PSURF {-#p-special}

<em>PSDPx and CAVP_x are measurements of the pressure in the housing of the dew-point sensors,</em> as discussed in connection with DPxC. <em>PCAB is a measurement of the pressure in the cabin of the aircraft. PSURF is the estimated surface pressure</em> calculated from HGME (a radar-altimeter measurement of height), TVIR, PSXC<span id="punch:4-11" label="punch:4-11">[punch:4-11]</span>, and MR using the thickness equation. [TVIR](#TVIR) and [MR](#MR) are described later in this section, and [HGME](#HGME) was described in Section \@ref(other-measurements-of-aircraft-altitude). The average temperature for the layer is obtained by using HGME and assuming a dry-adiabatic lapse rate from the flight level to the surface. Because of this assumption, the result is only valid for flight in a well-mixed surface layer or in other conditions in which the temperature lapse rate matches the dry-adiabatic lapse rate.^[The symbol <span class="math inline"><em></em><sup>†</sup></span> indicates that values are included in the table of constants in Sect.\ \@ref(constants-and-symbols).]
<br />
</p>  

```{r child='PSURFbox.Rmd'}
```

<!-- <h2 id="temperature">Temperature</h2> -->
## Temperature {#temperature-section}

#### Recovery Temperature (<span class="math inline">º</span>C): RTx, RTxH, RTHRx, RTX {-#recovery-t}

<em>The recovery temperature is the temperature sensed by a temperature probe that is exposed to the atmosphere.</em> In flight, the temperature is heated above the ambient temperature because it senses the temperature of air near the sensor that has been heated adiabatically during compression as it is brought near the airspeed of the aircraft. These variables are the measurements of that recovery temperature from calibrated temperature sensors at location x, for processing prior to about 2012; more recently, the names are simply RTF\# or RTH\# where \# is a number starting with 1.^[Prior to 2012, these variables were called “total temperature” and symbols starting with ’TT’ instead of ’RT’ were used. That name was misleading because these values are not true total-temperature measurements, for which the air would be at the same speed as the aircraft, but instead recovery-temperature measurements. The name has been changed to correct this mis-labeling, although this was a long-standing convention in past datasets.]
For Rosemount or HARCO temperature probes in current use, the recovery temperature is near the total temperature, but all probes must be corrected to obtain either true total temperature or true ambient temperature. In the standard output, the variable name also conveys the sensor type: RTF\# or RTx is a measurement from a Rosemount Model 102 non-deiced temperature sensor, RT\#H or RTxH is the measurement from a Rosemount Model 102 anti-iced (heated) temperature sensor, and RTH\# or RTHx is the measurement from a HARCO heated sensor. Some past experiments also used a reverse-flow temperature housing and a fast-response “K” housing; the associated variable names for these probes were TTRF and TTKP.^[See the related obsolete variables TTx, which are previously used names for these variables. The names were changed to clarify that the quantity represented is the recovery temperature, not the total temperature.]
</p>

#### Ambient Temperature (<span class="math inline"><em></em><sup>∘</sup></span>C): ATx, ATX, ATxH, ATxD {-#ambient-t}

<em>The temperature of the atmosphere at the location of the aircraft, as it would be measured by a sensor at rest relative to the air.</em> {#ATX} 
The ’x’ in the name of the variable used for ambient temperature, ATx, conveys the same information regarding sensor type and location as the variable name used with total (recovery) temperature. See the discussion above regarding RTx. The ambient temperature (also known as the static air temperature) is calculated from the measured recovery temperature, which is increased above the ambient temperature by dynamic heating caused by the airspeed of the aircraft. The calculated temperature therefore depends on the recovery temperature RTx as well as the dynamic and ambient pressure, usually respectively QCXC and PSXC. The ambient and dynamic pressures are first corrected from the raw measurements QCX and PSX to obtain variables that account for deviations caused by airflow around the aircraft and/or position-dependent systematic errors, as discussed in the section describing PSxC. The following basic equations are developed on the basis of conservation of energy for a perfect gas undergoing an adiabatic compression.<br />
<br />
This section combines discussion of the calculations of temperature and airspeed, to reflect the linkage between these derived measurements. To provide accuracy in the equations, this discussion considers effects of the humidity of the air on characteristics like the gas constant and the specific heats. Most archived data before 2012 used values for dry air, although a special variable TASHC has been used to represent the true airspeed in cases where the correction was significant. That variable is based on a good approximation to the results from the following equations; see the discussion of TASHC later in this section. TASHC is now considered an obsolete variable. New variables ATxD and TASxD have been introduced that neglect the humidity corrections and perform all calculations as if the humidity is negligible.<br />
<br />  
As discussed above, temperature sensors on aircraft that are exposed to the airflow do not measure the total temperature but rather the temperature of the air immediately in contact with the sensing element. This air will not have undergone an adiabatic deceleration completely to zero velocity and hence will have a temperature <span class="math inline"><em>T</em><sub><em>r</em></sub></span> somewhat less than the total temperature <span class="math inline"><em>T</em><sub><em>t</em></sub></span> that would require the air to reach zero velocity. <span class="math inline"><em>T</em><sub><em>r</em></sub></span> is the measured or “recovery” temperature., The ratio of the actual temperature difference attained to the temperature difference relative to the total temperature is defined to be the “recovery factor” $\alpha_r$:
\begin{equation}
\alpha_{r}=\frac{T_{r}-T_{a}}{T_{t}-T_{a}}
(\#eq:alphar)
\end{equation}
where $T_a$ is the ambient air temperature. From conservation of energy:  
\begin{equation}
\frac{U_{a}^{2}}{2}+c_{p}^{\prime}T_{a}=\frac{U_{r}^{2}}{2}+c_{p}^{\prime}T_{r}=\frac{U_{t}^{2}}{2}+c_{p}^{\prime}T_{t}
(\#eq:Ua)
\end{equation}
where primes on quantities like <span class="math inline"><em>c</em><sub><em>p</em></sub><sup>′</sup></span>, or (below) <span class="math inline"><em>c</em><sub><em>v</em></sub><sup>′</sup></span> and <span class="math inline"><em>R</em><sup>′</sup></span> denote properties of moist air, respectively the specific heat at constant pressure, specific heat at constant volume, and gas constant.<br />  
<p class=box>
**Moist-Air Considerations**  <br><br>
Primes on the symbols denote that these values should be moist-air
values, appropriately weighted averages of the dry-air and water-vapor
contributions. The practice prior to 2014 was to use the dry-air values
for specific heats and the gas constant, except as described in connection
with TASHC below. Since 2014, calculations use the appropriate values
for moist air, except that to avoid errors introduced by unrealistically
high measurements of humidity the humidity correction was limited
to be less than or equal to the equilibrium value at the measured
temperature. The formulas used for the specific heats and gas constant
of moist air in terms of the water vapor pressure $e$, the specific
heats for dry air ($c_{pd}=\frac{7}{2}R_{0},\,c_{vd}=\frac{5}{2}R_{0}$)
and water vapor ($c_{pw}=4R_{0},\,c_{vw}=3R_{0}$), and the ratio
of molecular weights ($\epsilon=M_{W}/M_{d}$) are those of Khelif
et al.\ 1999:  
\begin{equation}
R^{\prime}=R_{d}/[1+(\epsilon-1)\frac{e}{p}]
\end{equation}
\begin{equation}
c_{v}^{\prime} = \frac{(p-e)R^{\prime}}{pR_{d}}\frac{5R_{0}}{2M_{d}}+\frac{eR^{\prime}}{pR_{w}}\frac{3R_{0}}{M_{w}}=c_{vd}\frac{R^{\prime}}{R_{d}}\left(1+\frac{1}{5}\frac{e}{p}\right)
(\#eq:cvMoist)
\end{equation}
\begin{equation}
c_{p}^{\prime} = c_{pd}\frac{R^{\prime}}{R_{d}}\left(1+\frac{1}{7}\frac{e}{p}\right)
(\#eq:cpMoist)
\end{equation}
\begin{equation}
\gamma\,^{\prime} = \gamma_{d}\frac{1+\frac{1}{7}\frac{e}{p}}{1+\frac{1}{5}\frac{e}{p}}
(\#eq:gammaMoist)
\end{equation}  
See also the discussion of TASHC in section XX
and the reference there for Khelif et al.\ 1999.  
</p>  
In \@ref(eq:Ua) <span class="math inline">{<em>U</em><sub><em>a</em></sub>, <em>U</em><sub><em>r</em></sub>, <em>U</em><sub><em>t</em></sub>}</span> are respectively the aircraft true airspeed, the airspeed relative to the aircraft of the air in thermal contact with the sensor, and the airspeed of air relative to the aircraft when fully brought to the motion of the sensor (i.e., zero). Then, from \@ref(eq:Ua)  \begin{equation}
T_{a}=T_{r}-\alpha_{r}\frac{U_{a}^{2}}{2c_{p}^{\prime}}
(\#eq:Tair)
\end{equation}  
<br /> The temperature sensors used on RAF aircraft are designed to decelerate the air adiabatically to near zero velocity. Recovery factors determined from wind tunnel testing for the Rosemount sensors are approximately 0.97 (unheated model) and 0.98 (heated models).^[The recovery factor determined for the now-obsolete NCAR reverse-flow sensor was 0.6. The recovery factor for the now retired NCAR fast-response (K-probe) temperature sensor was 0.8.]
These values have also been confirmed from flight maneuvers, often from “speed runs” where the aircraft is flown level through its speed range and the variation of recovery temperature with airspeed is used with \@ref(eq:Tair), with the assumption that <span class="math inline"><em>T</em><sub><em>a</em></sub></span> remains constant, to determine the recovery factor. Data files and project reports normally document what recovery factor was used for calculating the true airspeed and ambient temperature for a particular project.<br />
<br />
Because the values used in processing have varied, the project reports should be consulted to find what was used for particular projects. The Goodrich Technical Report 5755<span id="punch:4-4" label="punch:4-4">[punch:4-4]</span> documents wind-tunnel testing of the probes formerly made by Rosemount. Their plot showed that, for heated sensors, there is a significant variation with Mach number (<span class="math inline"><em>M</em></span>); cf their Eq.\ (38). The dependence in their plot is represented well by the following equations, where $\alpha_r^{[h]}$ refers to heated probes and $\alpha_r^{[u]}$ to unheated probes:  
\begin{equation}
\alpha_r^{[h]} = 0.988+0.053(\log_{10}M)+0.090(\log_{10}M)^2+0.091(\log_{10}M)^3
(\#eq:alphah)
\end{equation}
\begin{equation}
\alpha_r^{[u]}=0.9959+0.0283(\log_{10}M)+0.0374(\log_{10}M)^2+0.0762(\log_{10}M)^3
(\#eq:alphau)
\end{equation}  
Some studies of the recovery factor are discussed further in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/RecoveryFactorStudy.pdf">this memo</a>.<br />
<br />
The true airspeed $U_a$ is used in \@ref(eq:Tair) to calculate the ambient temperature $T_a$. However, the ambient temperature is also needed to calculate the true airspeed. Therefore the constraints imposed on ambient temperature and true airspeed by the measurements of recovery temperature, total pressure (the pressure measured by a pitot tube pointed into the airstream and assumed to be that obtained when the incoming air is brought to rest relative to the aircraft), and ambient pressure must be used to solve simultaneously for the two unknowns, temperature and airspeed.<br />
<br />
The relationship is conveniently derived by first calculating the dimensionless Mach number $M$, which is the ratio of the airspeed to the speed of sound $U_{s}=\sqrt{\gamma^{\prime}R^{\prime}T_{a}}$, where $\gamma^\prime$ is the ratio of specific heats of (moist) air, $c_p^\prime /c_v^\prime$ and $R^\prime$ is the gas constant for moist air. The Mach number is a function of air temperature only and can be determined as follows:  

a). Express energy conservation, as in \@ref(eq:Tair), in the form  
\begin{equation}
d\left(\frac{U^{2}}{2}\right)+c_{p}^{\prime}dT=0\,\,\,\,.
(\#eq:econ)
\end{equation}  
where the total derivatives apply along a streamline as $U$ changes from $U_a$ to $U_t=0$ and $T$ changes from $T_a$ to $T_t$.  
b). Use the perfect gas law to replace $dT$ with $\frac{pV}{nR}(\frac{dV}{V}+\frac{dp}{p})$ where $V$ and $p$ are the volume and pressure of a parcel of air. Then use the expression for adiabatic compression in the form $pV^\gamma = \mathrm{constant}$ to replace the derivative $\frac{dV}{V}$ with $-\frac{1}{\gamma}\frac{dp}{p}$, leading to $dT=\frac{R^{\prime}T}{c_{p}^{\prime}}\frac{dp}{p}$ or, after integration, $T(p)=T_{a}\left(\frac{p}{p_{a}}\right)^{R^{\prime}/c_{p}^{\prime}}$. Using this expression for $T$ in the formula for $dT$ and then integrating both total derivatives in \@ref(eq:econ) along the streamline leads to  
\begin{equation}
\frac{U_{a}^{2}}{2}+c_{p}^{\prime}T_{a}=c_{p}^{\prime}T_{a}\left(\frac{p_{t}}{p_{a}}\right)^{\frac{R^{\prime}}{c_{p}^{\prime}}}
(\#eq:Ua2)
\end{equation}  
where $p_t$ is the total pressure (i.e., PSXC+QCXC) and
$p_a$ is the ambient pressure (PSXC).  
c). Use the above definition of the Mach number $M$ ($M=U_a/U_s$) in the form
$U_a^2=\gamma^\prime M^2 R^\prime T_a$ to obtain:  
\begin{equation}
M^{2}=\left(\frac{2c_{v}^{\prime}}{R^{\prime}}\right)\left[\left(\frac{p_{t}}{p_{a}}\right)^{\frac{R^{\prime}}{c_{p}^{\prime}}}-1\right]
(\#eq:M2)
\end{equation}  
which is the same as \@ref(eq:MachEquation). This equation shows that $M$ can be found from measurements of $p_t$ and $p_a$ alone, except for the moist-air corrections.  

d). Use the expression for ambient temperature in terms of recovery temperature and airspeed, \@ref(eq:Tair), to obtain the temperature in terms of the Mach number and the recovery temperature:  
\begin{align}
T_{a} & = T_{r}-\alpha_{r}\frac{U_{a}^{2}}{2c_{p}^{\prime}}=T_{r}-\alpha_{r}\frac{M^{2}\gamma^{\prime}R^{\prime}T_{a}}{2c_{p}^{\prime}}\notag\\  
& = \frac{T_{r}}{1+\dfrac{\alpha_{r}M^{2}R^{\prime}}{2c_{v}^{\prime}}}  
(\#eq:TaEQ)
\end{align}
<br /><br />  
e). Express the true airspeed $U_a$ as  
\begin{equation}
U_{a}=M\sqrt{\gamma\,^{\prime}R^{\prime}T_{a}}
(\#eq:UaFinal)
\end{equation}  

Then the temperature is found as described in the following box:^[A problem sometimes arises from use of the measured humidity, because that measurement might be obviously in error. For example, following descents the dew point determined from chilled-mirror hygrometers sometimes overshoots the correct value significantly, producing dew-point measurements well above the measured temperature. If such measurements are used, the result can produce a significant error in derived variables based on the humidity-corrected gas constant and specific heats. If the measurements are flagged as bad, there will be gaps in derived variables. To avoid these two errors, the corrections applied to the gas constant and specific heats are treated as follows: (i) The humidity correction is limited to not more than that given by the water-equilibrium humidity at the temperature ATXD, calculated using dry-air specific heats and gas constant. (ii) If the humidity from the primary sensor is flagged as a missing measurement (e.g., from a dew-point sensor), a secondary measurement is used (e.g., the VCSEL) in cases when the secondary sensor is almost always present in an experiment. (iii) As a backup, the variables TASxD and ATxD are always calculated omitting the humidity correction to the gas constant and the specific heats. These variables usually provide continuous measurements, although they will be offset from the humidity-corrected values. The offset indicates the magnitude of the correction when both are present, and one of the variables TASxD (ATxD) may be selected as TASX (ATX) in cases where missing values might cause a problem for derived variables.]
<br />
</p>  
<p class=box>
RTX\index{RTX} = recovery temperature ($T_{r})$  
QCxC\index{QCxC} = dynamic pressure, corrected ($q_{a}$)  
PSXC\index{PSXC} = ambient pressure, after airflow/location correction
($p_{a}$)  
MACHx\index{MACHx}\sindex[var]{MACH = Mach number} = Mach number
based on QCxC and PSXC; cf.\ \@ref(eq:M2)  
MACHX = best Mach number, based on QCXC and PSXC  
$\alpha_{r}$ = recovery factor for the particular temperature sensor  
$R^{\prime}$, $c_{v}^{\prime}$ and $c_{p}^{\prime}$ as defined
above and in the list of symbols  
</p><p class=box2>
From \@ref(eq:M2),
\begin{equation}
\mathrm{MACHx}=\left\{ \left(\frac{2c_{v}^{\prime}}{R^{\prime}}\right)\left[\left(\frac{\mathrm{\{PSXC\}+\{QCxC\}}}{\mathrm{\{PSXC\}}}\right)^{\frac{R^{\prime}}{c_{p}^{\prime}}}-1\right]\right\} ^{1/2}  
(\#eq:MachBox)
\end{equation}  
From \@ref(eq:TaEQ),
\begin{equation}
\mathrm{ATx}=\frac{\mathrm{\left(\{RTx\}+T_{0}\right)}}{\left(1+\dfrac{\alpha_{r}\mathrm{(\{MACHX\})}^{2}R^{\prime}}{2c_{v}^{\prime}}\right)}-T_{0}
(\#eq:ATbox)
\end{equation}  
</p>

#### In-cloud Air Temperature, Radiometric (<span class="math inline"><em></em><sup>∘</sup></span>C): AT_ITR {-#AT-ITR}

<em>The radiometric ambient air temperature measured by the In-cloud Air Temperature Radiometer,</em> which measures the radiometric temperature in the 4.3 <span class="math inline"><em>μ</em></span>m CO<span class="math inline"><em></em><sub>2</sub></span> band.<span id="AT_ITR" label="AT_ITR">[AT_ITR]</span> Its primary use is in water cloud when the standard thermometers are affected by wetting. In clear air the temperature is an average over an integrating range of up to 100s of meters away from the aircraft, whereas in clouds the integrating range is as little as 10 meters because of water droplets. The calibration is by a polynomial fit of the internal reference temperature and measured radiance to the ATX temperature.<span id="punch:4-5" label="punch:4-5">[punch:4-5]</span></p>

#### Ophir Air Temperature (<span class="math inline"><em></em><sup>∘</sup></span>C): OAT {-#OAT}

<em>The radiometric temperature reported by the Ophir III radiometer,</em> which operates on the same principles as the ITR,<span id="OAT" label="OAT">[OAT]</span> with the same limitations. For more information on this instrument, see this <a href="http://opensky.library.ucar.edu/collections/TECH-NOTE-000-000-000-822">Technical Note</a>. The in-cloud air temperature radiometer is a later, improved version, but the Ophir III radiometer remains in use.</p>
<!-- <h2 id="humidity">Humidity</h2> -->

## Humidity {#humidity}

#### Dew/Frost Point (<span class="math inline">º</span>C): DPx, DP_x, MIRRTMP_DPx {-#dew-point}

<em>The mirror temperature measured directly by a dew-point sensor, without correction.</em> The dew point or frost point is measured by either an EG&amp;G Model 137, a General Eastern Model 1011B or a Buck Model 1011C dew-point hygrometer. Below 0<strong><span class="math inline"><em></em><sup>∘</sup></span>C</strong> the instrument is assumed to be responding to the frost point, although occasionally in climbs there is a short transition near the freezing level before the condensate on the mirror of the instrument freezes and there may be a measurement error before the condensate freezes. The measurements are usually made within a housing where the pressure (<span class="math inline"><em>p</em><sub><em>h</em></sub>)</span> may differ from the ambient pressure, so the pressure in the housing affects the measured dew point or frost point. The housing pressure is often adjusted to be near the ambient pressure by appropriate orientation of inlets, and recently the pressure in the housing is measured and a correction is applied, as discussed in the next paragraph.</p>

#### Corrected Dew Point (<span class="math inline">º</span>C): DPXC, DPxC^[See also DP_VXL and DP_CR2C below.] {-#dewpt-corrected}

<em>The dew point obtained from the original measurement after correction for the housing pressure, the enhancement of the equilibrium vapor pressure arising from the total pressure (discussed below), and conversion from frost point if appropriate,</em> The result is the temperature at which the equilibrium vapor pressure over a plane water surface in the absence of other gases would match the actual water-vapor pressure. Dew/frost-point hygrometers measure the equilibrium point in the presence of air, and the presence of air affects the measurement in a minor way that is represented by a small correction here named the “enhancement factor.” In the case where the dew-point or frost-point sensor is exposed to ambient air directly, the enhancement factor is defined so that the ambient water vapor pressure $e_a$ is related to $T_p$, the *measured* dew or frost point *in the presence of air* having total pressure $p$, by $e_a=f(p,T_P)e_s(T_p)$ where $e_s(T_p)$ is the vapor pressure in equilibrium with ice or water at the dew or frost point $T_p$ *in the absence of air.* Calculation of DPxC removes this dependence, so the vapor pressure obtained from $e_s(\{DPxC\})$ will be that vapor pressure corresponding to equilibrium *in the absence of air.* In addition, if the measurement is below $0^\circ\mathrm{C}$, it is assumed to be a measurement of frost point and a corresponding dew point is calculated from the measurement (also with correction for the influence of the total pressure on the measurement). Some changes were made to these calculations in 2011; for more information, see <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/VaporPressureV3.pdf">this memo</a>.<br />
<br />
An additional correction is needed in those cases where the pressure in the housing of the instrument (measured as PSDPx or CAVP_x) differs from the ambient pressure, because the changed pressure affects the partial pressure of water vapor in proportion to the change in total pressure and so changes the measured dew point from the desired quantity (that in the ambient air) to that in the housing. This is especially important in the case of the GV because the potential effect increases with airspeed. If the pressure in the housing is measured or otherwise known (e.g., from correlations with other measurements), then this correction can be introduced into the processing algorithm at the same time that the correction for the presence of dry air is introduced, and the enhancement factor should be evaluated at the pressure in the housing.<br />  

The relationship between water-vapor pressure and dew- or frost-point temperature is based on the Murphy and Koop^[Q. J. R. Meteorol. Soc. (2005), 131, pp. 1539–1565]
(2005) equations.^[Prior to 2010, the vapor pressure relationship used was the Goff-Gratch formula as given in the Smithsonian Tables (List, 1980).]
They express the equilibrium vapor pressure as a function of frost point or dew point *and at a total air pressure $p$* via equations that are equivalent to the following:  
\begin{equation}
e_{s,i}(T_{FP})= b_{0}^{\prime}\exp(b_{1}\frac{(T_{0}-T_{FP})}{T_{0}T_{FP}}+b_{2}\ln(\frac{T_{FP}}{T_{0}})+b_{3}(T_{FP}-T_{0}))
(\#eq:MKi)
\end{equation}
\begin{equation}
e_{s,w}(T_{DP})=c_{0}\exp\left((\alpha-1)c_{6}+d_{2}(\frac{T_{0}-T_{DP}}{T_{DP}T_{0}})\right)+d_{3}\ln(\frac{T_{DP}}{T_{0}})+d_{4}(T_{DP}-T_{0})
(\#eq:MKw)
\end{equation}
\begin{equation}
f(p, T_P)= 1 + p(f_1 + f_2T_P + f_3T_P^2)
(\#eq:enhance)
\end{equation}
where $e$ is the water vapor pressure, $T_{FP}$ or $T_{DP}$ is the frost or dew point, respectively, expressed in kelvin, $T_0$ = 273.15 K, $e_{s,i}(T_{FP})$ is the equilibrium vapor pressure over a plane ice surface at the temperature $T_{FP}$, $e_{s,w}(T_{DP})$ is the equilibrium vapor pressure over a plane water surface at the temperature $T_{DP}$ (above or below $T_0$), and $f(p,T_P)$ is the enhancement factor at total air pressure $p$ and temperature $T_P$, with $T_P$ equal to $T_{DP}−T_0$ when above $T_0$ and $T_{FP}−T_0$ when below $0^\circ$C.  
<br />
The coefficients used in the above formulas are given in the following tables, with the additional definitions that $\alpha_T=\tanh(c_5(T-T_x))$, $T_X=218.8$\ K, and $d_i=c_i+\alpha_Tc_{i+5}$ for i = {2,3,4}:

<p><center>
```{r MKcoef, echo = FALSE}
MKC <- data.frame(coefficient=c('$b_0^\\prime$', '$b_1$', '$b_2$', '$b_3$',
                                '$f_1$', '$f_2$', '$f_3$'))
MKC$value <- c('$6.11536$\ hPa', '$-5723.265$\ K', '$3.53068$',
               '$-0.00728332$\ K$^{-1}$', '$4.923\\times 10^{-5}$ hPa$^{-1}$',
               '$-3.25\\times 10^{-7}$hPa$^{-1}$K$^{-1}$', 
               '$5.84\\times 10^{-10}$hPa$^{-1}$K$^{-2}$')
MKC2 <- data.frame(coefficient = c('$c_0$', '$c_1$','$c_2$','$c_3$','$c_4$',
                                   '$c_5$','$c_6$','$c_7$','$c_8$','$c_9$'))
MKC2$value <- c('$6.091886$ hPa', '$6.564725$', '$-6763.22$\ K',
                '$-4.210$', '$0.000367$\ K$^{-1}$', '$0.0415$\ K$^{-1}$',
                '$-0.1525967$', '$-1331.22$\ K', '$-9.44523$',
                '$0.014025$\ K$^{-1}$')
knitr::kables(list(
knitr::kable(MKC, align=c('cc'), valign = 'c') %>% 
  kable_styling(bootstrap_options = 'bordered', position = 'float_left',
                full_width = FALSE),
knitr::kable(MKC2, align=c('cc'), valign = 'c') %>% 
  kable_styling(bootstrap_options = 'bordered', position = 'float_right',
                full_width = FALSE)
))
# scroll_box(list(T1, T2), width='90%')
```
</center></p>
The vapor pressure in the instrument housing, $e_h$, is related to the sensed dew or frost point according to equation \@ref(eq:MKw) or \@ref(eq:MKi),  but further corrections must also be made for the enhancement factor and to account for possible difference between the pressure in the sensor housing ($p_h$) and the ambient pressure ($p_a$):  
\begin{equation}
e_{a}=f(p_{a},T_{p})e_{h}\frac{p_{a}}{p_{h}}
(\#eq:housingCorr)
\end{equation}
<span id="punch:4.6" label="punch:4.6">[punch:4.6]</span>
Because processing to obtain the corrected dew point DPxC from the ambient vapor pressure $e_a$  would require difficult inversion of the above formulas, interpolation is used instead. A table constructed from \@ref(eq:MKw) and another constructed from \@ref(eq:MKi), giving water vapor pressure as a function of frost point or dew point temperature in $1^\circ\mathrm{C}$ increments from $-100$ to $+50^\circ\mathrm{C}$, is then used with three-point Lagrange interpolation (via a function described below as $F_D(e)$) to find the dew point temperature from the vapor pressure.^[prior to 2011 the conversion was made using the formula <span class="math inline"><em>D</em><em>P</em><em>x</em><em>C</em> = 0.009109 + <em>D</em><em>P</em><em>x</em>(1.134055 + 0.001038<em>D</em><em>P</em><em>x</em>)</span>. For instruments producing measurements of vapor density (RHO), the previous Bulletin 9 section incorrectly gave the conversion formula as <span class="math inline"><em>D</em><em>P</em><em>x</em><em>C</em> = 273.0<em>Z</em>/(22.51 − <em>Z</em>)</span>, a conversion that would apply to frost point, not dew point. However, the code in use shows that the conversion was instead <span class="math inline">237.3<em>Z</em>/(17.27 − <em>Z</em>)</span>, where Z in both cases is <span class="math inline"><em>Z</em> = ln ((<em>A</em><em>T</em><em>X</em> + 273.15)<em>R</em><em>H</em><em>O</em>/1322.3)</span>.]
</p>
  
Tests of these interpolation formulas against high-accuracy numerical inversion of formulas \@ref(eq:MKw) and \@ref(eq:MKi) showed that the maximum error introduced by the interpolation formula was about $0.004^\circ\mathrm{C}$ and the standard error about $0.001^\circ\mathrm{C}$. This inversion then provides a corrected dew point that incorporates the effects of the enhancement factor as well as differences between the ambient pressure and that in the housing. The algorithm is documented in the box below.  
```{r child='DPbox.Rmd'}
```
For other instruments that measure vapor density, such as a Lyman-alpha or tunable diode laser hygrometers (including the Vertical Cavity Surface Emitting Laser (VCSEL) hygrometer), a similar conversion is made from vapor density to dew point, as described in the next paragraph.<br />  

#### Dew Point Determined from the VCSEL Hygrometer (<span class="math inline"><em></em><sup>∘</sup></span>C): DP_VXL {-#vcsel-dp}

<em>The dew point temperature determined from the measured water vapor density from the VCSEL hygrometer.</em> The calculation is as described at the bottom of the box immediately above this paragraph (above the footnote). The water vapor density converted from a molecular density [molecules$\,$cm$^{-3}$] to a mass density [g$\,$m$^{-3}$] via^[The conversion factor is given by this formula:<br />
<br /><span class="math display">$$C^{\prime}=\frac{10^{6}\mathrm{cm}^{3}}{\mathrm{m}^{3}}\times\frac{M_{W}^{\dagger}}{N_{A}^{\dagger}}$$</span><br /> where <span class="math inline"><em>N</em><sub><em>A</em></sub></span> is the Avogadro constant, 6.022147<span class="math inline"> × 10<sup>26</sup></span> molecules kmol<span class="math inline"><em></em><sup> − 1</sup></span>.]
{CONCV_VXL} * $2.9915\times 10^{17}$
is used for {RHO}. DP_VXL is given by DPxC on the last line of that algorithm box. See CONCV_VXL below.</p>

#### Frost Point Temperature from the CR2 Cryogenic Hygrometer (<span class="math inline"><em></em><sup>∘</sup></span>C): FP_CR2, MIRRORT_CR2 {-#mirror-cr2}

<em>The mirror temperature in the CR2 cryogenic hygrometer,</em> which is normally the frost point inside the measuring chamber of the instrument<em>.</em> <span id="punch:4-7" label="punch:4-7">[punch:4-7]</span>The measurement is often suspect when the value is above about -15<span class="math inline"><em></em><sup>∘</sup></span>C; the measurement is intended for use below this value. The CR2 is a cabin-mounted instrument, so the measured pressure (P_CR2) in the instrument must be used with the ambient pressure (PSXC) to convert the measurement to ambient humidity measures like DP_CR2 and EW_CR2.</p>

#### Corrected Dew Point Temperature from the CR2 Cryogenic Hygrometer (<span class="math inline"><em></em><sup>∘</sup></span>C): DP_CR2C {-#dp-cr2}

<em>The dew point temperature corresponding to equilibrium at the ambient humidity,</em> as determined by the CR2 hygrometer. The measurement of the mirror temperature inside the CR2, FP_CR2, is converted to a vapor pressure assuming equilibrium water vapor pressure relative to a plane ice surface at that temperature, and the resulting vapor pressure is converted to an ambient value via the assumption that the ratio of vapor pressure internal to the instrument to ambient vapor pressure is the same as the corresponding total pressure ratio. The resulting ambient vapor pressure (EW_CR2) is then converted to an equivalent ambient dew point. The steps are the same as those in the algorithm box for DPxC above, with these substitutions: FP_CR2 is used for DPx and P_CR2 for $p_h$.</p>

#### Uncorrected Water Vapor Number Density from the VCSEL Hygrometer (molecules cm<span class="math inline"><em></em><sup> − 3</sup></span>): >RAWCONC_VXL {-#vcsel-uncor}

<em>The uncorrected water vapor number density reported by the VCSEL hygrometer.</em> This is determined by comparing the measured absorption peak height against a reference spectrum generated using the HITRAN spectral parameters, the ambient temperature and the ambient pressure.^[For details see Zondlo, M. A., M. E. Paige, S. M. Massick, and J. A. Silver, 2010: Vertical cavity laser hygrometer for the National Science Foundation Gulfstream-V aircraft. <em>J. Geophys. Res.,</em> <strong>115,</strong> D20309, doi:10.1029/2010JD014445.]
</p>

#### Corrected Water Vapor Concentration from the VCSEL Hygrometer (molecules cm<span class="math inline"><em></em><sup> − 3</sup></span>): CONCV_VXL {-#vcsel-corr}

<em>The corrected water vapor number density produced by the VCSEL hygrometer,</em> after minor corrections for ambient temperature, pressure, laser intensity and water vapor concentration.<span id="punch:4-8" label="punch:4-8">[punch:4-8]</span> For more information on calibration and data processing for this instrument, see the <a href="https://www.eol.ucar.edu/instruments/vertical-cavity-surface-emitting-laser-vcsel-hygrometer">instrument web page</a> and additional documentation there.</p>
#### Voltage Output from the UV Hygrometer (V): XSIGV_UVH {-#uvh-voltage}

<em>The voltage from a modern (as of 2012) version of the Lyman-alpha hygrometer,</em> which provides a signal that represents water vapor density. The instrument also provides measurements of pressure and temperature inside the sensing cavity; they are, respectively, XCELLPRES_UVH and XCELLTEMP_UVH. See the discussion of EW_UVH below for the data-processing algorithm that uses this variable.</p>

#### Water Vapor Number Density from the UV Hygrometer (molecules cm<span class="math inline"><em></em><sup> − 3</sup></span>): CONCH_UVH {-#uvh-n}

<em>Water vapor number density (or concentration of molecules) measured by the UV Hygrometer.</em> This is the direct measurement from the instrument. Its calculation relies on a bench calibration that fits the water vapor number density to the Beers-Lambert absorption law and corrects for output offsets and the effect of UV absorption by atmospheric constituents other than water vapor. See also the discussion of EW_UVH in the paragraph that immediately follows.</p>

#### Water Vapor Pressure (hPa): EWx, EWX, EW_UVH, EW_VXL, EDPC (obsolete) {-#ewx}

<em>The ambient vapor pressure of water,</em> also used in the calculation of several derived variables. It is often obtained from an instrument measuring dew point or water vapor density. In the case where it is derived from a measurement of dew point (DPx), a correction is applied for the enhancement factor that influences dew point or frost point measurements.^[prior to 2011, this variable was calculated using the Goff-Gratch formula. See the discussion of DPXC for more information on previous calculations.]
The formula for obtaining the ambient water vapor pressure as a function of dew point is given in the discussion of DPxC above, Eqs.\ \@ref(eq:MKw) and \@ref(eq:enhance), where the calculation of the variables EWx and EWX are also discussed. EWX (or previously EDPC) is the preferred variable that is selected from among the possibilities {EWx} for subsequent calculation of derived variables.<br />
<br />
For the case where water vapor pressure is determined by the VCSEL hygrometer, EW_VXL is determined from CONCV_VXL: EW_VXL=<span class="math inline"><em>C</em></span><span class="math inline"><em>k</em></span>{CONCV_VXL}{ATX+273.15) where <span class="math inline"><em>k</em></span> is the Boltzmann constant and <span class="math inline"><em>C</em> = 10<sup> − 4</sup></span>(cm/m)<span class="math inline"><em></em><sup>3</sup></span>(hPa/Pa) converts units to hPa.<br />
<br />
In the case where the water vapor pressure is determined from the UV Hygrometer data, this variable is calculated using one of two methods:  

1. Using the ideal gas law to convert the water vapor number density from the UV Hygrometer to water vapor pressure, using XCELLTEMP_UVH and XCELLPRES_UVH, the measured temperature and pressure in the absorption cell, via the equation:  
\begin{equation}
\mathrm{\{EW\_UVH\}=C\,\{CONC\_UVH\}\notag \\
\times\frac{k\,(\mathrm{\{XCELLTEMP\_UVH\}+273.15)\,\mathrm{\{PSX\}}}}{\mathrm{{\{XCELLPRES\_UVH\}}}}}
(\#eq:UVH1)
\end{equation}
</span><br /> or  
2. Through use of a polynomial fit with coefficients fitted to \{EWX\}:  
\begin{equation}
\mathrm{\{EWX\}}=c_0 + c_1(\mathrm{\{XSIGV\_UVH\}}) + c_2(\mathrm{\{XSIGV\_UVH\}}^2)
(\#eq:UVH2)
\end{equation}  
where \{EWX\} is a reference water vapor pressure provided by another instrument. This preserves the fast-response characteristics of the UV hygrometer while linking the absolute values to a baseline provided by a more stable instrument. This can be done on a flight-by-flight basis and largely eliminates drift.^[For more details see Beaton, S. P. and M. Spowart, 2012: UV Absorption Hygrometer for Fast-Response Airborne Water Vapor Measurements. <em>J. Atmos. Oceanic Technol.,</em> <strong><em>29.</em></strong> DOI: 10.1175/JTECH-D-11-00141.1]
See the project reports to determine which method was used for a particular project.</p>  

#### Relative Humidity (per cent or Pa/hPa): RHUM {-#rhumw}

<em>The ratio of the water vapor pressure to the water vapor pressure in equilibrium over a plane</em> liquid<em>-water surface,</em> scaled to express the result in units of per cent or Pa/hPa:<br />  
```{r child='RHUMbox.Rmd'}
```
To follow normal conventions, the change in equilibrium vapor pressure that arises from the enhancement factor is not included in the calculated relative humidity, even though the true relative humidity should include the enhancement factor as specified in \@ref(eq:enhance) in the denominator of \@ref(eq:RHUM).<br />

#### Relative Humidity with respect to Ice (per cent or Pa/hPa): RHUMI {-#rhumi}

<em>The ratio of the water vapor pressure to the water vapor pressure in equilibrium over a plane</em> ice <em>surface,</em> scaled to express the result in units of per cent or Pa/hPa:<br />
```{r child='RHIbox.Rmd'}
```

To follow normal conventions, the change in equilibrium vapor pressure that arises from the enhancement factor is not included in the calculated relative humidity, even though the true relative humidity should include the enhancement factor as specified in \@ref(eq:enhance) in the denominator of \@ref(eq:RHUMI).<br />

#### Absolute Humidity, Water Vapor Density (g/m<span class="math inline"><em></em><sup>3</sup></span>):RHOx {-#rho}

<em>The water vapor density computed from various measurements of humidity as indicated by the ’x’ suffix,</em> and conventionally expressed in units of g kg<span class="math inline"><em></em><sup> − 1</sup></span> or per mille. The calculation proceeds in different ways for different sensors. For sensors that measure a chilled-mirror temperature, the calculation is based on the equation of state for a perfect gas and uses the water vapor pressure determined by the instrument, as in the following box:<span id="punch:4-9" label="punch:4-9">[punch:4-9]</span><br />
```{r child='RHObox.Rmd'}
```
For instruments measuring the vapor pressure density (including the Lyman-alpha probes and the newer version called the UV hygrometer), the basic measurement from the instrument is the water vapor density, <strong><span class="underline">RHOUV</span></strong> or <strong></strong> <strong><span class="underline">RHOLA</span></strong>, determined by applying calibration coefficients to the measured signals (XUVI or VLA). In addition, a slow update to a dew-point measurement is used to compensate for drift in the calibration. The algorithm for the UV Hygrometer is as described in the following box; the processing used for early projects with the Lyman-alpha instruments is similar but more involved and won’t be documented here because the instruments are obsolete. See <a href="https://opensky.ucar.edu/islandora/object/archives%3A8729">RAF Bulletin 9</a> for the processing previously used for archived measurements from the Lyman-alpha hygrometers.<br />  
<p class=box>  
This algorithm for RHOUV is missing.
</p><p class=box2><p>

#### Specific Humidity (g/kg): SPHUM {-#sphum}

<em>The mass of water vapor per unit mass of (moist) air, conventionally measured in units of g/kg or per mille.</em><br />
```{r child='SPHUMbox.Rmd'}
```

#### Mixing Ratio (g/kg): MR, MRCR, MRLA, MRLA1, MRLH, MRVXL  {-#MR}

<em>The ratio of the mass of water to the mass of dry air in the same volume of air,</em> conventionally expressed in units of g/kg or per mille. Mixing ratios may be calculated for the various instruments measuring humidity on the aircraft, and the variable names reflect the source: MR from the dewpoint hygrometers, MRCR from the cryogenic hygrometer, MRLA from the Lyman-alpha sensor, MRLA1 if there is a second Lyman-alpha sensor, MRLH from a tunable-diode laser hygrometer, and MRVXL from the VCSEL hygrometer (also a laser hygrometer). The example in the box below is for the case of the dewpoint hygrometers; others are analogous.<br /></p>
```{r child='MRbox.Rmd'}
```
<!-- <h2 id="derived-thermodynamic-variables">Derived Thermodynamic Variables</h2> -->
  
## Derived Thermodynamic Variables

#### Potential Temperature (K): THETA {-#theta}

<em>The absolute temperature reached if a dry parcel at the measured pressure and temperature were to be compressed or expanded adiabatically to a pressure of 1000 hPa</em>. It does not take into account the difference in specific heats caused by the presence of water vapor, and water vapor can change the exponent in the formula below enough to produce errors of 1 K or more.<br />
```{r child='THETAbox.Rmd'}
```

#### Pseudo-Adiabatic Equivalent Potential Temperature (K): THETAP, THETAE {-#thetae}

<em>The absolute temperature reached if a parcel of air were to be expanded pseudo-adiabatically (i.e., with immediate removal of all condensate) to a level where no water vapor remains, after which the dry parcel would be compressed to 1000 hPa.</em> Beginning in 2011, pseudo-adiabatic equivalent potential temperature is calculated using the method developed by Davies-Jones (2009).^[Davies-Jones, R., 2009: On formulas for equivalent potential temperature. <em>Mon. Wea. Review,</em> <strong>137,</strong> 3137–3148.]
This is discussed in the memo available at <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/ThetaE.pdf">this link</a>. The following summarizes that study. The Davies-Jones formula is:  
\begin{equation}
\Theta_{P}=\Theta_{DL}\exp\{\frac{r(L_{0}^{*}-L_{1}^{*}(T_{L}-T_{0})+K_{2}r)}{c_{pd}T_{L}}\}
(\#eq:THETAP)
\end{equation}  
\begin{equation}
\Theta_{DL}=T_{K}(\frac{p_{0}}{p_{d}})^{0.2854}\,(\frac{T_{k}}{T_{L}})^{0.28\times10^{-3}r}
(\#eq:THETADL)
\end{equation}  
where $T_K$ is the absolute temperature (in kelvin) at the measurement level, $p_d$ is the partial pressure of dry air at that level, $p_0$ is the reference pressure (conventionally 1000 hPa), $r$ is the (dimensionless) water vapor mixing ratio, $c_p$ the specific heat of dry air, $T_L$ the temperature at the lifted condensation level (in kelvin), and $T_0=273.15\,\mathrm{K}$. The coefficients in this formula are $L_0^* = 2.56313\times 10^6\mathrm{J\,kg^{-1}}$,
$L_1^* = 1754\,\mathrm{J\,kg^{-1}K^{-1}}$, and $K_2 = 1.137\times 10^6\mathrm{J\,kg^{-1}}$. The asterisks on $L_0^*$ and $L_1^*$ indicate that these coefficients depart from the best estimate of the coefficients that give the latent heat of vaporization of water, but they have been adjusted to optimize the fit to values obtained by exact integration. Note that, unlike the formula discussed below that was used prior to 2011, the mixing ratio must be used in dimensionless form (i.e., kg/kg), <em>not</em> with units of g/kg. The following empirical formula, developed by Bolton (1980),^[Bolton, D., 1980: The computation of equivalent potential temperature. <em>Mon. Wea. Rev.,</em> <strong>108,</strong> 1046–1053.]
is used to calculate $T_L$:  
\begin{equation}
T_{L}=\frac{\beta_{1}}{3.5\ln(T_{K}/\beta_{3})-\ln(\mathrm{e/\beta_{4}})+\beta_{5}}+\beta_{2}
(\#eq:TLCL)
\end{equation}  
where $e$ is the water vapor pressure, $\beta_1 = 2840\,\mathrm{K}$, $\beta_2 = 55\,\mathrm{K}$, $\beta_3 = 1\,\mathrm{K}$, $\beta_4 = 1\,\mathrm{hPa}$, and $\beta_5 = -4.805$. ($\beta_3$ and $\beta_4$ have been introduced into \@ref(eq:TLCL) only to ensure that arguments to logarithms are dimensionless and to specify the units that must be used to achieve that.)<br />
```{r child='THETAPbox.Rmd'}
```

Prior to 2011, the variable called the equivalent potential temperature^[The AMS glossary defines equivalent potential temperature as applying to the adiabatic process, not the pseudo-adiabatic process; the name of this variable has therefore been changed.]
and named THETAE in the output data files was that obtained using the method of Bolton (1980), which used the same formula to obtain the temperature at the lifted condensation level ($T_L$) and then used that temperature to find the value of potential temperature of dry air that would result if the parcel were lifted from that point until all water vapor condensed and was removed from the air parcel. The formulas used were as follows:<br />
```{r child='THETAEbox.Rmd'}
```
  
Differences vs the new formula are usually minor but can be as much as 0.5 K.<strong></strong><br />

#### Virtual Temperature (<span class="math inline">º</span>C): TVIR {-#TVIR}

<em>The temperature of dry air having the same pressure and density as the air being sampled.</em> The virtual temperature thus adjusts for the buoyancy added by water vapor.<br />
```{r child='TVIRbox.Rmd'}
```

### Virtual Potential Temperature (K): THETAV {-#thetav}

<em>A potential temperature analogous to the conventional potential temperature except that it is based on virtual temperature instead of ambient temperature.</em> Dry-adiabatic expansion or compression to the reference level (1000 hPa) is assumed. As for THETA, use of dry-air values for the gas constant and specific heat at constant pressure can lead to significant errors in humid conditions. For further information, see <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/VirtualTemperature.pdf">this note</a>.<br />
<a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/VirtualTemperature.pdf">this note</a><br />
```{r child='THETAVbox.Rmd'}
```
#### Wet-Equivalent Potential Temperature (K): THETAQ {-#thetaq}

<em>The absolute temperature reached if a parcel of air were to be expanded adiabatically (i.e., retaining the condensed water in the liquid phase and accounting for the specific heat of that condensate) to a level where no water vapor remains, after which the condensate would be removed and the resulting dry parcel compressed to 1000 hPa.</em> This variable was not included in data archives prior to 2012. Emanuel (1994) gives the following formula (his Eq. 4.5.11):  
\begin{equation}
\Theta_{q}=T(\frac{p_{0}}{p_{d}})^{\frac{R_{d}}{c_{pt}}}\exp\left\{ \frac{L_{v}r}{c_{pt}T}\right\} \left(\frac{e}{e_{s,w}(T)}\right)^{-rR_{w}/c_{pt}}
(\#eq:THETAQ)
\end{equation}  
where $\Theta_q$ is the wet-equivalent potential temperature, $L_v$ the latent heat of vaporization, $r$ the (dimensionless) water-vapor mixing ratio, $c_{pt} = c_{pd}+r_tc_w$ with $r_t$  the total-water mixing ratio including vapor and condensate, $c_w$ the specific heat of liquid water, and other symbols are as used previously. See <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/ThetaE.pdf">this memo</a> for additional discussion of this variable, for values to use for the latent heat and specific heat, and in particular for analysis indicating that $\Theta_Q$ evaluated with this formula can be expected to vary from the true adiabatic value by a few tenths kelvin (in a worst case, by about 1 K) because of variation in (and uncertainty in) the specific heat of supercooled water at low temperature. The details of the calculation are described in the following box. Note that this algorithm only uses the liquid water content as measured by a King probe, PLWCC; other similar calculations could be based on other measures of liquid water such as that from a cloud-droplet spectrometer.  
</p>
```{r child='THETAQbox.Rmd'}
```

<!-- <h2 id="windsecwind">Wind<span id="sec:WIND" label="sec:WIND">[sec:WIND]</span></h2> -->

## Wind {#wind}

<p><a href="https://opensky.ucar.edu/islandora/object/archives%3A8152">RAF Bulletin 23</a> documents the calculation of wind components, both with respect to the earth (UI, VI, WI, WS and WD) and with respect to the aircraft (UX and VY). In data processing, a separate function (GUSTO in GENPRO, gust.c in NIMBUS) is used to derive these wind components. That function uses the measurements from an Inertial Navigation System (INS) as well as aircraft true airspeed, aircraft angle of attack, and aircraft sideslip angle. The wind components calculated in GUSTO/gust.c are used to derive the wind direction (WD) and wind speed (WS). Additional variables UIC, VIC, WSC, WDC, UXC, and VYC are also calculated based on the variables VNSC, VEWC discussed in Section \@ref(combining-irs-and-gps-measurements), which combine INS and GPS information to obtain improved measurements of the aircraft motion. Those are usually the highest-quality measurements of wind because the merged INS/GPS variables combine the high-frequency response of the INS with the long-term accuracy of the GPS.</p>
<p>There is an extensive discussion of the wind-sensing system and the uncertainties associated with measurements of wind in this <a href="http://dx.doi.org/10.5065/D60G3HJ8">Technical Note</a>. The details contained therein and in Bulletin 23 will not be repeated here, so those documents should be consulted for additional information. There are two exceptions that are discussed in more detail here:</p>
<ol class="incremental">
<li><p>The calculation of vertical wind is described in more detail below for the variables WI and WIC.</p></li>
<li><p>Because measurements obtained by a GPS receiver are often used, the motion of the GPS receiving antenna relative to the IRU must be considered. Standard processing corrects for the motion of the gust system relative to the IRU arising from aircraft rotation, but a similar correction is needed because the GPS antenna is displaced from the IRU. The displacement is almost entirely along the longitudinal axis of the aircraft, so GPS-measured velocities like GGVNS, GGVEW, and GGVSPD (denoted here $v_n$, $v_e$, $v_u$) need correction as follows to give measurements that apply at the location of the IRU. Then these variables can be used in place of or to complement similar measurements from the IRU in the processing algorithms. The equations are:  
\begin{align}\begin{split}
\delta v_{u} = & -L_{G}\dot{\theta}\notag \\
\delta v_{e} = & -L_{G}\dot{\psi}\,{\cos\psi}\notag \\
\delta v_{n} = &  L_{G}\dot{\psi}\,{\sin\psi}
\end{split}
(\#eq:deltav)
\end{align}  
where $\theta$ and $\psi$ respectively are the pitch and heading angles and $L_G$ is the distance forward along the longitudinal axis from the IRU to the GPS antenna ($−4.30$ m for the GV and $-9.88$ m for the C-130 during and after 2015).  The negative signs indicate that the GPS antennas are behind the IRUs. The dots over the attitude-angle symbols represent time derivatives, so for example $\dot{\theta}$ is the rate of change of the pitch angle. All angles are expressed in radians. The correction terms should be added to the GPS-measured velocity components so that they represent the motion of the IRU relative to the Earth. This is done for the vertical wind, beginning in 2017, but for horizontal wind the complementary filter (discussed below) removes high-frequency fluctuations from the GPS-derived measurements so incorporation of these changes would have negligible effect. For more information, see <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107.pdf">this note</a>.</p></li>
</ol>
<p>The variables pertaining to the relative wind are described in the next subsection, and the variables characterizing the wind are then described briefly in the last subsection. Some additional detail is included in cases where procedures are not documented in that earlier bulletin.</p>
<!-- <h3 id="relative-wind">Relative Wind</h3> -->

### Relative Wind

<p>Wind is measured by adding two vectors, the measured air motion relative to the aircraft (called the relative wind) and the motion of the aircraft relative to the Earth. The following are the measurements used to determine the relative wind. The motion of the aircraft relative to the ground was discussed in Section \@ref(inertial-reference-systems), and the combination of these two vectors to measure the wind is described in <a href="https://opensky.ucar.edu/islandora/object/archives%3A8152">RAF Bulletin 23</a>.</p>
<p>RAF uses the radome<span id="radome gust-sensing system" label="radome gust-sensing system"></span> gust-sensing technique^[Brown, E. N, C. A. Friehe, and D. H. Lenschow, 1983: <em>Journal of Climate and Applied Meteorology,</em> <strong>22,</strong> 171–180]
to measure incidence angles of the relative wind (i.e., angles of attack and sideslip). The pressure difference between sensing ports above and below the center line of the radome is used, along with the dynamic pressure measured at a pitot tube and referenced to the static pressure source, to determine the angle of attack. The sideslip angle is determined similarly using the pressure ports on the starboard and port sides of the radome. A Rosemount Model 858AJ gust probe has occasionally been used for specialized measurements. The radome measurements are made by differential pressure sensors located in the nose area of the aircraft and connected to the radome by semi-rigid tubing.</p>

#### Mach Number (dimensionless): MACHx, MACHX {-#mach-number}

<em>The Mach Number that characterizes the flight speed.</em> The Mach number is defined as the ratio of the flight speed (or the magnitude of the relative wind) to the speed of sound.
See Eq.\ \@ref(eq:M2) for the equation used. Many relatively old archived data files have instead a variable XMACH2, which is the square of MACHx.</p>

#### Aircraft True Airspeed (m/s): TASx, TASxD, TASX {-#true-airspeed}

<em>The flight speed of the aircraft relative to the atmosphere.</em> This derived measurement of the flight speed of the aircraft relative to the atmosphere is based on the Mach number calculated from both the dynamic pressure at location x and the static pressure. See the derivation for ATx . The different variables for TASx (TASF, TASR, etc) use different measurements of QCxC in the calculation of Mach number. The variable TASxD is the result of calculations for which the Mach number, air temperature, and true airspeed are determined for dry instead of humid air. See the discussion of [ATX](#ATX) for an explanation of how humidity is handled in the calculation of true airspeed.<br />
```{r child='TASbox.Rmd'}
```

#### Aircraft True Airspeed (Humidity Corrected) (m/s): TASHC {-#tashc}

This derived measurement of true airspeed accounted for deviations of specific heats of moist air from those of dry air. See List, 1971, pp 295, 331-339, and Khelif, et al., 1999. This variable is no longer used because the standard
calculation of TASX (documented in the preceding paragraph) now uses moist-air
values of the specific heats and gas constant. The equation previously used for this variable, given by Khelif et al. 1999,^[Khelif, D., S.P. Burns, and C.A. Friehe, 1999: Improved wind measurements on research aircraft. <em>Journal of Atmospheric and Oceanic Technology,</em> <strong>16,</strong> 860–875.]
added a moisture correction to the true airspeed derived for dry air, as follows:<br />
```{r child='TASHCbox.Rmd'}
```

#### Attack Angle Differential Pressure (mb): ADIFR {-#adifr}

<em>The pressure difference between the top and bottom pressure ports of a radome gust-sensing system.</em> This measurement is used to determine the angle of attack; see AKRD below. <strong></strong> Obsolete variable <span class="underline">ADIF</span> is a similar variable used for old gust-boom systems or for Rosemount Model 858AJ flow-angle sensors.</p>

#### Sideslip Angle Differential Pressure (mb): BDIFR {-#bdifr}

<em>The pressure difference between starboard and port pressure inlets of a radome gust-sensing system.</em> This measurement is used to determine the sideslip angle; see SSRD below. Obsolete variable <span class="underline">BDIF</span> is a similar variable used for old gust-boom systems or for Rosemount Model 858AJ flow-angle sensors.</p>

### Attack Angle, Radome (<span class="math inline">º</span>): AKRD {-#akrd}

<em>The angle of attack of the aircraft.</em> This derived measurement represents the angle between the longitudinal axis of the aircraft and the component of the relative wind vector in the plane of port-starboard symmetry of the aircraft. The tangent of the angle of attack is the ratio of the vertical to longitudinal component of the relative wind. Positive values indicate flow moving upward (in the aircraft reference frame) relative to the longitudinal axis. The calculation is based on ADIFR and a measurement of dynamic pressure, and so is the measurement produced by a radome gust-sensing system. Empirical sensitivity coefficients for each aircraft, determined from special flight maneuvers, are used; see <a href="https://opensky.ucar.edu/islandora/object/archives%3A8152">RAF Bulletin 23</a> and this <a href="http://dx.doi.org/10.5065/D60G3HJ8">Technical Note</a> for more information. The sensitivity coefficients listed below have changed when the radomes were changed or refurbished, so the project documentation should be consulted for the values used in a particular project. For more information on the latest C-130 calibration, see <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/ARISTO-LAMS.pdf">this note</a>.<br />
Prior to 2017, the procedure was based on the following algorithm:<br />
```{r child='AKRDbox.Rmd'}
```
<br />
See also <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/AKRDC130.pdf">this memo</a>.<br />
<br />
Beginning in 2017, a different strategy was used, as documented in more detail in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161121.pdf">this memo</a>. Two variables were used to represent the angle of attack, $A$={ADIFR}/{QCF} and $q$={QCF}. However, each was filtered into complementary low-pass and high-pass components, with the cutoff frequency at (1/600) Hz, and the separate components were used to represent the separate components of angle of attack according to the following formula:<br />
```{r child='newAKRDbox.Rmd'}
```
<strong></strong></p>

#### Reference Attack Angle (<span class="math inline">º</span>): ATTACK {-#attack}

<span id="punch:4-12" label="punch:4-12">[punch:4-12]</span><br />
<em>The reference angle of attack used to calculate derived variables.</em> This variable is the reference selected from other measurements of angle of attack in the data set. In most projects, it is equal to AKRD. It is used where attack angle is needed for other derived calculations (e.g., wind measurements).</p>

#### Sideslip Angle (Differential Pressure) (<span class="math inline">º</span>): SSRD {-#ssrd}

<em>The angle of sideslip of the aircraft.</em> This derived measurement represents the angle between the longitudinal axis of the aircraft and the projection of the relative wind onto the plane determined by the longitudinal and lateral axes. Positive values indicate airflow from the starboard side. This variable is derived from BDIFR and a dynamic pressure using a sensitivity function that has been determined empirically for each aircraft.<br /></p>
```{r child='SSRDbox.Rmd'}
```

#### Reference Sideslip Angle (<span class="math inline">º</span>): SSLIP {-#sslip}

<em>The reference sideslip angle used to calculate derived variables</em>. This variable is the reference selected from other measurements of sideslip angle in the data set. In most projects, it is equal to SSRD. It is used where sideslip angle is needed for other derived calculations (e.g., wind measurements).</p>
  
<!-- <h3 id="wind-components-and-the-wind-vector">Wind Components and the Wind Vector</h3> -->
### Wind Components and the Wind Vector

#### Wind Vector Components (m/s): UI, VI, WI {-#ui-vi-wi}

<em>The three-dimensional wind vector with respect to the earth,</em> as determined from the inertial reference systems. UI is the east-west component with positive values <span class="underline">toward</span> the east, VI is the north-south component with positive values <span class="underline">toward</span> the north, and WI is the vertical component with positive values toward the zenith.<br />
The calculation of WI differs from the description in Bulletin 23 because the output from the inertial reference system is different for the modern units now in use. The vertical wind is the sum of the vertical gust component (represented approximately by TASX sin(ATTACK-PITCH)) and the motion of the aircraft as measured by VSPD (discussed in Section XXX). Bulletin 23 describes the historical calculation of the vertical motion of the aircraft via a barometric-inertial feedback loop, but equivalent calculations (including pressure damping to the pressure altitude) are incorporated into current IRS units so VSPD already is the product of such a calculation. To calculate WI, VSPD is therefore used in place of the obsolete variable WP3 that was discussed in Bulletin 23.
<br />
WIC should usually be used instead of WI because VSPD, entering WI, is updated to the pressure altitude and so can have false variations in baroclinic conditions. WIC uses GGVSPD (or in some cases older GPS-based rate-of-climb variables) in place of VSPD and so is more reliable.<br />
<strong></strong></p>

#### Wind Speed and Direction (m/s and <span class="math inline">º</span>): WS, WD {-#ws-wd}

<em>The magnitude and direction of the horizontal wind.</em> These variables are obtained in a straightforward manner from UI and VI. The resulting wind direction is relative to true north and represents the direction <span class="underline">from which</span> the wind blows. That is the reason that 180<span class="math inline"><em></em><sup>∘</sup></span> appears in the following algorithm.<br />
```{r child='WDWSbox.Rmd'}
```

#### Wind Vector Longitudinal and Lateral Components (m/s): UX and VY {-#ux-vy}

<em>The horizontal wind</em> <em>vector relative to the frame of reference attached to the aircraft.</em> UX is parallel to the longitudinal axis and positive toward the nose. VY is along the lateral axis and normal to the longitudinal axis; positive is toward the port (or left) wing.<br />  

#### GPS-Corrected Wind Vector, East and North Components (m/s): UIC, VIC {-#uic-vic}

<em>The horizontal wind components</em> respectively <em><span class="underline">toward</span></em> <em>the east and</em> <em><span class="underline">toward</span></em> <em>the north.</em> They are derived from measurements from an inertial reference unit (IRU) and a Global Positioning System (GPS), as described in the discussion of VEW and VNS above. They are calculated just as for UX and VY except that the GPS-corrected values for the aircraft groundspeed are used in place of the IRU-based values. They are considered “corrected” from the original measurements from the IRU or GPS, as described in Section \@ref(combining-irs-and-gps-measurements).</p><br />

#### Wind Vector, Vertical Component (m/s): WIC {-#wic}

<em>The component of the wind in the vertical direction.</em> This is the standard calculation of vertical wind, obtained from the difference between the measured vertical component of the relative wind and the vertical motion of the aircraft (usually GGVSPD in recent projects).<span id="punch:4-13" label="punch:4-13">[punch:4-13]</span><strong></strong> This should be used in preference to WI if the latter is present; see the discussion of WP3 in Section \@ref(inertial-reference-systems). Positive values are toward the zenith.<br />

#### GPS-Corrected Wind Speed and Direction (m/s and <span class="math inline"><em></em><sup>∘</sup></span>): WSC, WDC {-#wsc-wdc}

<em>The magnitude and direction of the wind vector,</em> obtained by combining measurements from GPS and IRU units. These variables are obtained in a straightforward manner from UIC and VIC, using equations analogous to \@ref(eq:WS) and \@ref(eq:WD) but with UIC and VIC as input measurements. They are expected to be the preferred measurements of wind because they combine the best features of the IRU and GPS measurements.<br />

#### GPS-Corrected Wind Vector, Longitudinal and Lateral Components (m/s): UXC, VYC {-#uxc-vyc} 

<em>The longitudinal and lateral components of the three-dimensional wind, similar to UX and VY, but corrected by the complementary-filter algorithm that combines IRU and GPS measurements</em>. See the discussion in Section \@ref(combining-irs-and-gps-measurements). The components UXC and VYC are toward the front of the aircraft and toward the port (left) wing, respectively.</p>  

<!-- <h2 id="special-use-remote-sensors">Special-Use Remote Sensors</h2> -->
## Special-Use Remote Sensors {#special-use-remote}

<p>The above variables are normally included in the archived netCDF files from projects, but there are a few remote sensors that provide additional state-parameter measurements in some projects. These include:<span id="subsec:MTP" label="subsec:MTP"></span></p>

* Microwave Temperature Profiler (http://www.eol.ucar.edu/instruments/microwave-temperature-profiler) {MTP})
-- remotely sensed temperature profiles  
* Dropsonde System (https://www.eol.ucar.edu/observing_facilities/avaps-dropsonde-system) {AVAPS})
-- profiles of temperature, humidity, and wind vs pressure.  
* GPS-Occultation Sensor (http://www.eol.ucar.edu/instruments/gnss-instrument-system-multi-static-and-occultation-sensing) {GISMOS})
-- atmospheric soundings of refractivity via GPS occultation.  

<p>The links provided connect to descriptions of these instruments on the EOL web site, and each provides a summary of how data are acquired and processed. These measurements are not normally part of the archived netCDF project files. Those interested in using these measurements should contact EOL data management (<a href="mailto:raf-dm@eol.ucar.edu">mailto:raf-dm@eol.ucar.edu</a>) for access to the measurements and for information on how the measurements are processed.</p>


<!--chapter:end:Section4.Rmd-->

# Cloud Physics Variables
<!-- <h2 id="measurements-of-liquid-water-content">Measurements of Liquid Water Content</h2> -->

## Measurements of Liquid Water Content {#LWC}

#### Power, PMS/CSIRO (King) Liquid Water Content (W): PLWC, PLWC1 {-#plwc}

<em>The power dissipated by the sensor of a PMS/CSIRO (King) liquid water probe (in watts).</em> PLWC is the power required to maintain constant temperature in a heated element as that element is cooled by convection and evaporation of impinging liquid water. The convective heat losses are determined by calibration in dry air over a range of airspeeds and temperatures, so that the remaining power can be related to the liquid water content. The instrument is described in <a href="https://opensky.ucar.edu/islandora/object/archives%3A8155">RAF Bulletin 24</a> and at <a href="http://www.eol.ucar.edu/instruments/king-csiro-liquid-water-sensor">this URL</a>. See (which follows) for processing.<br /><span id="punch:5-3" label="punch:5-3">[punch:5-3]</span>

#### PMS/CSIRO (King) Liquid Water Content (g/m<span class="math inline"><em></em><sup>3</sup></span>): PLWCC, PLWCC1 {-#plwcc}

<em>The liquid water content</em> <em>measured by a King probe.</em> This is calculated by relating the power consumption required to maintain a constant temperature to the liquid water content, taking into account the effect of convective heat losses. The instrument and processing are described by King et al. (1978)^[King, W. D., D. A. Parkin and R. J. Handsworth, 1978: A hot-wire liquid water device having fully calculable response characteristics. J. Appl. Meteorol., 17, 1809–1813. See also Bradley, S. G., and W. D. King, 1979 Frequency response of the CSIRO Liquid Water Probe. J. Appl. Meteorol., 18, 361–366.]
and in a note available at <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PLWCCrev140214.pdf">this URL</a>. Because the temperature of the sensing wire is typically well above the boiling point of water, the assumption made in processing is that the water collected on the sensing wire is vaporized at the boiling point <span class="math inline"><em>T</em><sub><em>b</em></sub></span>. The boiling point is represented as a function of pressure as described below.<br /></p>  

```{r child='PLWCCbox.Rmd'}
```

In addition, a processing step is used to remove drift by calculating the offset required to zero measurements obtained outside cloud. This is done by adjusting the coefficient <span class="math inline"><em>a</em><sub>0</sub></span> by nudging toward the value required to give zero liquid water content outside cloud (as indicated by another instrument, often a CDP showing droplet concentration of &lt;1 cm<span class="math inline"><em></em><sup> − 3</sup></span>). Specifically, when out-of-cloud, Nu<span class="math inline"><em></em><sup>′</sup></span> is calculated from Nu<span class="math inline"><em></em><sup>′</sup> = {<em>P</em><em>L</em><em>W</em><em>C</em>}/(<em>π</em><em>L</em><em>λ</em><sub><em>c</em></sub>(<em>T</em><sub><em>s</em></sub> − <em>T</em><sub><em>a</em></sub>))</span>. Then the value of <span class="math inline"><em>a</em><sub>0</sub></span> is updated via <span class="math inline"><em>a</em><sub>0</sub></span> += (Nu<span class="math inline"><em></em><sup>′</sup>/<em>R</em><em>e</em><sup><em>a</em><sub>1</sub></sup> − <em>a</em><sub>0</sub>)/<em>τ</em></span> (using, for the GV, separate coefficients for each of the three branches). In this formula, <span class="math inline"><em>τ</em></span> should be the number of updates in a fixed period, e.g., for a 100 s time constant and for 25-Hz processing, <span class="math inline"><em>τ</em> = 100 × 25</span>. In addition, to avoid jumps when switching among the branches, the linear coefficients {<span class="math inline"><em>a</em><sub>0</sub></span>} are adjusted with each transition between branches to provide a continuous estimate of the zero value.</p>

#### PVM-100 Liquid Water Content (g/m^3^): PLWCG {-#plwcg}

<em>Cloud liquid water content for cloud droplets in the approximate size range from 3–50 <span class="math inline"><em>μ</em></span>m.</em> The PVM produces a measure of the liquid water content directly, but a baseline value is sometimes subtracted by reference to another cloud droplet instrument such as an FSSP or CDP, such that when the other instrument measures a very low droplet concentration the baseline value for the PVM-100 is updated at the corresponding time and that average is then subtracted from the measurements directly produced by the PVM-100.<span id="punch:5-1" label="punch:5-1">[punch:5-1]</span></p>

#### Rosemount Icing Detector Signal (V): RICE {-#rice}

<em>The voltage related to loading on the element of a Rosemount 871F ice-accretion probe.</em> This instrument (see <a href="https://www.eol.ucar.edu/instruments/rosemount-icing-detector">this URL</a>) consists of a rod set in vibration by a piezoelectric crystal. The oscillation frequency of the probe changes with ice loading, so in supercooled cloud ice accumulates on the sensor and the change in oscillation frequency is transmitted as a DC voltage. When the rod loads to a trigger point, the probe heats the rod to remove the ice. The rate of voltage change can be converted to an estimate of the supercooled liquid water content, as described in connection with the obsolete variable SCLWC. This calculation is no longer provided routinely but can be duplicated by a user on the basis of the SCLWC algorithm (see [SCLWC](#SCLWC) in Section \@ref(obsolete-variables) for one example; there are several other published algorithms.)</p>
<!-- <h2 id="sensors-of-individual-particles-1-d-probessubsec1dprobes">Measurements of Liquid Water Content<span id="subsec:1DProbes" label="subsec:1DProbes">[subsec:1DProbes]</span></h2> -->

## Sensors Detecting Individual Hydrometeors (1-D Probes) {#sensors-1-D-probes}

<p>The RAF operates a set of hydrometeor detectors that provide single-dimension measurements (i.e., not images) of individual particle sizes. <a href="https://opensky.ucar.edu/islandora/object/archives%3A8155">RAF Bulletin 24</a> contains extensive information on the operating principles and characteristics of some of the older instruments. Here the focus will be on the meanings of the variables in the archived data files.<span id="punch:5-2" label="punch:5-2">[punch:5-2]</span></p>
<p><span id="VariableNames1DProbes" label="VariableNames1DProbes"></span>Four- and five-character variable names shown in this section are generic. The actual names appearing in NIMBUS-generated production output data sets have appended to them an underscore (_) and three or four more characters that indicate a probe’s specific aircraft mounting location. For example, AFSSP_RPI refers to a variable from an FSSP-100 probe mounted on the inboard, right-side pod. The codes presently in use are given in the following table. For the GV, there are 12 locations available, characterized by three letters. The first is the wing ({L,R} for {port,starboard}), the second is the pylon ({I,M,O} for inboard, middle, outboard}), the third is which of the two possible canister locations at the pylon is used ({I,O} for {inboard, outboard}).</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><strong>Code</strong></th>
<th style="text-align: center;"><strong>Location</strong></th>
<th style="text-align: center;"><strong>Aircraft</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">OBL</td>
<td style="text-align: center;">Outboard Left</td>
<td style="text-align: center;">C-130Q</td>
</tr>
<tr class="even">
<td style="text-align: center;">IBL</td>
<td style="text-align: center;">Inboard Left</td>
<td style="text-align: center;">C-130Q</td>
</tr>
<tr class="odd">
<td style="text-align: center;">OBR</td>
<td style="text-align: center;">Outboard Right</td>
<td style="text-align: center;">C-130Q</td>
</tr>
<tr class="even">
<td style="text-align: center;">IBR</td>
<td style="text-align: center;">Inboard Right</td>
<td style="text-align: center;">C-130Q</td>
</tr>
<tr class="odd">
<td style="text-align: center;">LPO</td>
<td style="text-align: center;">Left Pod Outboard</td>
<td style="text-align: center;">C-130Q</td>
</tr>
<tr class="even">
<td style="text-align: center;">LPI</td>
<td style="text-align: center;">Left Pod Inboard</td>
<td style="text-align: center;">C-130Q</td>
</tr>
<tr class="odd">
<td style="text-align: center;">LPC</td>
<td style="text-align: center;">Left Pod Center</td>
<td style="text-align: center;">C-130Q</td>
</tr>
<tr class="even">
<td style="text-align: center;">RPO</td>
<td style="text-align: center;">Right Pod Outboard</td>
<td style="text-align: center;">C-130Q</td>
</tr>
<tr class="odd">
<td style="text-align: center;">RPI</td>
<td style="text-align: center;">Right Pod Inboard</td>
<td style="text-align: center;">C-130Q</td>
</tr>
<tr class="even">
<td style="text-align: center;">RPC</td>
<td style="text-align: center;">Right Pod Center</td>
<td style="text-align: center;">C-130Q</td>
</tr>
<tr class="odd">
<td style="text-align: center;">OBL</td>
<td style="text-align: center;">Left Wing</td>
<td style="text-align: center;">Electra</td>
</tr>
<tr class="even">
<td style="text-align: center;">IBL</td>
<td style="text-align: center;">Left Pylon</td>
<td style="text-align: center;">Electra</td>
</tr>
<tr class="odd">
<td style="text-align: center;">WDL</td>
<td style="text-align: center;">Window Left</td>
<td style="text-align: center;">Electra</td>
</tr>
<tr class="even">
<td style="text-align: center;">OBR</td>
<td style="text-align: center;">Right Wing</td>
<td style="text-align: center;">Electra</td>
</tr>
<tr class="odd">
<td style="text-align: center;">IBR</td>
<td style="text-align: center;">Right Pylon</td>
<td style="text-align: center;">Electra</td>
</tr>
<tr class="even">
<td style="text-align: center;">WDR</td>
<td style="text-align: center;">Window Right</td>
<td style="text-align: center;">Electra</td>
</tr>
<tr class="odd">
<td style="text-align: center;">{L,R}W{I,M,O}{I,O}</td>
<td style="text-align: center;">see discussion above</td>
<td style="text-align: center;">GV</td>
</tr>
</tbody>
</table>
<p>The probe type also is coded into each variable’s name, sometimes using four characters, sometimes only one: FSSP-100 (FSSP or F), FSSP-300 (F300 or 3), CDP (CDP or D), UHSAS (UHSAS or U), PCASP (PCAS or P), OAP-200X (200X or X), OAP-260X (260X or 6) and OAP-200Y (200Y or Y). Prefix letters are used to identify the type of measurement (A=accumulated particle counts per time interval per channel, C = concentration per channel, CONC = Concentration from all channels, DBAR = mean diameter, DISP = dispersion, PLWC =liquid water content, DBZ = radar reflectivity factor).</p>
<p>Some of the probes discussed in this section are primarily aerosol spectrometers but are described here rather than in Section \@ref(aerosol-particle-measurements) because they are similar to the hydrometeor spectrometers and so are most economically discussed here. However, see Section \@ref(aerosol-particle-measurements) for the processing algorithms that lead to concentrations from the UHSAS and PCASP/SPP-200. The following table and discussion includes some obsolete variables (for the 200X and 200Y) for the same reason. The table also includes some variables derived from imaging spectrometers (the 2DC and 2DP probes) to highlight that the primary variables are similar to those discussed in this sub-section. Those variables are discussed in the next sub-section. In two cases, the FSSP and PCASP, two versions are listed, an obsolete version and a current version with a revised processing package (SPP-100 for the FSSP, SPP-200 for the PCASP). Both are included for historical completeness, but algorithms in this document discuss the current versions.</p>
<p>The archived data files sometimes have “housekeeping” variables included that provide information on the operating state and data quality from the probes. For example, the CDP provides information on the average transit time, the voltage from the nominal 5-V source, the control board temperature, the laser block temperature, the laser current, the laser power monitor, the qualifier bandwidth, the qualifier baseline, the qualifier threshold, the sizer baseline, the wing-board temperature, an A-to-D overflow flag, and a count of particles rejected as being outside the depth of field. The netCDF variables and attributes should be consulted for this housekeeping information. The large number of housekeeping variables will not be included in this document, so appropriate manuals and the netCDF files should be consulted when interpreting this information.</p>
<p><strong>Probes that produce size distributions of particles (with links to descriptions):<span id="TableOfProbes" label="TableOfProbes"></span></strong></p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><strong>Generic Name</strong></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"><strong>Probe</strong>^[Probes without links are described at <a href="https://opensky.ucar.edu/islandora/object/archives%3A8155">this URL</a>.]
</th>
<th style="text-align: center;"><strong>Channels</strong></th>
<th style="text-align: center;"><strong>Usable</strong>^[Channels may be unusable because the first channel is a historical carry-over and should be ignored, or because in the case of 2D probes the entire-in sizing technique reduces the number of bins where particles can be sized. Also, when some channels have been considered unreliable the netCDF header may specify that the usable bins are smaller than indicated here.]
</th>
<th style="text-align: center;"><strong>Diameter Range</strong></th>
<th style="text-align: center;"><strong>Bin Width</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span>FSSP-100 original</span></td>
<td style="text-align: center;"><span>F</span></td>
<td style="text-align: center;"><span>FSSP-100</span>^[Now obsolete but present in many archived data sets.]
</td>
<td style="text-align: center;"><span>0–15</span></td>
<td style="text-align: center;"><span>1--15</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">FSSP/SPP-100</td>
<td style="text-align: center;">F</td>
<td style="text-align: center;"><a href="http://www.eol.ucar.edu/instruments/forward-scattering-spectrometer-probe-model-100">SPP-100</a></td>
<td style="text-align: center;">0–30</td>
<td style="text-align: center;">1--30</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">3 <span class="math inline"><em>μ</em></span>m (typ.)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">UHSAS</td>
<td style="text-align: center;">U</td>
<td style="text-align: center;"><a href="https://www.eol.ucar.edu/instruments/ultra-high-sensitivity-aerosol-spectrometer">UHSAS</a></td>
<td style="text-align: center;">0–99</td>
<td style="text-align: center;">1--99</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">variable</td>
</tr>
<tr class="even">
<td style="text-align: center;">CDP</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;"><a href="https://www.eol.ucar.edu/instruments/cloud-droplet-probe">CDP</a></td>
<td style="text-align: center;">0–30</td>
<td style="text-align: center;">1—30</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">variable</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span>F300</span></td>
<td style="text-align: center;"><span>3</span></td>
<td style="text-align: center;"><span><a href="https://www.eol.ucar.edu/instruments/forward-scattering-spectrometer-probe-model-300">FSSP-300</a><span class="math inline"><em></em><sup><em>b</em></sup></span></span></td>
<td style="text-align: center;"><span>0–30</span></td>
<td style="text-align: center;"><span>1--30</span></td>
<td style="text-align: center;"><span>0.3–20.0 <span class="math inline"><em>μ</em><em>m</em></span></span></td>
<td style="text-align: center;"><span>variable</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">PCASP/original</td>
<td style="text-align: center;">P</td>
<td style="text-align: center;">PCASP<span class="math inline"><em></em><sup><em>b</em></sup></span></td>
<td style="text-align: center;">0–15</td>
<td style="text-align: center;">1--15</td>
<td style="text-align: center;">0.1–3.0 <span class="math inline"><em>μ</em></span>m</td>
<td style="text-align: center;">variable</td>
</tr>
<tr class="odd">
<td style="text-align: center;">PCASP/SPP-200</td>
<td style="text-align: center;">P</td>
<td style="text-align: center;"><span><a href="https://www.eol.ucar.edu/instruments/signal-processing-package-200-passive-cavity-aerosol-spectrometer-probe">SPP-200</a></span></td>
<td style="text-align: center;"><span>0–30</span></td>
<td style="text-align: center;"><span>1--30</span></td>
<td style="text-align: center;"><span>0.1–3.0 <span class="math inline"><em>μ</em><em>m</em></span></span></td>
<td style="text-align: center;"><span>variable</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span>200X</span></td>
<td style="text-align: center;"><span>X</span></td>
<td style="text-align: center;">OAP-200X<span><span class="math inline"><em></em><sup><em>b</em></sup></span></span></td>
<td style="text-align: center;"><span>0–15</span></td>
<td style="text-align: center;"><span>1--15</span></td>
<td style="text-align: center;"><span>40–280 <span class="math inline"><em>μ</em><em>m</em></span></span></td>
<td style="text-align: center;"><span>10 <span class="math inline"><em>μ</em><em>m</em></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span>260X</span></td>
<td style="text-align: center;"><span>6</span></td>
<td style="text-align: center;">OAP-260X</td>
<td style="text-align: center;"><span>0-63</span></td>
<td style="text-align: center;"><span>3--62</span></td>
<td style="text-align: center;"><span>40-620 <span class="math inline"><em>μ</em><em>m</em></span></span></td>
<td style="text-align: center;"><span>10 <span class="math inline"><em>μ</em><em>m</em></span></span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span>200Y</span></td>
<td style="text-align: center;"><span>Y</span></td>
<td style="text-align: center;"><span>OAP-200Y<span class="math inline"><em></em><sup><em>b</em></sup></span></span></td>
<td style="text-align: center;"><span>0-15</span></td>
<td style="text-align: center;"><span>1--15</span></td>
<td style="text-align: center;"><span>300–4500 <span class="math inline"><em>μ</em><em>m</em></span></span></td>
<td style="text-align: center;"><span>300 <span class="math inline"><em>μ</em><em>m</em></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">1DC^[See [here](#special-1d-nomenclature) for an explanation of this name convention.]
</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">2DC<span class="math inline"><em></em><sup><em>b</em>,</sup></span>^[Measurements from this and the next three 2D probes are discussed in Section\ \@ref(hydrometeor-imaging-probes).]
(old)</td>
<td style="text-align: center;">0-32</td>
<td style="text-align: center;">1-30<span class="math inline"><em></em><sup><em>e</em></sup></span></td>
<td style="text-align: center;">25–800 <span class="math inline"><em>μ</em></span>m</td>
<td style="text-align: center;">25 <span class="math inline"><em>μ</em></span>m</td>
</tr>
<tr class="even">
<td style="text-align: center;">1DP</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">2DP<span class="math inline"><em></em><sup><em>b</em></sup></span> (old)</td>
<td style="text-align: center;">0-32</td>
<td style="text-align: center;">1-30</td>
<td style="text-align: center;">200–6400 <span class="math inline"><em>μ</em></span>m</td>
<td style="text-align: center;">200 <span class="math inline"><em>μ</em></span>m</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1DC</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><a href="https://www.eol.ucar.edu/instruments/two-dimensional-optical-array-cloud-probe">2DC</a> (fast)</td>
<td style="text-align: center;">0-63</td>
<td style="text-align: center;">1-62^[Some of the lowest channels are often considered unreliable and excluded in processing.]
</td>
<td style="text-align: center;">25–1600 <span class="math inline"><em>μ</em></span>m</td>
<td style="text-align: center;">25 <span class="math inline"><em>μ</em></span>m</td>
</tr>
<tr class="even">
<td style="text-align: center;">1DP</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><a href="https://www.eol.ucar.edu/instruments/two-dimensional-optical-array-precipitation-probe">2DP</a> (new)</td>
<td style="text-align: center;">0-63</td>
<td style="text-align: center;">1-62</td>
<td style="text-align: center;">100–6400 <span class="math inline"><em>μ</em></span>m</td>
<td style="text-align: center;">100 <span class="math inline"><em>μ</em></span>m</td>
</tr>
</tbody>
</table>
<p><br />
</p>

### Count Rate Per Channel: ACDP, AFSSP, AS100, AF300, AS200, APCAS, A200X, A260X, A200Y, AUHSAS {#CRPC .unnumbered}

<em>The size distribution of the number of particles detected by a 1D hydrometeor probe per unit time.</em> These measurements have “vector” character in the NetCDF output files, with dimension equal to the number of channels in the table above and with one entry per channel. The first element in the vector is a historical remnant from a time when housekeeping information was stored here and should be ignored. For the size limits of the channels, see the netCDF attributes of the following variables for “Size Distribution”.</p>
<strong><span class="underline"><span id="punch:5-4" label="punch:5-4">[punch:5-4]</span><span id="punch:5-7" label="punch:5-7">[punch:5-7]</span></span><span class="underline"></span></strong><br />
<p><strong></strong></p>

### Size Distribution: {#size-distribution .unnumbered}

<p><strong>Size Distribution</strong> (<span class="math inline"><em>c</em><em>m</em><sup> − 3</sup></span>channel<span class="math inline"><em></em><sup> − 1</sup></span>)<strong>:</strong> <strong></strong> <strong><span class="underline">CFSSP</span>,</strong> <strong><span class="underline">CS100</span>,</strong> <strong><span class="underline">CF300</span>,</strong> <strong><span class="underline">CS200</span></strong>, <strong></strong> <strong><span class="underline">CPCAS</span>,</strong> <strong><span class="underline">CCDP</span>,</strong> <strong><span class="underline">CUHSAS</span></strong><br />
<strong>Size Distribution</strong> (L<strong><span class="math inline"><em></em><sup> − 1</sup></span></strong>channel<span class="math inline"><em></em><sup> − 1</sup></span>): <strong></strong> <strong><span class="underline">C200X</span>,</strong> <strong><span class="underline">C260X</span>,</strong> <strong><span class="underline">C200Y</span></strong></p>
<p><strong><span id="CUHSAS" label="CUHSAS">CUHSAS</span></strong><br />
<em>The particle concentrations</em> <em>in each usable bin of the probe.</em> These netCDF variables have “vector” character with dimension equal to the number of channels in the table above. The first vector member should be ignored. For some scattering spectrometer probes (FSSP-100, FSSP-300, PCASP) the concentration value is modified by the probe activity (FACT, PACT) as described below. The concentration is obtained from the total number of particles detected and a calculated, probe-dependent sample volume that is specified in recent projects by attributes (e.g., depth of field and beam diameter) of this variable in the netCDF file. For additional details, see the links in the table or, for older probes, <a href="https://opensky.ucar.edu/islandora/object/archives%3A8155">RAF Bulletin 24</a>.</p>
<p><strong></strong></p>

### Concentration (cm<span class="math inline"><em></em><sup> − 3</sup></span>): CONCD, CONCF, CONC3, CONCP, CONCU; 
(L<strong><span class="math inline"><em></em><sup> − 1</sup></span>):</strong> CONCX, CONC6, CONCY {#concentration .unnumbered}

<em>The particle concentrations</em> <em>summed over all channels to give the total concentration in the size range of the probe.</em> For example, {CONCF} = <span class="math inline">∑<sub><em>i</em></sub>{<em>C</em><em>F</em><em>S</em><em>S</em><em>P</em>}<sub><em>i</em></sub></span>. For additional details, see <a href="https://opensky.ucar.edu/islandora/object/archives%3A8155">RAF Bulletin 24</a>.<br />
</p>

### Mean Diameter (<span class="math inline"><em>μ</em></span>m): DBARD, DBARF, DBAR3, DBAR6, DBARP, DBARX, DBARY, DBARU {#mean-diameter .unnumbered}

<em>The arithmetic average of all measured particle diameters from a particular probe.</em> This mean is calculated as follows:<br />  
```{r child='DBARbox.Rmd'}
```
### Dispersion (dimensionless): DISPD, DISPF, DISP3, DISP6, DISPP, DISPX, DISPY, DISPU {#dispersion .unnumbered}

<em>The ratio of the standard deviation of particle diameters to the mean particle diameter.</em><br />  
```{r child='DISPbox.Rmd'}
```

### Liquid Water Content (g m<strong><span class="math inline"><em></em><sup> − 3</sup></span></strong>): PLWCD, PLWCF, PLWCX, PLWC6, PLWCY {#PSD-LWC .unnumbered}

<em>The density of liquid water represented by the size distribution measured by a hydrometeor probe.</em> These variables are calculated from the measured concentration (CONCx) and the third moment of the particle diameter, with the assumption that the particle is a water drop. The following box describes the calculation in terms of an equivalent droplet diameter, the diameter that represents the mass in the detected particle. The equivalent droplet diameter is normally the measured diameter for liquid hydrometeors, but some processing has used other assumptions and this is a choice that can be made based on project needs. Using this definition allows for the approximate estimation of ice water content in cases where it is known that all hydrometeors are ice.<br />  
```{r child='LWCbox.Rmd'}
```

### Radar Reflectivity Factor (dbZ): DBZF, DBZX, DBZ6, DBZY, DBZD {#DBZ .unnumbered}

<em>The radar reflectivity factor</em> <em>calculated from the measured size distribution from a hydrometeor probe.</em> This is calculated from the measured concentration and the sixth moment of the size distribution, with the assumption that the particles are water drops. An equivalent radar reflectivity factor can be calculated from the hydrometeor size distribution if another assumption is made about composition of the particles, but this variable is not part of normal data files. The radar reflectivity factor is a characteristic only of the hydrometeor size distribution; it is <em>not</em> a measure of radar reflectivity, because the latter also depends on wavelength, dielectric constant, and other characteristics of the hydrometeors. The normally used radar reflectivity factor is measured on a logarithmic scale that depends on a particular choice of units, so (although it is not conventional) an appropriate scale factor <span class="math inline"><em>Z</em><sub><em>r</em></sub></span> is included in the following equation to satisfy the convention that arguments of logarithms should be dimensionless.<br />  
```{r child='DBZbox.Rmd'}
```

<p><span id="punch:5-5" label="punch:5-5">[punch:5-5]</span></p>

### Effective Radius (<span class="math inline"><em>μ</em></span>m): REFFD, REFFF {#effective-radius .unnumbered}

<em>One-half the ratio of the third moment of the diameter measurements to the second moment.</em> This variable is useful in some calculations that relate the liquid water content of a cloud layer to its optical properties.<br />  
```{r child='REFFbox.Rmd'}
```

### FSSP-100 Range (dimensionless): FRNG, FRANGE {#fssp-range .unnumbered}

<em>The size range in use for the FSSP-100</em> <em>probe</em>.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Range</th>
<th style="text-align: center;"><strong>Nominal Size Range</strong></th>
<th style="text-align: center;"><strong>Nominal Bin Width</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">2–47 <span class="math inline"><em>μ</em><em>m</em></span></td>
<td style="text-align: center;">3 <span class="math inline"><em>μ</em><em>m</em></span></td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">2–32 <span class="math inline"><em>μ</em><em>m</em></span></td>
<td style="text-align: center;">2 <span class="math inline"><em>μ</em><em>m</em></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1–15 <span class="math inline"><em>μ</em><em>m</em></span></td>
<td style="text-align: center;">1 <span class="math inline"><em>μ</em><em>m</em></span></td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.5–7.5 <span class="math inline"><em>μ</em><em>m</em></span></td>
<td style="text-align: center;">0.5 <span class="math inline"><em>μ</em><em>m</em></span></td>
</tr>
</tbody>
</table>
<p><br />
<br />
In recent NETCDF data files, the actual bin boundaries used for processing are recorded in the header. That header should be consulted because processing sometimes uses non-standard sizes selected to adjust for Mie scattering, which causes departures from the nominal linear bins. Recent projects have all used range 0, but other choices have been made in some older projects and other ranges are still available to future projects.</p>
<!-- <h2 id="hydrometeor-imaging-probessubsechydrometeor-imaging-probes">Hydrometeor Imaging Probes<span id="subsec:Hydrometeor-Imaging-Probes"label="subsec:Hydrometeor-Imaging-Probes">[subsec:Hydrometeor-Imaging-Probes]</span></h2> -->
## Hydrometeor Imaging Probes {#hydrometeor-imaging-probes}
<p>Instruments used to obtain hydrometeor images include the two-dimensional imaging probes (<a href="https://www.eol.ucar.edu/instruments/two-dimensional-optical-array-cloud-probe">2DC</a> and <a href="https://www.eol.ucar.edu/instruments/two-dimensional-optical-array-precipitation-probe">2DP</a>) and some others that require special processing and separate data records. The former are described in this subsection. The latter include a three-view cloud particle imager (<a href="https://www.eol.ucar.edu/instruments/three-view-cloud-particle-imager">3V-CPI</a>), a small ice detector (<a href="https://www.eol.ucar.edu/instruments/small-ice-detector-version-2-hiaper">SID-2H</a>), and a holographic imager (<a href="https://www.eol.ucar.edu/instruments/holographic-detector-clouds">HOLODEC</a>). For information regarding use of data from the latter set of instruments, consult EOL/RAF data management via <a href="mailto:mailto:raf-dm%40eol.ucar.edu">this email address</a>.</p>
<p>In addition to the standard processing that produces the variables in this subsection, an alternate processor is available that provides some additional options and capabilities, including the production of two sets of variables that include either all particles or all particles that pass a roundness test. Additional options include different ways of defining the particle size (including circle fitting or sizing based on the dimension along the direction of flight. Corrections to sizing are made to account for diffraction, and a shattering correction can be applied based on interarrival times. Some categories of spurious images (e.g., “streakers”) can be recognized and rejected. This processing is described in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Bansemer2DProcessing.pdf">this document</a> and at <a href="https://www.eol.ucar.edu/software/process2d">this web page</a> and is made available by special arrangement.</p>
<p>Measurements based on the two 2D probes will be discussed together in this section because the 2DC and 2DP probes function similarly, differing primarily in the size resolution (typically 25 <span class="math inline"><em>μ</em></span>m or less for the 2DC and 100 or 200 <span class="math inline"><em>μ</em></span>m for the 2DP). The following variables have names like CONC1DC or CONC1DP to designate the two types of hydrometeor imagers. In addition, variables normally have location designations like ’_LWIO’ as described at the beginning of section ; see page . In the following ’y’ is sometimes used to designate either ’C’ or ’P’.</p>
<p>For the images from the 2D probes, separate data files need to be used. RAF provides a routine “<a href="https://www.eol.ucar.edu/software/xpms2d">XPMS2D</a>” that can be used to view the images and calculate various properties of the hydrometeor population based on these separate files.</p>

#### Special 1D Nomenclature {-#special-1d-nomenclature}

<p><span id="Despite-the-&#39;1D&#39;" label="Despite-the-&#39;1D&#39;"></span>Despite the ’1D’ nomenclature, the following variables are measured by 2D instruments; the ’1D’ designation is used to indicate that this is the dimension that would be sized by an equivalent 1D probe using a test that requires unshadowed end diodes so that the full dimension of the particle can be determined. As a consequence, the effective sample volume becomes smaller as the measured dimension increases.</p>

#### 2D Count Rate Per Channel (count per time interval): A1DC, A1DP {-#a1dc-a1dp}

<em>The number of particles counted by a 2D probe in each of 62 size bins in a specified time interval, usually 1 s.</em> These are used to calculate the derived variables like CONC1DC, C1DC, and others that follow, but are provided to allow re-calculation if a user wants to use different sample volumes or sizing assumptions.<br />

#### 2D Size Distribution (L<span class="math inline"><em></em><sup> − 1</sup></span>channel<span class="math inline"><em></em><sup> − 1</sup></span>): C1DC, C1DP {-#c1dc-c1dp} 

<em>The concentration of particles measured by a 2D probe in each of 62 bins in a specified time interval, usually 1 s.</em> These are calculated from A1DC by application of an assumed size-dependent sample volume based on probe characteristics and the flight speed. These are provided in a 64-element array for historical convention; the first element should be ignored, and the technique requires that the end elements be unshadowed and so precludes any measurement with width of 63 bins, so the 64-element vector has valid information only in bins 1–63. The cell boundaries are specified in the netCDF header as an attribute of C1DC or C1DP, and they specify the end points of the bin; e.g,, in the 64-element array of provided cell boundaries, the first element is the lower size limit of the first data cell which is the second element in C1DC. For a typical 2DC with 25-<span class="math inline"><em>μ</em></span>m size resolution, the cell sizes increase by 25 <span class="math inline"><em>μ</em></span>m per bin for each of the C1DC bins. Also included as attributes with the netCDF variable C1DC or C1DP are the size-dependent depth of field (mm) and effective sample area^[commonly called “EffectiveAreaWidth” in the netCDF files]
(mm), the latter having values of zero for the first and last elements in the 64-value vector.<br />

#### 2D Concentration (L<span class="math inline"><em></em><sup> − 1</sup></span>): CONC1DC, CONC1DC100, CONC1DC150, CONC1DP {-#conc2d}

<em>The total concentration of all particles detected by a 2D hydrometeor imager,</em> or in the case of CONC1DC100 or CONC1DC150, the concentration of all particles sized to be at least xxx <span class="math inline"><em>μ</em></span>m in the dimension perpendicular to the direction of flight, where xxx may be 100 150. These concentrations are the sum of the particle size distribution given below (C1DC or C1DP), with appropriate channels excluded for CONC1DC100 and CONC1DC150.<br />

#### 2D Dead Time (ms): DT1DC {-#dt1dc}

<em>The time in the sample interval during which the data rate exceeded the recording capability of a 2DC probe.</em> This is used as a correction factor when concentrations like CONC1DC or C1DC are calculated. The variable does not apply to measurements from a 2DP probe.<br />

#### 2D Mean Diameter (<span class="math inline"><em>μ</em></span>m): DBAR1DC, DBAR1DP {-#dbar2d} 

<em>The mean diameter calculated from the measured size distribution.</em> In this calculation, the bin sizes are taken to be the averages of the lower and upper limits of the size bins<em>.</em> The calculation is as described by \@ref(eq:DBARbox). <em></em><br />

#### 2D Dispersion (dimensionless): DISP1DC, DISP1DP {-#disp2d}

<em>The standard deviation in particle diameter divided by the mean diameter.</em> The formula used is given by \@ref(eq:DISPbox).<br />

#### 2D Liquid Water Content (g m<span class="math inline"><em></em><sup> − 3</sup></span>): PLWC1DC, PLWC1DP {-#lwc2d} 

<em>The liquid water content (mass per volume) calculated from C1DC or C1DP.</em> The calculation is as described by \@ref(eq:LWCbox). To conform to common usage, the liquid water content is expressed in non-MKS units of g m<span class="math inline"><em></em><sup> − 3</sup></span>.<br />

#### 2D Radar Reflectivity Factor (dBZ): DBZ1DC, DBZ1DP {-#dbz2d}

<em>The radar reflectivity factor calculated from the measured size distribution under the assumption that all particles are spherical water drops.</em> The calculation is as described by <em></em> \@ref(eq:DBZbox).<br />

#### 2D Effective Radius (<span class="math inline"><em>μ</em></span>m): REFF2DC, REFF2DP {-#reff2d}

<em>One-half the ratio of the third moment of the particle diameter to the second moment.</em> The formula used is given by \@ref(eq:REFFbox).<span id="punch:5-6" label="punch:5-6">[punch:5-6]</span><br />
</p>




<!--chapter:end:Section5.Rmd-->


# Air Chemistry Measurements

```{r child='boxStyles.Rmd'}
```
<!-- <h2 id="variables-in-standard-data-filespunch6-1">Variables in Standard Data Files<span id="punch:6-1" label="punch:6-1">[punch:6-1]</span></h2> -->
## Variables in Standard Data Files

#### Carbon Monoxide Preliminary Mixing Ratio (ppbv): CORAW_AL {-#coraw-al}

<em>The preliminary measurement of CO mixing ratio from the Aero-Laser model AL-5002 CO analyzer, before final calibrations are applied.</em> This instrument measures CO by vacuum ultraviolet resonance fluorescence. It is a commercial version of the instrument described by Gerbig et al.^[Journal of Geophysical Research, Vol. 104, No. D1, 1699-1704, 1999.]
The instrument is described further at <a href="https://www.eol.ucar.edu/instruments/aero-laser-vuv-resonance-fluorescence-carbon-monoxide-instrument">this URL</a>. The time resolution is 1 second. This variable is sometimes present in flight and in preliminary ground processing, but normally it is replaced by COMR_AL in final processing.</p>

#### Carbon Monoxide Mixing Ratio (ppbv): COMR_AL {-#comr-al}

<em>The mixing ratio measured by the Aero-Laser model AL-5002 CO analyzer.</em> See also CORAW_AL above. The calculation of COMR_AL is based on in-flight calibrations conducted 1-2 times per hour, when a gas of known concentration is supplied to the instrument and then a catalyst trap removes CO to provide a zero reference. The calibration results in a sensitivity and zero that are then used to convert the measurements from the instrument (recorded as counts per second) to a mixing ratio in units of ppbv. Time-dependent sensitivity and zero coefficients are computed post-flight as a linear interpolation between flight calibrations. This variable normally appears in final data sets for a project.^[In isolated cases XCOMR or XCOMR_AL was used for this variable name.]
The algorithm is described in the following box:<br />  
```{r child='COMRbox.Rmd'}
```

See also the obsolete variables in Section \@ref(obsolete-variables), where variables from an earlier TECO Model 48 CO analyzer, in use before 2000, are described.</p>

#### Carbon Dioxide and Methane Mixing Ratios (ppmv): CO2_PIC and CH4_PICx {-#co2-pic}
 
<em>Respectively, the carbon dioxide and methane mixing ratio measured by a Picarro CO2/CH4 instrument.</em> The letter ’x’ may be replaced by the model number of the instrument (e.g., 1301) or it may be blank. The Picarro CO2/CH4 G1301-f flight analyzer is a fast response trace gas monitor that measures CO<span class="math inline"><em></em><sub>2</sub></span> and CH<span class="math inline"><em></em><sub>4</sub></span> using wavelength-scanned cavity ring-down spectroscopy. The time resolution is 0.2 – 1 seconds. Additional information characterizing the instrument can be found at <a href="https://www.eol.ucar.edu/instruments/picarro-instrument-airborne-measurement-co2-and-ch4">this URL</a>. During flight, both measurements are calibrated 1-2 times per hour via sampling of a working standard, and linear calibration coefficients are applied based on multi-point lab calibration data and in-flight calibration checks. The procedure is analogous to that used for COMR_AL, as described immediately above. When water vapor is not removed from the ambient sample stream (the normal case), a correction factor for water present in the sensing cell must be applied following the approach of Richardson et al.,^[Richardson, S. J., N. L. Miles, K. J. Davis, E. R. Crosson, C. W. Rella, and A. E. Andrews, 2012<em>:</em> Field testing of cavity ring-down spectroscopy analyzers measuring carbon dioxide and water vapor. <em>J. Atmos. Oceanic_Technol,</em> <strong><em>29,</em></strong> <em>397–406.</em>]
as follows:<br />  
```{r child='CO2PICbox.Rmd'}
```

#### Chemiluminescent Ozone Sample and Nitric Oxide Flow Rates (sccm): XFO3FS, XF03FNO {-#xfo3fs} 

<em>Flows within the chemiluminescence ozone sensor.</em> The sample rate, in standard <span class="math inline"><em>c</em><em>m</em><sup>3</sup>/<em>s</em></span>, is XFO3FS, while XFO3FNO gives the NO flow rate in the same units. These variables apply to measurements made by an earlier version of the fast ozone instrument. They have not been present in projects since 2006.</p> 

#### Chemiluminescent Ozone Sample Pressure (mb): XFO3P {-#xfo3p}

<em>Sample pressure in the chemiluminescence ozone sensor.</em> This variable was associated with
measurements made by an earlier version of the fast ozone instrument. It has not been present in projects since 2006.

#### Fast response NO chemiluminescence ozone mixing ratio (ppbv): FO3_ACD, FO3_CL, XO3, O3MR_CL {-#fo3-acd}

<em>The ozone mixing ratio (by volume) measured by an NO chemiluminescence instrument.</em> The instrument detects chemiluminescence from the reaction of nitric oxide (NO) with ambient ozone, using a dry-ice cooled, red-sensitive photomultiplier employing photon-counting electronics. The measurement principle is described by Ridley et al. (1992),^[Ridley, B. A., F. E. Grahek, and J. G. Walega, 1992: A small, high-sensitivity, medium-response ozone detector suitable for measurements from light aircraft. <em>J. Atmos. Oceanic Technol.,</em> <strong>9,</strong> 142–148.]
and there is additional information describing the instrument at <a href="https://www.eol.ucar.edu/instruments/nitric-oxide-chemiluminescence-ozone-instrument">this URL</a>. The time resolution is 0.2 seconds, and typical uncertainty is 5%. The background signal is measured 1-2 times hourly during flights. Linear calibration coefficients are applied to the photon count rate to produce mixing ratios, and a correction is applied for water vapor during final processing, as follows:<br />  
```{r child='O3box.Rmd'}
```

#### Uncorrected TECO Ozone Mixing Ratio (ppb): TEO3 {-#te03}

<em>The uncorrected ozone mixing ratio output from the TECO model 49c UV ozone analyzer.</em> See TEO3C.</p>

#### Internal TECO Ozone Sampling Pressure (hPa): TEP, TEO3P {-#tep}

<em>The pressure inside the detection cell of the TECO 49 UV ozone analyzer.</em> This and the following temperature are used to convert the measurements from the instrument to units of ppbv. 

#### Internal TECO Ozone Sampling Temperature (<span class="math inline"><em></em><sup>∘</sup><em>C</em></span>): TET {-#tet}

<em>The temperature inside the detection cell of the TECO 49 UV ozone analyzer.</em> This and the preceding pressure are used to convert the measurements from the instrument to units of ppbv. In many projects, the cell temperature was not recorded so an expected cell temperature in the aircraft cabin must be used in processing.

#### Corrected TECO Ozone Mixing Ratio (ppbv): TEO3C {-#te03c}

<em>The ozone mixing ratio (by volume) determined by the TECO model 49c UV ozone analyzer (cf. <a href="https://www.eol.ucar.edu/instruments/thermo-environmental-instruments-model-49-ozone-analyzer">this description</a>) after correction for the pressure and temperature in the cell by application of the ideal gas law.</em> Because the basic measurement is ozone density in the chamber, this measurement must be converted to a mixing ratio by dividing by the air density, calculated from the pressure and temperature measured in the chamber (TEP and TET respectively).<span id="punch:6-3" label="punch:6-3">[punch:6-3]</span> The instrument provides output only each ten seconds, and measurements are collected in the 3 s preceding the update. The measurements may be artificially high or low when rapid changes in humidity are present, as may occur when crossing the top of the boundary layer or when going through clouds. In operation on the ground prior to takeoff or immediately after landing, a high concentration of hydrocarbons can cause spuriously high measurements. The detection limit is 1 ppbv with an uncertainty of <span class="math inline">±</span>5%. This instrument is seldom used as of 2014 and may soon be classified as obsolete.</p>

#### NO, NO~y~ Variables: {-#no-noy}

<strong>NO Raw Counts (counts per sample interval): <span class="underline">XNO</span></strong><br /> 
<strong>NOy Raw Counts (counts per sample interval):</strong> <strong></strong> <strong><span class="underline">XNOY</span><span class="underline"></span></strong><br />
<strong>NO Calibration Flow (SLPM):</strong> <strong></strong> <strong><span class="underline">XNOCF</span></strong><br />
<strong>NOy Calibration Flow (SLPM):</strong> <strong></strong> <strong><span class="underline">XNCLF</span></strong><br />
<strong>NO, NOy Measurement Status (dimensionless):</strong> <strong></strong> <strong><span class="underline">XNST</span></strong><br />
<strong>NO Zero Air Flow (SLPM):</strong> <strong></strong> <strong><span class="underline">XNOZA</span></strong><br />
<strong>NOy Zero Air Flow (SLPM):</strong> <strong></strong> <strong><span class="underline">XNZAF</span></strong><br />
<strong>NO Sample Flow (SLPM):</strong> <strong></strong> <strong><span class="underline">XNOSF</span></strong><br />
<strong>NOy Sample Flow (SLPM):</strong> <strong></strong> <strong><span class="underline">XNSAF</span></strong><br />
<strong>NOy Reaction Chamber Pressure (mb):</strong> <strong></strong> <strong><span class="underline">XNOYP</span></strong><br />
<strong>Gold NOy Converter Temperature (<span class="math inline">º</span>C):</strong> <strong></strong> <strong><span class="underline">XNMBT</span></strong></p>
<p><br />
<em>The measurements provided by the NO+NO<span class="math inline"><em></em><sub>2</sub></span> instrument,</em> which is described at <a href="https://www.eol.ucar.edu/instruments/no-no2-instrument">this link</a><em>.</em> XNO and XNOY are the raw data counts from the NO and NO<span class="math inline"><em></em><sub>2</sub></span> instruments, respectively, and XNCLF and XNOCF are the respective calibration flows for these instruments. <span id="punch:6-2" label="punch:6-2">[punch:6-2]</span> XNST records the status for both instruments: In measurement mode, XNST is 0, while XNST is 5 when the instruments are in zero mode and 10 when the instruments are in calibration mode. the NOy and NO instruments. The instrument is in the measure mode for XNST of 0. For a XNST reading of 5 the instruments are in the zero mode. XNST value of 10 is the calibration mode. XNOZA and XNZAF are flow rates for zero air used to back flush inlets, typically at takeoff and landing, and for calibration using “zero” air. Even if the status, XNST, is 0, indicating the instrument is in the measurement mode, when XNOZA and XNZAF are approximately 1 SLPM the instrument is measuring zero air and not ambient air. <span id="punch:6-4" label="punch:6-4">[punch:6-4]</span> XNOSF and XNSAF are the sample flow rates through the NO and NO<span class="math inline"><em></em><sub>2</sub></span> instruments respectively. These values are typically about 1 SLPM. XNMBT is the temperature of the gold NO<span class="math inline"><em></em><sub>2</sub></span> converter.</p>

#### Corrected NO and NO~2~ Mixing Ratios (ppbv): XNOCAL, XNYCAL {-#mr-no-no2}

<em>The calibrated NO and NO~2~ volumetric mixing ratio, respectively, measured by the NO-NO~2~ instrument.</em> See <a href="https://www.eol.ucar.edu/instruments/nitric-oxide-chemiluminescence-ozone-instrument">this link</a> for a description of the instrument.<span id="punch:6-5" label="punch:6-5">[punch:6-5]</span> The NO and NO~2~ data are represented by a cubic spline for baseline subtraction, and then the calibration coefficients are applied and the measurements are converted to units of ppbv. The quality of the data can be assessed by examining the accuracy of the zero correction. This instrument <span id="punch:6-6" label="punch:6-6">[punch:6-6]</span> adds water vapor to the sample stream to reduce the effect of ambient water on the final signal. The water vapor addition is not sufficient to saturate the sample stream, but enough to remove much of the interference. The detection limits of the NO, NO~2~ instruments are 50 ppbv for a one-second averaging time. The uncertainty is <span class="math inline">±</span> 5%.

<!-- <h2 id="variables-in-special-data-sets">Variables in Special Data Sets</h2> -->
## Variables in Special Data Sets {#awas-cims-qcls-toga}

Research projects often incorporate user-supplied instruments into payloads, and those instruments produce data files that are either recorded independently or merged into the standard netCDF data files for the projects. In addition, NCAR offers a set of instruments that require additional data processing and analysis, often because the measurements require special interpretation to obtain the desired measurements. The following instruments can provide such air-chemistry measurements:

* \setlength{\itemsep}{-1\parsep}Advanced Whole Air Sampler [AWAS](http://www.eol.ucar.edu/instruments/advanced-whole-air-sampler)

* Chemical Ionization Mass Spectrometer [CIMS](http://www.eol.ucar.edu/instruments/georgia-tech-chemical-ionization-mass-spectrometer)

* Quantum Cascade Laser Spectrometer [QCLS](http://www.eol.ucar.edu/instruments/quantum-cascade-laser-spectrometer)

* Trace Organic Gas Analyzer [TOGA](http://www.eol.ucar.edu/instruments/trace-organic-gas-analyzer)  


<br />
Follow the links in the box to descriptions of these instruments on the EOL web site. Those descriptions include brief explanations of how data are acquired and handled. The process varies with instrument; The CIMS and QCLS instruments produce variables that are often merged into the standard netCDF archived data files for projects, the AWAS collects samples that are later analyzed using ground-based instruments but result in a special dataset dependent on analysis technique and sample location and duration, while the TOGA is usually analyzed to produce dozens of trace-gas measurements, some of which can be merged into standard netCDF files.</p>
<p>Users interested in using these measurements should contact <a href="mailto:mailto:raf-dm%40eol.ucar.edu">EOL/RAF data management</a> for data access and assistance.</p>

<!--chapter:end:Section6.Rmd-->

# Aerosol Particle Measurements {#aerosol-particle-measurements}

```{r child='boxStyles.Rmd'}
```
<!-- <h2 id="condensation-nucleus-counters">Condensation Nucleus Counters</h2> -->
## Condensation Nucleus Counter

<p>RAF uses two modified TSI, Inc. <a href="http://www.eol.ucar.edu/instruments/condensation-nucleus-counter-water-or-butanol">condensation nucleus counters</a> to measure the total concentration of ultrafine particles in the atmosphere, a 3760A using n-butyl alcohol and a water-based 3786 WCN (water condensation nucleus) counter. Both are sensitive to particles in the approximate diameter range from 0.010–3 <span lang="el">m</span>m.<br />
</p>

#### CN Counter Inlet Pressure (hPa): PCN {-#pcn}
]
<em>The absolute pressure inside the inlet tube of the instrument.</em> It as measured by a Heise Model 623 pressure sensor for the 3760A, and internally by the 3786 WCN.. The measurement is used to convert the measured mass flow (FCN or XICN) to volumetric flow and to convert measured particle concentration to equivalent ambient concentration.</p>

#### CN Counter Inlet Temperature (<span class="math inline"><em></em><sup>∘</sup></span>C): CNTEMP, TEMP1, TEMP2 {-#cntemp}

<em>The sample air temperature measured at the intake of the 3760A or within the 3786.</em> The value is used to convert the measured mass flow (FCN or XICN) to true volumetric flow and to convert measured particle concentration to equivalent ambient concentration.</p>

#### Raw and Corrected CN Counter Sample Flow Rate (SLPM, VLPM): FCN, FCNC {-#fcnc}

<em>The raw and corrected sample flows in the CN counters</em> are treated differently for the two models of CN counter. In the 3760A, FCN is measured in standard liters per minute (SLPM) with a mass flow meter. The flow meter gives the volumetric flow rate that would apply under standard conditions of 1013.25 hPa and 21<span class="math inline"><em></em><sup>∘</sup></span>C. FCNC is the corrected sample flow rate in volumetric liters per minute (VLPM) <em>at instrument pressure and temperature</em>. For the 3760A:<br />
```{r child='FCNCbox.Rmd'}
```
In the 3786, flows are determined in volumetric cm<span class="math inline">$^{3}\thinspace\mathrm{min}^{-1}$</span> from the pressure drop across an orifice. The 3786 firmware makes density corrections internally, so its reported sample flow is brought directly into the variable FCNC in units of VLPM.<br />
</p>

#### Raw and Corrected CN Isokinetic Side Flow Rate (SLPM, VLPM): XICN,  XICNC {-#xicnc}

<em>XICN is the raw isokinetic side flow rate in standard liters per minute (SLPM) measured with a mass flow meter, and XICNC is that flow corrected for pressure and temperature to be the true volumetric flow.</em> The side flow is adjusted for isokinetic sampling at the inlet, but it is not used further in processing.<br />
```{r child='XICNCbox.Rmd'}
```

#### CN Counter Output (counts per sample interval): CNTS {-#cnts}

<em>The raw output count from the condensation nucleus counter.</em> For the 3760A condensation nucleus counter, the project-dependent sample rate may be chosen in the range from 1–50 Hz but it is typically 10 Hz. In some unusual cases the counts are divided by a selected power of two to keep the counter from overflowing; see project documentation. The 3786 WCN may be programmed to report data at intervals from 0.1–3600 s.<span id="punch:7-1" label="punch:7-1">[punch:7-1]</span></p>

#### Condensation Nucleus (CN) Concentration (cm^-3^): CONCN {-#concn}

<em>The number concentration of condensation nuclei</em> in units of particles per cm<span class="math inline"><em></em><sup>3</sup></span> <em>in the ambient air</em> at flight level. <em></em> The calculation leading to CONCN includes two corrections. The first accounts for coincidence of particles in the viewing volume at high concentrations and is handled differently in the two types of CN counter. For the 3760A, a statistical adjustment is made based on the average time of a particle in the viewing volume. This correction increases from about 1% at a total concentration of 10<span class="math inline"><em></em><sup>3</sup></span> cm<span class="math inline"><em></em><sup> − 3</sup></span> to nearly 11% at 10<span class="math inline"><em></em><sup>4</sup></span> cm<span class="math inline"><em></em><sup> − 3</sup></span>, but for concentrations above about 210<span class="math inline"><em></em><sup>4</sup></span> cm<span class="math inline"><em></em><sup> − 3</sup></span> significant uncertainty remains. The 3786 instead measures the time each detected particle occupies the viewing volume, and this <em></em> accumulated “dead time” in each sampling interval is subtracted from the elapsed time yielding a “live time” for the determination of sample volume. With this correction an accuracy of 12%, not including statistical counting error, is specified by the manufacturer at concentrations up to 10<span class="math inline"><em></em><sup>5</sup></span> cm<span class="math inline"><em></em><sup> − 3</sup></span>. The second correction, applied to all CN counters, is a conversion from instrument to ambient conditions.^[Prior to Dec. 2007 the conversion to ambient concentration was not made and concentration was reported for instrument conditions.]
In the following formulae, the corrected flow FCNC in VLPM is explicitly converted to cm<span class="math inline"><em></em><sup>3</sup></span>s<span class="math inline"><em></em><sup> − 1</sup></span> by the factor (1000/60).<em></em><br />
<em></em><br />
</p>
<p><strong>For the 3760A:</strong><br />  
```{r child='CONCNbox.Rmd'}
```

<p><strong>For the 3786 WCN:</strong><br />
```{r child='CONCN2box.Rmd'}
```

</p>
<!-- <h2 id="aerosol-spectrometers">Aerosol Spectrometers</h2> -->
## Aerosol Spectrometers

<p>For size-resolved measurements of the concentration of aerosol particles, RAF deploys two instruments. The <a href="https://www.eol.ucar.edu/instruments/ultra-high-sensitivity-aerosol-spectrometer">Ultra High Sensitivity Aerosol Spectrometer</a> (UHSAS) sizes particles in 99 bins from 0.06 to 1.0 <span lang="el">m</span>m diameter, and the <a href="http://www.eol.ucar.edu/instruments/passive-cavity-aerosol-spectrometer-probe">Passive Cavity Aerosol Spectrometer Probe</a> (PCASP) has 30 channels covering the diameter range 0.1 to 3 <span lang="el">m</span>m. Flow and total concentration variables for these instruments are described in this section, while additional variables are covered along with other 1-D probes in Sect.\ \@ref(sensors-1-D-probes), “Sensors Detecting Individual Hydrometeors (1-D Probes).”</p>

#### UHSAS Absolute Pressure in Optics Block (kPa): UPRESS {-#upress}

The pressure internal to the UHSAS instrument. This is an analog measurement with calibration coefficients as recorded in the attributes for the variable.<span id="punch:7-2" label="punch:7-2">[punch:7-2]</span></p>

#### Raw and Corrected Sample Flow Rate (cm^3^s^-1^): USMPFLW or PFLW; USFLWC or PFLWC {-#pflw}

Unlike the other 1-d probes, both UHSAS and PCASP have internal pumps so their sample volumes are determined from the measured flows and do not depend on true air speed. The UHSAS measures volumetric flow directly, and it is adjusted to ambient conditions for the calculation of ambient concentration. The PCASP returns a mass flow referenced to standard conditions, and this also is converted to equivalent ambient volumetric flow.<br />
```{r child='PFLWCbox.Rmd'}
```

#### Total particle counts per sample interval, UHSAS or PCASP: TCNTU, TCNTP {-#tcntu-tcntp}

The total particle counts in each sample interval for, respectively, the UHSAS and PCASP instruments. These values are the sum of counts in all cells of the spectrometers, as represented in the vector variables CUHSAS or CS200. See the discussion of these variables in Sect.\ \@ref(sensors-1-D-probes).

#### Concentration, sum over all channels (cm^-3^s^-1^): CONCU, CONCP, CONCU100, CONCU500 {-#concu-concp{}}

<em>The particle concentrations summed over all or a subset of channels.</em> CONCU and CONCP are summed over all channels in the UHSAS and PCASP, respectively, and are calculated as in the following boxed equations. CONCU100 and CONCU500 are concentrations summed over channels in the UHSAS giving particle concentrations for diameters greater than or equal to 100 nm and 500 nm, respectively, and are calculated as for CONCU except with TCNTU replaced by the sum over the appropriate channels.<br />  
```{r child='CONCUbox.Rmd'}
```

<!-- <h2 id="special-aerosol-measurements">Special Aerosol Measurements</h2> -->
## Special Aerosol Measurements {#special-aerosol}

<p>Data from an aerosol mass spectrometer, a scanning mobility particle spectrometer, and a giant nucleus impactor are recorded by these instruments in separate data files and are not recorded by the aircraft data system. The ancillary data sets are not merged into the netCDF archives produced by EOL, so the special data files must be used for these measurements. The data formats are described with the instruments at the references given below:<br />
<br />

* <strong>Aerosol Mass Spectrometer (AMS) data files</strong> contain size-segregated chemical composition of non-refractory, submicron aerosol particles. The instrument is described here: [AMS](https://www.eol.ucar.edu/instruments/time-flight-aerosol-mass-spectrometer).  
* <strong>Scanning Mobility Particle Spectrometer (SMPS) files</strong> contain fine particle differential size distributions. The number of channels and covered size range are variable. Diameter ranges from about 7.5 nm up to about 500 nm (pressure-dependent), and 15 size bins are typical. The instrument is described here: [SMPS](https://www.eol.ucar.edu/instruments/scanning-mobility-particle-spectrometer).  
* <strong>Auto-GNI, GNI Giant Nuclei Impactor (GNI) files</strong> contain dry differential particle size distributions. The instrument is described here: [GNI](https://www.eol.ucar.edu/instruments/giant-nuclei-impactor).  

<!--chapter:end:Section7.Rmd-->

# Radiation Variables

```{r child='boxStyles.Rmd'}
```
<!-- <h2 id="measurements-of-irradiance-and-radiometric-temperature">Measurements of Irradiance and Radiometric Temperature</h2> -->
## Measurements of Irradiance and Radiometric Temperature

<p>The following references, although in part obsolete now, have additional information on radiation measurements from NCAR aircraft: <a href="https://opensky.ucar.edu/islandora/object/archives%3A8153">RAF Bulletin 25</a>, <a href="http://nldr.library.ucar.edu/repository/assets/technotes/TECH-NOTE-000-000-000-175.pdf">Bannehr and Glover, 1991, NCAR Technical Note NCAR/TN-364+STR</a>, and <a href="http://journals.ametsoc.org/doi/pdf/10.1175/1520-0450%281977%29016%3C0190%3APFIPP%3E2.0.CO%3B2">Albrecht and Cox, 1977</a>.^[Albrecht, B. and Cox, S.K.: 1977, Procedure for Improving Pyrgeometer Performance, J<em>. Appl. Meteorol.</em>, <strong>16,</strong> 188–197.]
The instruments are described in the “Radiation” section on <a href="https://www.eol.ucar.edu/aircraft-instrumentation">the EOL web site</a>. Some other radiometric measurements appear in Section\ \@ref(the-state-of-the-atmosphere) because the measurements fit better there with measurements of state variables for the atmosphere; these include two measurements of air temperature by radiometric thermometers, [AT_ITR](\#AT_ITR) and [OAT](\#OAT), and the Microwave Temperature Profiler [MTP](http://www.eol.ucar.edu/instruments/microwave-temperature-profiler) that measures temperature profiles above and below the aircraft by radiometric measurements.<br />
</p>

#### Radiometric (Surface or Sky/Cloud-Base) Temperature (<span class="math inline"><em></em><sup>∘</sup><em>C</em></span>): RSTx {-#rstx}

<em>The equivalent black body temperature measured by an infrared radiometer.</em> The radiometers used on the GV and C-130 are Heimann Model KT-19.85 precision radiation thermometers. The KT19.85 spectral band extends from 9.6 to 11.5 m, and it has a 2̊ field of view. The x in the variable name denotes the instrument location on either the bottom (B) or top (T) of the aircraft. The KT-19.85 instruments are calibrated using a black-body source manufactured by Eppley.^[Some archived projects used this variable name for measurements from a narrow bandwidth, narrow field-of-view (2<span class="math inline">º</span>) Barnes Engineering Model PRT-5 precision radiation thermometer. This instrument is now retired. The spectral bandwidth available was either 8 to 14 <span class="math inline"><em>μ</em><em>m</em></span> or 9.5 to 11.5 <span class="math inline"><em>μ</em><em>m</em></span>. Its cavity temperature was monitored and recorded as either TCAVB or TCAVT.]

#### Radiometer Sensor Head Temperature (<span class="math inline"><em></em><sup>∘</sup><em>C</em></span>): TRSTx {-#trstx}

<em>The temperature of the sensing head of the KT19.85 radiometer sensing head</em>, usually applying to RSTB, the primary down-looking instrument. The down-looking instrument is normally heated to maintain a sensor-head temperature near the scene temperature. Consult the archived netCDF files or project reports for the calibration coefficients used, which often varied among projects.

#### Pyrgeometer Output (V): IRxV {-#irxv}

<em>The voltage representing long-wave irradiance,</em> from a pyrgeometer manufactured by Kipp &amp; Zonen. The CGR4 model used on the GV and C-130 includes a meniscus dome that provides a 180º field of view with negligible directional response error over the spectral range of 4.2 to 45 m. The thermal stability of the dome construction and coupling to the instrument body eliminates the need for dome temperature measurements or dome shading. It is calibrated at the Naval Research Lab over a range of temperatures encountered during flight according to procedures specified by Bucholtz et al. (2008).^[Bucholtz , Anthony, Robert T. Bluth , Ben Kelly, Scott Taylor, Keir Batson, Anthony W. Sarto , Tim P. Tooman , Robert F. McCoy, 2008: The Stabilized Radiometer Platform (STRAP) — An Actively Stabilized Horizontally Level Platform for Improved Aircraft Irradiance Measurements. <em>J. Atmos. Oceanic Technol.</em> , <strong>25,</strong> 2161 – 2175.]
The pyrgeometers are usually flown in pairs, one looking upward and one looking downward. The letter ’x’ denotes location on either bottom (B) or top (T) of the aircraft. The primary derived variable from this instrument is IRxC, below.

#### Pyrgeometer Housing Temperature (<span class="math inline"><em></em><sup>∘</sup></span>C): IRxHT {-#irxht}

<em>The temperature of the modified pyrgeometer housing,</em> measured by a platinum resistance temperature sensor. The calibrated temperature (IRxHT) is derived from the raw signal (IRxHTV) as described below:<br />

#### Calibrated Infrared Irradiance (W m^-2^): IRxC {-#irxc}

<em>The infrared irradiance measured by a Kipp &amp; Zonen CGR4 instrument,</em>^[Prior to 2009, IRx and IRxC were used to denote measurements from Eppley pyrgeometers. Processing methods for these obsolete variables are described in Section\ \@ref(obsolete-variables).]
<em></em> after application of a calibration function. The relationship between IRxV (V) and IRxC (W m<span class="math inline"><em></em><sup> − 2</sup></span>) is determined by a calibration in which the CGR4 views a NIST-referenced source over a range of sensor temperatures controlled by a cold bath. The processing algorithm is described in the following box:<br />
```{r child='IRxHTbox.Rmd'}
```

#### Pyranometer Output (V): VISxV {-#visxv}

<em>The voltage from a pyranometer,</em> representing visible irradiance. On the GV and C-130, Kipp &amp; Zonen CMP22 pyranometers measure visible irradiance. A high-quality quartz dome allows for a wide spectral range, improved directional response, and reduced thermal offsets. The spectral range is 0.32 to 3.6 m. The pyranometers are usually flown in pairs, one looking upward and one downward. On the C-130, these sensors are mounted on stabilized platforms that remain level during aircraft pitch and roll variations. They are calibrated pre- and post-project at the Naval Research Lab (Bucholtz et al, 2008; see footnote <a href="#fn:Bucholtz-2008" data-reference-type="ref" data-reference="fn:Bucholtz-2008">[fn:Bucholtz-2008]</a> on page ) using a sun-tracking shadow device and diffuse sunlight as a source. The letter ’x’ denotes either bottom (B, nadir-viewing) or top (T, zenith-viewing). The primary derived variable from this instrument is VISxC, below.

#### Pyranometer Housing Temperature (<span class="math inline"><em></em><sup>∘</sup></span>C): VISxHT {-#visxht}

<em>The temperature of the modified housing unit of a pyranometer,</em> measured by a platinum resistance temperature sensor. A calibrated temperature (VISxHT) is derived from the raw signal, VISxHTV, which is normally not included in archive netCDF files. The equation used for the calibration is VISxHT = <span class="math inline"><em>a</em><sub>1</sub> + <em>a</em><sub>2</sub>log<sub>10</sub></span>({VISxHTV}/<span class="math inline"><em>V</em><sub>1</sub></span>) where <span class="math inline"><em>V</em><sub>1</sub></span>is 1 V and <span class="math inline">{<em>a</em><sub>1</sub>, <em>a</em><sub>2</sub>}</span> are calibration coefficients having dimensions of <span>[</span><span class="math inline"><em></em><sup>∘</sup></span>C<span>]</span>.<br />

#### Calibrated Visible Irradiance (W m^-2^): VISxC {-#visxc}

<em>The visible irradiance measured by a Kipp &amp; Zonen CMP22 pyranometer.</em> The relationship between VISxV (V) and VISxC (W m<span class="math inline"><em></em><sup> − 2</sup></span>) is determined by calibration procedures in which the CMP22 views a clear sky source while a sun-tracking device blocks direct solar radiation. The normal processing algorithm is to apply a simple linear calibration, as follows:<br />  
```{r child='VISxCbox.Rmd'}
```

#### Stabilized Platform Angles (<span class="math inline"><em></em><sup>∘</sup></span>): SPxPitch, SPxRoll {-spx}

<em>The pitch and roll angles of the stabilized platforms, relative to the aircraft reference frame.</em> Upward- and downward-looking pyrgeometers and pyranometers on the C-130 are mounted on stabilized platforms that compensate for aircraft pitch and roll. These variables record the movement of the top (x=T) and bottom (x=B) platforms in response to aircraft pitch and roll changes. The platforms are mounted with 2.85<span class="math inline"><em></em><sup>∘</sup></span> downward pitch angle to compensate for the normal upward pitch of the aircraft. The range of motion is <span class="math inline"> ± 5<sup>∘</sup></span> in pitch and <span class="math inline"> ± 10<sup>∘</sup></span> in roll. The sign convention is that of the aircraft, for which nose-upward pitch and right-wing-down roll are positive.

<!-- <h2 id="spectral-irradiance-and-actinic-flux">Spectral Irradiance and Actinic Flux</h2> -->
## Spectral Irradiance and Actinic Flux {#harp}

<p>The HIAPER Atmospheric Radiation Package (HARP) includes separate components that measure spectral irradiance (both upwelling and downwelling) and actinic flux. The instrument is described at <a href="http://www.eol.ucar.edu/instruments/hiaper-airborne-radiation-package">this URL</a>. Data are recorded on dedicated disk drives associated with the instrument, not in the standard aircraft data-system files. This is an ancillary data set, for which special Matlab and IDL analysis routines have been developed, but the measurements are not merged into the netCDF archives produced by EOL. For data access and assistance with analysis routines, contact EOL/RAF data managers at <a href="mailto:raf-dm@eol.ucar.edu">mailto:raf-dm@eol.ucar.edu</a>.</p>
<!-- <h2 id="solar-angles">Solar Angles</h2> -->

## Solar Angles

The calculations described in this group are used primarily when interpreting the calibrated visible irradiance (VISxC) but can be used by themselves or in conjunction with other measurements that need them. For additional documentation see <a href="http://nldr.library.ucar.edu/repository/assets/technotes/TECH-NOTE-000-000-000-175.pdf">Bannehr and Glover, 1991, NCAR Technical Note NCAR/TN-364+STR</a> and <a href="http://www.esrl.noaa.gov/gmd/grad/solcalc/calcdetails.html">this NOAA web site</a>.^[The descriptions of SOLZE, SOLEL, and SOLAZ in Bulletin 9 were incorrect, but the code in use has been consistent and correct and continues to be used unchanged. For reference, that code is contained in the nimbus subroutine ’solang.c’.]
The calculator at <a href="http://www.esrl.noaa.gov/gmd/grad/solcalc/">this link</a> can also be used to find these angles from the position and time in data files.

#### Solar Declination Angle (radians): SOLDE {-#solde}

<em>The solar declination angle, the angular distance of the sun north of the earth’s equator.</em> (Negative values are south.) To obtain this, the solar hour angle is calculated (taking leap years into account).  
```{r child='SOLDEbox.Rmd'}
```

#### Solar Elevation Angle (radians):SOLEL {-#solel}

<em>The solar elevation angle, describing how high the sun appears in the sky.</em> The angle is measured between a line from the observer to the sun and the horizontal plane on which the observer is standing. The elevation angle is negative when the sun drops below the horizon, and the sum of the elevation angle and the zenith angle is <span class="math inline"><em>π</em>/2.</span>  
```{r child='SOLELbox.Rmd'}
```

#### Solar Zenith Angle (radians): SOLZE {-#solze}

<em>The angle of the sun from the zenith, or the solar zenith angle.</em> Cf. also the discussion of the solar elevation angle, SOLEL. <span class="math inline">{<em>S</em><em>O</em><em>L</em><em>Z</em><em>E</em>} = (<em>π</em>/2) − {<em>S</em><em>O</em><em>L</em><em>E</em><em>L</em>}</span> with {SOLEL} given by \@ref(eq:SOLELbox3) above.</p>

#### Solar Azimuth Angle (radians): SOLAZ {-#solaz}

<em>The solar azimuth angle, the angular distance between due south and the projection of the line of sight to the sun on the ground.</em> A positive solar azimuth angle indicates a position east of south (i.e., morning).  
```{r child='SOLAZbox.Rmd'}
```



<!--chapter:end:Section8.Rmd-->

# Experimental Variables

<p>This bulletin does not document experimental variables, conventionally denoted by variable names starting with ’X’. Project documentation should be consulted for such variables. Many projects also include measurements from instruments provided by investigators outside NCAR/RAF. Identification of those variables, and processing algorithms, are contained in the project documentation and/or the NETCDF headers.</p>

<!--chapter:end:Section9.Rmd-->

```{r child='boxStyles.Rmd'}
```

<p class=box>
$\theta_{L}$ = local hour angle (radians): see \@ref(eq:SOLELbox2)  
\{SOLDE\} = solar declination angle (radians): see \@ref(eq:SOLDEbox)  
\{SOLEL\} = solar elevation angle (radians): see \@ref(eq:SOLELbox3)  
\{SOLAZ\} = solar azimuth angle [radians]  
</p><p class=box2>
\begin{equation}
\mathrm{\{SOLAZ\}=\arcsin\left(\frac{\cos\mathrm{\{SOLDE\}\sin\theta_{L}}}{\cos\mathrm{\{SOLEL\}}}\right)}
(\#eq:SOLAZbox1)
\end{equation}
If\ sin(\{SOLAZ\})\ <\ sin(\{SOLDE\})/sin($\phi):$  
\begin{equation}
\mathrm{\{SOLAZ\}} = \pi/2-\mathrm{\{SOLAZ\}}
(\#eq:SOLAZbox2)
\end{equation}
</p>  

<!--chapter:end:SOLAZbox.Rmd-->

```{r child='boxStyles.Rmd'}
```

<p class=box>
$N$ = day number  
\ \ \ \ = number of days (corrected for leap years) since 1 January 1980  
\ \ \ \ \ \ \ (including fractional day from UTC time)  
\ \ \ = (year-1980)*365+(int)(year-1980)/4+day  
\ \ \ \ \ \ + (hour+min/60.+sec/3600.)/24.+$M$  
\ \ \ where $M$=(int)(k+(int)((month-i)*30.6+b)  
\ \ \ \ \ \ with {i,b,k}={1,0.5,0} for month <= 2  
\ \ \ \ \ \ and otherwise {3, 59.5, (1 for leap years, else 0)}  
$\Theta_h$: UTC time expressed as radians after solar noon  
$f,\ \alpha.\ \epsilon$: internal-calculation variables defined below  
{SOLDE}: solar declination angle  
</p><p class=box2>
\begin{equation}
\theta_{h}=2\pi\frac{N}{365.25}
(\#eq:SOLDEbox1)
\end{equation}
\begin{equation}
f=-0.031271-4.53963\times10^{-7}N+\theta_{h}
(\#eq:SOLDEbox2)
\end{equation}
\begin{align}
\alpha	&=	\theta_{h}+4.900968+0.000349\,\sin(2f)+3.67474\times10^{-7}N\notag \\
		&+(0.033434-2.3\times10^{-9}N)\,\sin(f)
(\#eq:SOLDEalpha)
\end{align}
\begin{equation}
\epsilon=0.409140-6.2149\times10^{-9}N
(\#eq:SOLDEeps)
\end{equation}
\begin{equation}
\mathrm{{\{SOLDE\}}=}\arcsin(\sin\alpha\sin\epsilon)
(\#eq:SOLDEbox)
\end{equation}
</p>

<!--chapter:end:SOLDEbox.Rmd-->

<p class=box>
$\theta_{G}$ = Greenwich hour angle\sindex[lis]{thetaG@$\theta_{G}$=Greenwich hour angle}
[radians]  
$\theta_{L}$ = local hour angle\sindex[lis]{thetaL@$\theta_{L}$=local hour angle}
[radians]  
$N$ = day number [see SOLDE box above]  
$Y$ = year (format as in 1980)
$\lambda$ = latitude\sindex[lis]{lambda@$\lambda$=latitude} [radians]  
$\psi$ = longitude\sindex[lis]{psi@$\psi$=longitude} [radians]
$h$ = fractional hour = (hour + minute/60. + second/3600.)  
$\alpha$\ \ \ \ \ \ see \@ref(eq:SOLDEalpha) in the SOLDE box above  
$\epsilon$\ \ \ \ \ \ see \@ref(eq:SOLDEeps) in the SOLDE box  
\{SOLDE\} = solar declination angle (radians) described above; cf.\ \@ref(eq:SOLDEbox).  
</p><p class=box2>
\begin{equation}
\theta_{G}=\arctan(\frac{\sin\alpha\cos\epsilon}{\cos\alpha})
(\#eq:SOLELbox1)
\end{equation}
\begin{align}
\theta_{L} = & \theta_{G}+\psi-2\pi\frac{h}{24}-1.759335\notag \\
 - &2\pi(\frac{N}{365}-Y+1980)-3.694\times10^{-7}N
(\#eq:SOLELbox2)
\end{align}
\begin{equation}
\mathrm{\mathrm{\{SOLEL\}}=\arcsin\left(\sin\lambda\sin\mathrm{\{SOLDE\}+\cos\lambda}\cos\mathrm{\{SOLDE\}}\cos\theta_{L}\right)}
(\#eq:SOLELbox3)
\end{equation}
</p>

<!--chapter:end:SOLELbox.Rmd-->


<p class=box>
PSXC = ambient total air pressure. hPa   
EWX = ambient water vapor pressure, hPa  
$C_{kg2g}=10^{3}\,$g$\,$kg$^{-1}$ (conversion factor to give
final units of g$\,$kg$^{-1}$)  
$M_{w}=$molecular weight of water$^{\dagger}$  
$M_{d}=$molecular weight of dry air$^{\dagger}$  
</p><p class=box2>
\begin{equation}
\mathrm{\{SPHUM\}} = C_{kg2g}\frac{M_{w}}{M_{d}}(\mathrm{\frac{\{EWX\}}{\mathrm{\{PSXC\}-(1-\frac{M_{w}}{M_{d}})\{\mathrm{EWX}\}}}})
(\#eq:SPHUM)
\end{equation}
</p>

<!--chapter:end:SPHUMbox.Rmd-->

<p class=box>
BDIFR = differential pressure between sideslip pressure ports, radome
[hPa]  
QCXC = dynamic pressure [hPa]  
$s_{0},\,s{}_{1}$ = empirical
coefficients dependent on the aircraft and radome configuration  
\ \ \ \ \  = {-0.000983, (1/0.08189) $^\circ$} for the
C-130  
\ \ \ \ \  = {-0.0025, (1/0.04727) $^\circ$} for the GV^(a)^  
</p><p class=box2>
\begin{equation}
\mathrm{\{SSRD\}} = s_{1}(\frac{\mathrm{\{BDIFR\}}}{\{\mathrm{QCXC}\}}+s_{0})
(\#eq:SSRD)
\end{equation}
\_\_\_\_\_\_\_\_\_\_  
^(a)^ The [technical note on wind uncertainty](http://dx.doi.org/10.5065/D60G3HJ8)
recommended using SSRD=$e_{0}+e_{1}$\{BDIFR\}/\{QCF\} with $e_{0}=0.008$
and $e_{1}=22.302$. This has not yet been used in processing as of
March 2017.  
</p>  

<!--chapter:end:SSRDbox.Rmd-->

<p class=box>
(see \@ref(eq:M2) and \@ref(eq:TaEQ) for MACHx and ATX)  
Note dependence of MACHx on choices for QCXC and PSXC  
TASx depends on QCXC, PSXC, ATX  
\ \ \ \ \ where PSXC and ATX are the preferred choices  
$\gamma^{\prime}$, $R^{\prime}$, and $T_{0}$: See the List of Symbols  
</p><p class=box2>
\begin{equation}
\mathrm{TASx}=\mathrm{\{MACHx\}}\sqrt{\gamma^{\prime}R^{\prime}\mathrm{\,(\{ATX\}}+T_{0})}
(\#eq:TASx)
\end{equation}
</p>  

<!--chapter:end:TASbox.Rmd-->

<p class=box>
$q$ = specific humidity (dimensionless) = SPHUM/1000.  
\ \ \ \ \ \  for SPHUM expressed in g/kg  
$c=0.000304\,\mathrm{kg\,g^{-1}}=0.304$ (dimensionless)  
</p><p class=box2>
\begin{equation}
\mathrm{\{TASHC\}} = \mathrm{\{TASX\}} (1.0 + c\,q)  
(\#eq:TASHC)
\end{equation}
</p>  

<!--chapter:end:TASHCbox.Rmd-->


<p class=box>
ATX = ambient temperature, $^{\circ}$C  
PSXC = ambient pressure (hPa)  
$p_{0}$ = reference pressure = 1000 hPa  
$R_{d}$ = gas constant for dry air$^{\dagger}$  
$c_{pd}$ = specific heat at constant pressure for dry air$^{\dagger}$  
</p><p class=box2>
\begin{equation}
\mathrm{\{THETA\}}=\left(\mathrm{\{ATX\}}+T_{0}\right)\left(\frac{p_{0}}{\mathrm{\{PSXC\}}}\right)^{R_{d}/c_{pd}}
(\#eq:THETA)
\end{equation}
</p>  

<!--chapter:end:THETAbox.Rmd-->

```{r child='boxStyles.Rmd'}
```
<p class=box>
$T_{L}$= temperature at the lifted condensation level, K  
ATX = ambient temperature [$^{\circ}\mathrm{C}$]  
EDPC = water vapor pressure [hPa] -- now superceded by EWX  
MR = mixing ratio [g/kg]  
THETA = potential temperature [K]  
</p><p class=box2>  
\begin{equation}
T_{L}=\frac{2840.}{3.5\ln(\mathrm{\{ATX\}+T_{0}})-\ln(\mathrm{\{EDPC\}})-4.805}+55
(\#eq:TLCL2)
\end{equation}
\begin{align}
\mathrm{\{THETAE\}} = & \mathrm{\{THETA\}}\left(\frac{3.376}{T_{L}}-0.00254\right)\notag \\
& \times (\mathrm{\{MR\}})(1+0.00081(\{MR\}))
(\#eq:THETAE)
\end{align}
</p>  

<!--chapter:end:THETAEbox.Rmd-->


<p class=box>
$T_K$ = ATX + $T_0$ = ambient temperature [K]  
$e$ = EWX = water vapor pressure  
$p_d$ = PSXC - EWX = partial pressure of dry air [hPa]  
$p_{0}$ = reference pressure = 1000 hPa  
$r$ = MR = water vapor mixing ratio  
$R_{d}$ = gas constant for dry air$^{\dagger}$  
$c_{pd}$ = specific heat at constant pressure for dry air$^{\dagger}$  
$T_L$ = temperature at the lifted condensation level (LCL) [K]  
$L_0^*+L_1^*(T_L-T_0)$ = latent heat of vaporization at the LCL  
$L_0=2.56313 × 10^6$ J$\,$kg$^{-1}$, $L_1=1754$ J$\,$kg$^{-1}$K$^{-1}$  
$K_2=1.137 × 10^6$ J$\,$kg$^{-1}$  
$\beta_{1-5}$ = {2840 K, 55 K, 1 K, 1 hPa, −4.805}  
</p><p class=box2>
\begin{equation}
T_{L}=\frac{\beta_{1}}{3.5\ln(T_{K}/\beta_{3})-\ln(\mathrm{e/\beta_{4}})+\beta_{5}}+\beta_{2}
(\#eq:TLCLTP)
\end{equation}
\begin{equation}
\Theta_{DL}=T_{K}(\frac{p_{0}}{p_{d}})^{0.2854}\,(\frac{T_{k}}{T_{L}})^{0.28\times10^{-3}r}
(\#eq:THETADLbox)
\end{equation}
\begin{equation}
\Theta_{P}=\Theta_{DL}\exp\{\frac{r(L_{0}^{*}-L_{1}^{*}(T_{L}-T_{0})+K_{2}r)}{c_{pd}T_{L}}\}
(\#eq:THETAPbox)
\end{equation}
</p>  

<!--chapter:end:THETAPbox.Rmd-->

```{r child='boxStyles.Rmd'}
```
<p class=box>
$e=$\{EDPC\}$*100$ = water vapor pressure [Pa]  
ATX = ambient temperature ($^{\circ}\mathrm{C}$)  
$r=$\{MR\}/1000.\index{MR} = mixing ratio (dimensionless)  
$p_{d}=$(\{PSXC\}$-$\{EDPC\})$*100$ = ambient dry-air pressure [Pa]  
$p_{0}=$reference pressure for potential temperature, 10$^{5}$Pa  
$\chi=$\{PLWCC\}/1000.=cloud liquid water content [kg$\,$m$^{-3}$]  
$R_{d}=$gas constant for dry air$^{\dagger}$  
$\rho_{d}=$density of dry air = $\frac{p_{d}}{R_{d}(\{ATX\}+T_{0})}$  
$c_{pd}=$specific heat of dry air$^{\dagger}$  
$c_{w}=$specific heat of liquid water$^{\dagger}$  
$L_{v}=L_{0}+L_{1}\mathrm{\{ATX\}}$ where $L_{0}=2.501\times10^{6}\mathrm{J}\,\mathrm{kg^{-1}}$
and $L_{1}=-2370\,\mathrm{J\,\mathrm{kg^{-1}\,\mathrm{K^{-1}}}}$  
</p><p class=box2>
\begin{equation}
r_{t}=r+(\chi/\rho_{d})
(\#eq:rtotBox)
\end{equation}
\begin{equation}
c_{pt}=c_{pd}+r_{t}c_{w}
(\#eq:cptBox)
\end{equation}  
If outside cloud or below 100\% relative humidity, define  
\begin{equation}
F_{1}=\left(\frac{e}{e_{s,w}(T)}\right)^{-\frac{rR_{w}}{c_{pt}}}
(\#eq:F1)
\end{equation}  
otherwise set $F_{1}=1$. Then  
\begin{equation}
T_{1}=\mathrm{(\{ATX\}}+T_{0})\left\{ \frac{p_{0}}{(\mathrm{\{PSXC\}}-\mathrm{\{EDPC\})}}\right\} ^{\frac{R_{d}}{c_{pt}}}
(\#eq:T1box)
\end{equation}
\begin{equation}
\mathrm{\{THETAQ\}}=T_{1}F_{1}\exp\left\{ \frac{L_{v}r}{c_{pt}(\{\mathrm{ATX\}}+T_{0})}\right\}
(\#eq:THETAQbox)
\end{equation}
</p>  

<!--chapter:end:THETAQbox.Rmd-->

<p class=box>
TVIR = virtual temperature [$^{\circ}\mathrm{C}$]  
PSXC = ambient pressure [hPa]  
$R_{d}=$gas constant for dry air$^{\dagger}$  
$c_{pd}=$specific heat at constant pressure for dry air$^{\dagger}$  
$T_{0}=273.15\,$K  
$p_{0}$ = reference pressure, conventionally 1000 hPa  
</p><p class=box2>
\begin{equation}
\mathrm{THETAV}=\left(\mathrm{\{TVIR\}}+T_{0}\right)\left(\frac{p_{o}}{\mathrm{\{PSXC\}}}\right)^{R_{d}/c_{pd}}
(\#eq:THETAV)
\end{equation}
</p>  

<!--chapter:end:THETAVbox.Rmd-->

<p class=box>
ATX = ambient temperature, $^{\circ}\mathrm{C}$  
$r$ = mixing ratio, dimensionless {[}kg/kg{]} = \{MR\}/(1000 g/kg)  
$T_{0}=273.15$\,K  
</p><p class=box2>
\begin{equation}
\mathrm{TVIR}=(\mathrm{\{ATX\}}+T_{0})\left(\frac{1+\frac{M_{d}}{M_{w}}r}{1+r}\right)-T_{0}
(\#eq:TVIR)
\end{equation}
</p>  

<!--chapter:end:TVIRbox.Rmd-->

<p class=box>
VISxV = voltage output by a pyranometer [V]  
$a_{1}$ = linear calibration coefficient [W\ m$^{-2}$\ V$^{-1}$]  
</p><p class=box2>
\begin{equation}
\mathrm{\{VISxC\}}=a_{1}\mathrm{\{VISxV\}}
(\#eq:VISxC)
\end{equation}
</p>  

<!--chapter:end:VISxCbox.Rmd-->

<p class=box>
UI = easterly component of the horizontal wind  
VI = northerly component of the horizontal wind  
atan2 = 4-quadrant arc-tangent function producing output in radians
from -$\pi$ to $\pi$  
$C_{rd}$ = conversion factor, radians to degrees, = 180/$\pi$ [units: $^{\circ}$\,/\,radian]  
</p><p class=box2>
\begin{align}
\mathrm{WS} = & \sqrt{\mathrm{\{UI\}}^{2}+\{\mathrm{VI\}}^{2}}(\#eq:WS)\\
\mathrm{WD} = & C_{rd}\mathrm{\,atan2(\{UI\},\,\{VI\})}+180^{\circ}  
(\#eq:WD)
\end{align}
</p>  

<!--chapter:end:WDWSbox.Rmd-->


<!-- \fbox{\begin{minipage}[t]{0.95\textwidth}% -->
<p class=box>
$g_{1}$ = 9.780356 m\ s^-2^  
$a_{1}$ = 0.31391116$\times 10$^-6^m^-1^  
$a_{2}$ = .0052885 (dimensionless)  
VEW (VNS) = eastward (northward) groundspeed of the aircraft (see
below)  
LAT = latitude measured by the IRS [º]  
$C_{dr}=\pi/180^{\circ}$ = conversion factor, degrees to radians  
PALT = pressure altitude of the aircraft  
$\Omega$ = angular rotation of the earth$^{\dagger}$ = 7.292116$\times10^{6}$
radians/s  
$R_{E}$ = radius of the Earth$^{\dagger}$ = 6.371229$\times10^{6}$
m  
$g_{f}$ = local gravity corrected for latitude and altitude  
$V_{c}$ = correction to gravity for the motion of the aircraft  
$G_{L}$ = local gravity at the location of INS alignment, corrected
to zero altitude  
$\{C[0],C[1],C[2]\}$ = feedback coefficients, {0.15, 0.0075, 0.000125}
for 125-s response  
</p>
<p class=box2>
\ 1. From the pressure altitude PALT (in m) and the latitude LAT, estimate
the acceleration of gravity:  
\begin{equation}
g_{f}=g_{1}\left(1+a_{2}\sin^{2}(\mathrm{C_{dr}\{LAT\})}+a_{1}\mathrm{\{PALT\}}\right)
(\#eq:gf)
\end{equation}
\ 2. Determine corrections for Coriolis acceleration\index{Coriolis acceleration}
and centrifugal acceleration\index{centrifugal acceleration}:  
\begin{equation}
a_{c}=2\Omega\mathrm{\{VEW\}}\cos(C_{r}\mathrm{\{LAT\}})+\frac{\mathrm{\{VEW\}}^{2}+\mathrm{\{VNS\}}^{2}}{R_{E}}
(\#eq:ac)
\end{equation}
\ \ \ Estimate the acceleration $a_{z}$ (code variable 'acz') experienced
by the aircraft as follows:  
\begin{equation}
\mathrm{\{acz\}}=a_{z}=\mathrm{\{ACINS\}}+G_{L}-g_{f}+a_{c}
(\#eq:acz)
\end{equation}
\ \ \ Use a feedback loop to update the integrated value of the acceleration.  
\ \ \ The following code segment uses *acz* to represent acceleration $a_{z}$,  
\ \ \ "deltaT" to represent the time between updates, and "hx" and "hxx"
to store the feedback terms:  
\ \ \ \ \ wp3[FeedBack] += (acz - C[1] * hx[FeedBack] -- C[2] * hxx[FeedBack]) * deltaT[FeedBack]  
\ 3. Update the feedback terms (using "hi3" for storage):  
\ \ \ \ \ hi3[FeedBack] = hi3[FeedBack] + (wp3[FeedBack] -- C[0] * hx[FeedBack]) * deltaT[FeedBack];  
\ \ \ \ \ hx[FeedBack] = hi3[FeedBack] - palt;  
\ \ \ \ \ hxx[FeedBack] = hxx[FeedBack] + hx[FeedBack] * deltaT[FeedBack];  
\ 4. Set WP3 to the average of the last wp3 result and the current wp3
result.</p>

<!--chapter:end:WP3box.Rmd-->

<p class=box>
XICN = side-flow rate [SLPM]  
PCN = pressure at the inlet to the CN counter [hPa]  
CNTEMP = temperature at the inlet of the sample tube [$^{\circ}$C]  
$p_{std}$ = standard reference pressure, 1013.25 mb  
$T_{std}$\sindex[lis]{Tr@$T_{std}$= absolute reference temperature, STP}
= 294.15 K   
$T_{0}$ = 273.15\ K  
</p><p class=box2>
\begin{equation}
\mathrm{\{XICNC\} = \{XICN\}}\frac{p_{std}}{\mathrm{\{PCN\}}}\frac{(\{\mathrm{CNTEMP\}}+T_{0})}{T_{std}}
(\#eq:XICNCbox)
\end{equation}
</p>  

<!--chapter:end:XICNCbox.Rmd-->

